!function(C){function g(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return C[t].call(s.exports,s,s.exports,g),s.l=!0,s.exports}var n={};g.m=C,g.c=n,g.d=function(C,n,t){g.o(C,n)||Object.defineProperty(C,n,{configurable:!1,enumerable:!0,get:t})},g.n=function(C){var n=C&&C.__esModule?function(){return C.default}:function(){return C};return g.d(n,"a",n),n},g.o=function(C,g){return Object.prototype.hasOwnProperty.call(C,g)},g.p="",g(g.s=3)}([/*!************************************************!*\
  !*** ./www/js/chats/dev/classes/websockets.js ***!
  \************************************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _base_discussion = __webpack_require__(/*! ./base_discussion */ 5);\n\nvar _base_discussion2 = _interopRequireDefault(_base_discussion);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by kostet on 09.08.2017.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar DiscussionWebSockets = function (_BaseDiscussion) {\n    _inherits(DiscussionWebSockets, _BaseDiscussion);\n\n    function DiscussionWebSockets(params) {\n        _classCallCheck(this, DiscussionWebSockets);\n\n        var _this = _possibleConstructorReturn(this, (DiscussionWebSockets.__proto__ || Object.getPrototypeOf(DiscussionWebSockets)).call(this, params));\n\n        _this.openConnection();\n\n        _this.status = 'closed';\n        _this.messages = new Messages().start();\n        _this.messages.setPosition('toast-bottom-right');\n        return _this;\n    }\n\n    _createClass(DiscussionWebSockets, [{\n        key: 'start',\n        value: function start() {\n            _get(DiscussionWebSockets.prototype.__proto__ || Object.getPrototypeOf(DiscussionWebSockets.prototype), 'start', this).call(this);\n        }\n    }, {\n        key: 'onOpen',\n        value: function onOpen(event) {\n            this.status = 'open';\n\n            console.log(this.status);\n        }\n    }, {\n        key: 'onClose',\n        value: function onClose(event) {\n            this.status = 'closed';\n\n            console.log(event);\n\n            this.openConnection();\n        }\n    }, {\n        key: 'onMessage',\n        value: function onMessage(event) {\n            var data = JSON.parse(event.data);\n\n            console.log(data);\n            if (data.action == 'newMessage') {\n                if (data.data.users_who_get_messages != undefined && data.data.users_who_get_messages.length > 0) {\n                    var _iteratorNormalCompletion = true;\n                    var _didIteratorError = false;\n                    var _iteratorError = undefined;\n\n                    try {\n                        for (var _iterator = data.data.users_who_get_messages[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                            var item = _step.value;\n\n                            if ($('[data-auth-user-id=' + item + ']').length > 0) {\n                                this.getDiscussionChatBySidebarPanel().prepend(this.formatSidebarChatItem(data.data));\n\n                                //Обновляем счетчик сообщений\n                                var counter = parseInt(this.getDiscussionChatBySidebarCounter().text());\n\n                                this.getDiscussionChatBySidebarCounter().text(++counter);\n                                addShakeAnim('#js-chat-messages-counter');\n\n                                //Для дилеров подгружаем список сообщений из раздела Задать вопрос\n                                this.reloadAskMessages(data.data);\n                            }\n                        }\n                    } catch (err) {\n                        _didIteratorError = true;\n                        _iteratorError = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion && _iterator.return) {\n                                _iterator.return();\n                            }\n                        } finally {\n                            if (_didIteratorError) {\n                                throw _iteratorError;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: 'onError',\n        value: function onError(event) {}\n    }, {\n        key: 'onSend',\n        value: function onSend(data) {\n            console.log(this.status);\n\n            if (this.status == 'open') {\n                this.web_sockets.send(JSON.stringify(data));\n            }\n        }\n    }, {\n        key: 'makeRequest',\n        value: function makeRequest(action, data) {\n            var send_data = {};\n\n            send_data.action = action;\n            send_data.data = data;\n\n            return this.onSend(send_data);\n        }\n\n        /**\r\n         * Информирование системы о новым сообщении\r\n         * @param data\r\n         * @returns {*}\r\n         */\n\n    }, {\n        key: 'onHaveNewMessage',\n        value: function onHaveNewMessage(data) {\n            if (data != null) {\n                return this.makeRequest('newMessage', data);\n            }\n        }\n    }, {\n        key: 'openConnection',\n        value: function openConnection() {\n            var _this2 = this;\n\n            console.log('test connection');\n\n            this.web_sockets = new WebSocket('ws://dm.vw-servicepool.ru:48880/discussion');\n            this.web_sockets.onopen = function (event) {\n                _this2.onOpen(event);\n            };\n            this.web_sockets.onclose = function (event) {\n                _this2.onClose(event);\n            };\n            this.web_sockets.onmessage = function (event) {\n                _this2.onMessage(event);\n            };\n            this.web_sockets.onerror = function (event) {\n                _this2.onError(event);\n            };\n        }\n    }]);\n\n    return DiscussionWebSockets;\n}(_base_discussion2.default);\n\nexports.default = DiscussionWebSockets;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvd2Vic29ja2V0cy5qcz85OTc1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGtvc3RldCBvbiAwOS4wOC4yMDE3LlxyXG4gKi9cclxuXHJcbmltcG9ydCBCYXNlRGlzY3Vzc2lvbiBmcm9tICcuL2Jhc2VfZGlzY3Vzc2lvbic7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEaXNjdXNzaW9uV2ViU29ja2V0cyBleHRlbmRzIEJhc2VEaXNjdXNzaW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmFtcykge1xyXG4gICAgICAgIHN1cGVyKHBhcmFtcylcclxuXHJcbiAgICAgICAgdGhpcy5vcGVuQ29ubmVjdGlvbigpO1xyXG5cclxuICAgICAgICB0aGlzLnN0YXR1cyA9ICdjbG9zZWQnO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZXMgPSBuZXcgTWVzc2FnZXMoKS5zdGFydCgpO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZXMuc2V0UG9zaXRpb24oJ3RvYXN0LWJvdHRvbS1yaWdodCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICAgIHN1cGVyLnN0YXJ0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25PcGVuKGV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5zdGF0dXMgPSAnb3Blbic7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhdHVzKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKGV2ZW50ICAgKSB7XHJcbiAgICAgICAgdGhpcy5zdGF0dXMgPSAnY2xvc2VkJztcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coZXZlbnQpO1xyXG5cclxuICAgICAgICB0aGlzLm9wZW5Db25uZWN0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25NZXNzYWdlKGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICBpZiAoZGF0YS5hY3Rpb24gPT0gJ25ld01lc3NhZ2UnKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmRhdGEudXNlcnNfd2hvX2dldF9tZXNzYWdlcyAhPSB1bmRlZmluZWQgJiYgZGF0YS5kYXRhLnVzZXJzX3dob19nZXRfbWVzc2FnZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaXRlbSBvZiBkYXRhLmRhdGEudXNlcnNfd2hvX2dldF9tZXNzYWdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkKCdbZGF0YS1hdXRoLXVzZXItaWQ9JyArIGl0ZW0gKyAnXScpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXREaXNjdXNzaW9uQ2hhdEJ5U2lkZWJhclBhbmVsKCkucHJlcGVuZCh0aGlzLmZvcm1hdFNpZGViYXJDaGF0SXRlbShkYXRhLmRhdGEpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v0J7QsdC90L7QstC70Y/QtdC8INGB0YfQtdGC0YfQuNC6INGB0L7QvtCx0YnQtdC90LjQuVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgY291bnRlciA9IHBhcnNlSW50KHRoaXMuZ2V0RGlzY3Vzc2lvbkNoYXRCeVNpZGViYXJDb3VudGVyKCkudGV4dCgpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0RGlzY3Vzc2lvbkNoYXRCeVNpZGViYXJDb3VudGVyKCkudGV4dCgrK2NvdW50ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRTaGFrZUFuaW0oJyNqcy1jaGF0LW1lc3NhZ2VzLWNvdW50ZXInKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v0JTQu9GPINC00LjQu9C10YDQvtCyINC/0L7QtNCz0YDRg9C20LDQtdC8INGB0L/QuNGB0L7QuiDRgdC+0L7QsdGJ0LXQvdC40Lkg0LjQtyDRgNCw0LfQtNC10LvQsCDQl9Cw0LTQsNGC0Ywg0LLQvtC/0YDQvtGBXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVsb2FkQXNrTWVzc2FnZXMoZGF0YS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25FcnJvcihldmVudCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBvblNlbmQoZGF0YSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhdHVzKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09ICdvcGVuJykge1xyXG4gICAgICAgICAgICB0aGlzLndlYl9zb2NrZXRzLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtYWtlUmVxdWVzdChhY3Rpb24sIGRhdGEpIHtcclxuICAgICAgICBsZXQgc2VuZF9kYXRhID0ge307XHJcblxyXG4gICAgICAgIHNlbmRfZGF0YS5hY3Rpb24gPSBhY3Rpb247XHJcbiAgICAgICAgc2VuZF9kYXRhLmRhdGEgPSBkYXRhO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5vblNlbmQoc2VuZF9kYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCY0L3RhNC+0YDQvNC40YDQvtCy0LDQvdC40LUg0YHQuNGB0YLQtdC80Ysg0L4g0L3QvtCy0YvQvCDRgdC+0L7QsdGJ0LXQvdC40LhcclxuICAgICAqIEBwYXJhbSBkYXRhXHJcbiAgICAgKiBAcmV0dXJucyB7Kn1cclxuICAgICAqL1xyXG4gICAgb25IYXZlTmV3TWVzc2FnZShkYXRhKSB7XHJcbiAgICAgICAgaWYgKGRhdGEgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tYWtlUmVxdWVzdCgnbmV3TWVzc2FnZScsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvcGVuQ29ubmVjdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygndGVzdCBjb25uZWN0aW9uJyk7XHJcblxyXG4gICAgICAgIHRoaXMud2ViX3NvY2tldHMgPSBuZXcgV2ViU29ja2V0KCd3czovL2RtLnZ3LXNlcnZpY2Vwb29sLnJ1OjQ4ODgwL2Rpc2N1c3Npb24nKTtcclxuICAgICAgICB0aGlzLndlYl9zb2NrZXRzLm9ub3BlbiA9IChldmVudCkgPT4geyB0aGlzLm9uT3BlbihldmVudCkgfTtcclxuICAgICAgICB0aGlzLndlYl9zb2NrZXRzLm9uY2xvc2UgPSAoZXZlbnQpID0+IHsgdGhpcy5vbkNsb3NlKGV2ZW50KSB9O1xyXG4gICAgICAgIHRoaXMud2ViX3NvY2tldHMub25tZXNzYWdlID0gKGV2ZW50KSA9PiB7IHRoaXMub25NZXNzYWdlKGV2ZW50KSB9O1xyXG4gICAgICAgIHRoaXMud2ViX3NvY2tldHMub25lcnJvciA9IChldmVudCkgPT4geyB0aGlzLm9uRXJyb3IoZXZlbnQpIH07XHJcbiAgICB9XHJcbn1cclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHd3dy9qcy9jaGF0cy9kZXYvY2xhc3Nlcy93ZWJzb2NrZXRzLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBSUE7QUFDQTs7Ozs7Ozs7O0FBTEE7Ozs7QUFNQTs7O0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQVFBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFlQTtBQUNBO0FBQ0E7OztBQUVBOzs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7Ozs7OztBQTdGQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n")},/*!*******************************************!*\
  !*** ./www/js/chats/dev/classes/admin.js ***!
  \*******************************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _websockets = __webpack_require__(/*! ./websockets */ 0);\n\nvar _websockets2 = _interopRequireDefault(_websockets);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by kostet on 03.08.2017.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n//import DiscussionOnlineChatBase from \"./base\";\n\n\nvar Admin = function (_DiscussionWebSockets) {\n    _inherits(Admin, _DiscussionWebSockets);\n\n    function Admin(params) {\n        _classCallCheck(this, Admin);\n\n        var _this = _possibleConstructorReturn(this, (Admin.__proto__ || Object.getPrototypeOf(Admin)).call(this, params));\n\n        _this.params.messages_status = 'unread';\n        _this.params.messages_type = '';\n\n        _this.params.last_user_id = null;\n        _this.params.dealer_id = 0;\n        _this.params.discussions_ids = [];\n        return _this;\n    }\n\n    _createClass(Admin, [{\n        key: 'start',\n        value: function start() {\n            _get(Admin.prototype.__proto__ || Object.getPrototypeOf(Admin.prototype), 'start', this).call(this);\n\n            //Загрузка списка дискуссий по дилеру\n            $(document).on('click', this.params.on_dealer_show_discussions, $.proxy(this.onShowDealerDiscussions, this));\n\n            //Переключение панелей (Типы сообщение - Все сообщения / Только Общие)\n            $(document).on('click', this.params.on_switch_discussions_messages_type, $.proxy(this.onSwitchDiscussionsMessagesTypes, this));\n\n            //Вывод списка сообщений (Все сообщения по заявке или только непрочитанные)\n            $(document).on('click', this.params.on_switch_discussions_messages_status, $.proxy(this.onSwitchDiscussionsMessagesStatuses, this));\n\n            //Фильтр по названию дилера / пользователя и номера дилера\n            $(document).on('keyup', '#txt_discussions_filter_by_name', $.proxy(this.onFilterDiscussionsByName, this));\n\n            $(document).on('click', '.js-sort-dealers', $.proxy(this.onMakeDealersSort, this));\n\n            this.initDefaultValues();\n            this.getUnreadMessagesCount();\n\n            return this;\n        }\n    }, {\n        key: 'initDefaultValues',\n        value: function initDefaultValues() {\n            this.params.last_user_id = this.getDealersItemsList().eq(0).data('user-id');\n\n            //Загружаем количество непрочитанных сообщений для заявок\n            this.loadUnreadDataForModels();\n\n            this.scrollDown(this.scroll_container);\n        }\n    }, {\n        key: 'loadUnreadDataForModels',\n        value: function loadUnreadDataForModels() {\n            var _this2 = this;\n\n            var models_ids = $('.discussion__list__item', this.getDealerContainerDiscussions()).map(function (ind, item) {\n                return $(item).data(\"model-id\");\n            });\n\n            new Promise(function (resolve, reject) {\n                Pace.start();\n\n                $.post(_this2.params.on_load_discussion_unread_models_url, {\n                    models_ids: models_ids.toArray()\n                }, function (result) {\n                    if (result.success) {\n                        resolve(result);\n                    } else {\n                        reject(result);\n                    }\n                    Pace.stop();\n                });\n            }).then(function (result) {\n                $.each(result.unread_count, function (i, count) {\n                    var unread_messages_count = parseInt(count);\n\n                    if (unread_messages_count != 0) {\n                        $('[data-model-id=' + i + ']', _this2.getDealerContainerDiscussions()).append(\"<i style='top: 90%; right: 3px; min-width: 0px; height: 9px;'>&nbsp;</i>\");\n                    }\n                });\n            }).catch(function (result) {\n                _this2.error(result.title, result.msg);\n\n                Pace.stop();\n            });\n        }\n\n        //Переключение панелей (Типы сообщение - Все сообщения / Только Общие)\n\n    }, {\n        key: 'onSwitchDiscussionsMessagesTypes',\n        value: function onSwitchDiscussionsMessagesTypes(event) {\n            var _this3 = this;\n\n            this.onSwitchPanel(event, this.params.on_switch_discussions_messages_type, function (item) {\n                _this3.params.messages_type = item.data('type');\n                _this3.params.messages_status = 'all';\n\n                _this3.resetDiscussionMessagesStatus();\n                _this3.switchPanelsByType();\n\n                var selected_item = _this3.getElementByClass('.dealer_model_item', 'active'),\n                    selected_model_item = _this3.getElementByClass(_this3.params.on_show_discussion_messages, 'active');\n\n                if (selected_item != null) {\n                    _this3.params.dealer_id = selected_item.data('dealer-id');\n                    _this3.params.model_id = selected_model_item.data('model-id');\n\n                    _this3.loadDiscussionAskMessages();\n                }\n            });\n        }\n\n        //Загружаем список сообщение для выбранного дилера, только Общие сообщения\n\n    }, {\n        key: 'loadDiscussionAskMessages',\n        value: function loadDiscussionAskMessages() {\n            if (this.params.messages_type == 'ask') {\n                this.params.model_messages_container = '#container-discussion-messages-ask';\n            } else {\n                this.params.model_messages_container = '#container-discussion-messages';\n            }\n\n            this.loadDiscussionMessages();\n        }\n\n        //Переопределяем метод для отправки сообщение только выбранному дилеру\n\n    }, {\n        key: 'loadAskMessages',\n        value: function loadAskMessages() {\n            this.loadDiscussionAskMessages();\n        }\n    }, {\n        key: 'onSwitchDiscussionsMessagesStatuses',\n        value: function onSwitchDiscussionsMessagesStatuses(event) {\n            var _this4 = this;\n\n            this.onSwitchPanel(event, this.params.on_switch_discussions_messages_status, function (item) {\n                _this4.params.messages_status = item.data('type');\n\n                var selected_item = _this4.getElementByClass(_this4.params.on_show_discussion_messages, 'active');\n                if (selected_item != null) {\n                    _this4.params.model_id = selected_item.data('model-id');\n\n                    _this4.loadDiscussionMessages();\n                }\n            });\n        }\n    }, {\n        key: 'onSwitchPanel',\n        value: function onSwitchPanel(event, element, callback) {\n            var item = $(event.target);\n\n            if (!item.hasClass('current')) {\n                $(element).removeClass('current');\n                item.addClass('current');\n\n                if (callback != undefined) {\n                    callback(item);\n                }\n            }\n        }\n\n        /**\r\n         * Фильтр списка дискуссий\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onFilterDiscussionsList',\n        value: function onFilterDiscussionsList(event) {\n            _get(Admin.prototype.__proto__ || Object.getPrototypeOf(Admin.prototype), 'onFilterDiscussionsList', this).call(this, event);\n\n            $('#txt_discussions_filter_by_name').val('');\n        }\n    }, {\n        key: 'onShowDealerDiscussions',\n        value: function onShowDealerDiscussions(event) {\n            var _this5 = this;\n\n            var item = $(event.target);\n\n            if (item.data('user-id') == undefined) {\n                item = item.parent();\n            }\n\n            //Если при загрузке списка сообщение панель переключена на Непрочитанные, автоматически переводим панель в обычный статус\n            /*if (this.params.messages_status == 'unread' ) {\r\n             this.getDiscussionMessagesStatusSwitch().removeClass('current').eq(0).addClass('current');\r\n             }*/\n            //По умолчанию открываем понель с непрочитанными сообщениями\n            this.getDiscussionMessagesStatusSwitch().removeClass('current').eq(1).addClass('current');\n\n            //Принудительно переводим на панель заявок\n            if (this.params.messages_type == 'ask') {\n                $('[data-type=\"all\"]').trigger('click');\n            }\n\n            this.params.last_user_id = item.data('user-id');\n            this.params.dealer_id = item.data('dealer-id');\n\n            this.getDealersItemsList().removeClass('active');\n            item.addClass('active');\n\n            new Promise(function (resolve, reject) {\n                Pace.start();\n\n                $.post(_this5.params.on_load_dealer_discussions_url, {\n                    filter_by_user: item.data('user-id'),\n                    filter_by_dealer: _this5.params.dealer_id,\n                    messages_type: \"unread\"\n\n                }, function (result) {\n                    if (result.success) {\n                        resolve(result);\n                    } else {\n                        reject(result);\n                    }\n                    Pace.stop();\n                });\n            }).then(function (result) {\n                _this5.getDealerContainerDiscussions().html(result.dealer_discussions);\n                _this5.getDealerContainerDiscussionsMessages().html(result.unread_messages_list);\n                _this5.getDealerContainerDiscussionsAskMessages().html(result.dealer_discussion_ask_messages_list);\n\n                _this5.setDefaultDiscussionItem(true);\n\n                _this5.scrollDown(_this5.scroll_container);\n\n                //Загружаем количество непрочитанных сообщений для заявок\n                _this5.loadUnreadDataForModels();\n            }).catch(function (result) {\n                _this5.error(result.title, result.msg);\n\n                Pace.stop();\n            });\n        }\n    }, {\n        key: 'getDiscussionsContainer',\n        value: function getDiscussionsContainer() {\n            return $('#dealers-discussions-container');\n        }\n\n        /**\r\n         * Установить по умолчанию выбранную дискуссию по заявке\r\n         * @param forcibly_set\r\n         *\r\n         */\n\n    }, {\n        key: 'setDefaultDiscussionItem',\n        value: function setDefaultDiscussionItem() {\n            var forcibly_set = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n            if (this.last_discussion_item == null || forcibly_set) {\n                this.last_discussion_item = $('.discussion__list__item', this.getDealerContainerDiscussions()).eq(0);\n\n                //Устаналиваем по умолчанию активную заявку\n                this.params.model_id = this.last_discussion_item.data('model-id');\n            }\n        }\n    }, {\n        key: 'drawUnreadDiscussionData',\n        value: function drawUnreadDiscussionData(result) {\n            var _this6 = this;\n\n            $.each(result.unread_count, function (index, value) {\n                $('.discussion__list__item__' + index, _this6.getDiscussionsContainer()).attr('data-unread', true);\n                if (value > 0) {\n                    $('.discussion__list__item__' + index, _this6.getDiscussionsContainer()).attr('data-unread-count', value).append('<i>' + value + '</i>');\n                }\n            });\n        }\n    }, {\n        key: 'getDealerContainerDiscussions',\n        value: function getDealerContainerDiscussions() {\n            return $(this.params.container_dealer_discussions);\n        }\n\n        /**\r\n         * Панель обычных сообщений\r\n         * @returns {*|jQuery|HTMLElement}\r\n         */\n\n    }, {\n        key: 'getDealerContainerDiscussionsMessages',\n        value: function getDealerContainerDiscussionsMessages() {\n            return $(this.params.container_discussion_messages);\n        }\n\n        /**\r\n         * Панель вопросов\r\n         * @returns {*|jQuery|HTMLElement}\r\n         */\n\n    }, {\n        key: 'getDealerContainerDiscussionsAskMessages',\n        value: function getDealerContainerDiscussionsAskMessages() {\n            return $(this.params.container_discussion_ask_messages);\n        }\n    }, {\n        key: 'getDealersItemsList',\n        value: function getDealersItemsList() {\n            return $(this.params.on_dealer_show_discussions);\n        }\n    }, {\n        key: 'getDiscussionMessagesStatusSwitch',\n        value: function getDiscussionMessagesStatusSwitch() {\n            return $(this.params.on_switch_discussions_messages_status);\n        }\n    }, {\n        key: 'getDiscussionMessagesTypesSwitch',\n        value: function getDiscussionMessagesTypesSwitch() {\n            return $(this.params.on_switch_discussions_messages_type);\n        }\n    }, {\n        key: 'getDiscussionItemParent',\n        value: function getDiscussionItemParent() {\n            return $('#dealers-discussions-container');\n        }\n\n        /**\r\n         * Фильтр списка дилеров по имени / номеру / пользователю\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onFilterDiscussionsByName',\n        value: function onFilterDiscussionsByName(event) {\n            var field = $(event.target),\n                value = $.trim(field.val()).toLowerCase();\n\n            if (value.length > 0) {\n                $('[data-user-name], [data-dealer-name], [data-dealer-number]').each(function (index, element) {\n                    var hide_element = true;\n\n                    if ($(element).data('user-name').toLowerCase().indexOf(value) != -1) {\n                        hide_element = false;\n                        $(element).show();\n                    }\n\n                    if ($(element).data('dealer-name').toLowerCase().indexOf(value) != -1) {\n                        hide_element = false;\n                        $(element).show();\n                    }\n\n                    if ($(element).data('dealer-number').toString().indexOf(value) != -1) {\n                        hide_element = false;\n                        $(element).show();\n                    }\n\n                    if (hide_element) {\n                        $(element).hide();\n                    }\n                });\n            } else {\n                this.getDiscussionListItem().show();\n            }\n        }\n    }, {\n        key: 'switchPanelsByType',\n        value: function switchPanelsByType() {\n            $('.discussion-messages-list-by-type').hide();\n            $('[data-container-type=' + this.params.messages_type + ']').show();\n        }\n\n        /**\r\n         *\r\n         * @param Event event\r\n         */\n\n    }, {\n        key: 'onMakeDealersSort',\n        value: function onMakeDealersSort(event) {\n            var $element = $(event.target),\n                dealers_list = [];\n\n            $('.dealer_model_item').each(function (index, element) {\n                dealers_list.push($(element));\n            });\n\n            dealers_list.sort(function (a, b) {\n                var a_name = a.data('dealer-name').toLowerCase(),\n                    b_name = b.data('dealer-name').toLowerCase();\n\n                if (a_name > b_name) {\n                    return $element.data('sort-direction') == 'asc' ? 1 : -1;\n                }\n\n                if (a_name < b_name) {\n                    return $element.data('sort-direction') == 'asc' ? -1 : 1;\n                }\n\n                return 0;\n            });\n\n            this.getDiscussionsContainer().html('');\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = dealers_list[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var item = _step.value;\n\n                    this.getDiscussionsContainer().append(item);\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n\n            $element.data('sort-direction', $element.data('sort-direction') == 'asc' ? 'desc' : 'asc');\n        }\n\n        /**\r\n         *\r\n         * @returns {*|jQuery|HTMLElement}\r\n         */\n\n    }, {\n        key: 'getDiscussionAskMessagesContainer',\n        value: function getDiscussionAskMessagesContainer() {\n            return $(this.params.container_discussion_ask_messages);\n        }\n\n        /**\r\n         * Получить данные о том кому отправлять сообщение (дилеру или импортерам)\r\n         * @returns {{direction: string}}\r\n         */\n\n    }, {\n        key: 'getMessageDirection',\n        value: function getMessageDirection(message_type) {\n            return {\n                'direction': this.getMessageSendTo(message_type) != undefined && this.getMessageSendTo(message_type).is(':checked') ? 'importer' : ''\n            };\n        }\n\n        /**\r\n         * Делаем запрос по ws для информировании пользователя о новом сообщении\r\n         * @param data\r\n         */\n\n    }, {\n        key: 'makeRequestData',\n        value: function makeRequestData(data) {\n            this.makeRequest('newMessage', data);\n        }\n\n        /**\r\n         * Получить направление отправкии сообщения (для дилера или импортера)\r\n         * @param message_type\r\n         * @returns {*|jQuery|HTMLElement}\r\n         */\n\n    }, {\n        key: 'getMessageSendTo',\n        value: function getMessageSendTo(message_type) {\n            if (message_type == undefined) {\n                return $('.message-to-importer', $('[data-container-type=\"all\"]'));\n            }\n\n            return $('.message-to-importer', message_type == 'message' ? $('[data-container-type=\"all\"]') : $('[data-container-type=\"ask\"]'));\n        }\n\n        /**\r\n         * Обнуление панелей отображение заявок по статусу (Все или Непрочитанные)\r\n         */\n\n    }, {\n        key: 'resetDiscussionMessagesStatus',\n        value: function resetDiscussionMessagesStatus() {\n            $('.discussions-messages-status').removeClass('current');\n            $('.discussions-messages-status').eq(0).addClass('current');\n        }\n    }]);\n\n    return Admin;\n}(_websockets2.default);\n\nexports.default = Admin;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvYWRtaW4uanM/NWFkMCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBrb3N0ZXQgb24gMDMuMDguMjAxNy5cclxuICovXHJcbi8vaW1wb3J0IERpc2N1c3Npb25PbmxpbmVDaGF0QmFzZSBmcm9tIFwiLi9iYXNlXCI7XHJcbmltcG9ydCBEaXNjdXNzaW9uV2ViU29ja2V0cyBmcm9tIFwiLi93ZWJzb2NrZXRzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBZG1pbiBleHRlbmRzIERpc2N1c3Npb25XZWJTb2NrZXRzIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmFtcykge1xyXG4gICAgICAgIHN1cGVyKHBhcmFtcyk7XHJcblxyXG4gICAgICAgIHRoaXMucGFyYW1zLm1lc3NhZ2VzX3N0YXR1cyA9ICd1bnJlYWQnO1xyXG4gICAgICAgIHRoaXMucGFyYW1zLm1lc3NhZ2VzX3R5cGUgPSAnJztcclxuXHJcbiAgICAgICAgdGhpcy5wYXJhbXMubGFzdF91c2VyX2lkID0gbnVsbDtcclxuICAgICAgICB0aGlzLnBhcmFtcy5kZWFsZXJfaWQgPSAwO1xyXG4gICAgICAgIHRoaXMucGFyYW1zLmRpc2N1c3Npb25zX2lkcyA9IFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICAgIHN1cGVyLnN0YXJ0KCk7XHJcblxyXG4gICAgICAgIC8v0JfQsNCz0YDRg9C30LrQsCDRgdC/0LjRgdC60LAg0LTQuNGB0LrRg9GB0YHQuNC5INC/0L4g0LTQuNC70LXRgNGDXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgdGhpcy5wYXJhbXMub25fZGVhbGVyX3Nob3dfZGlzY3Vzc2lvbnMsICQucHJveHkodGhpcy5vblNob3dEZWFsZXJEaXNjdXNzaW9ucywgdGhpcykpO1xyXG5cclxuICAgICAgICAvL9Cf0LXRgNC10LrQu9GO0YfQtdC90LjQtSDQv9Cw0L3QtdC70LXQuSAo0KLQuNC/0Ysg0YHQvtC+0LHRidC10L3QuNC1IC0g0JLRgdC1INGB0L7QvtCx0YnQtdC90LjRjyAvINCi0L7Qu9GM0LrQviDQntCx0YnQuNC1KVxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsIHRoaXMucGFyYW1zLm9uX3N3aXRjaF9kaXNjdXNzaW9uc19tZXNzYWdlc190eXBlLCAkLnByb3h5KHRoaXMub25Td2l0Y2hEaXNjdXNzaW9uc01lc3NhZ2VzVHlwZXMsIHRoaXMpKTtcclxuXHJcbiAgICAgICAgLy/QktGL0LLQvtC0INGB0L/QuNGB0LrQsCDRgdC+0L7QsdGJ0LXQvdC40LkgKNCS0YHQtSDRgdC+0L7QsdGJ0LXQvdC40Y8g0L/QviDQt9Cw0Y/QstC60LUg0LjQu9C4INGC0L7Qu9GM0LrQviDQvdC10L/RgNC+0YfQuNGC0LDQvdC90YvQtSlcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCB0aGlzLnBhcmFtcy5vbl9zd2l0Y2hfZGlzY3Vzc2lvbnNfbWVzc2FnZXNfc3RhdHVzLCAkLnByb3h5KHRoaXMub25Td2l0Y2hEaXNjdXNzaW9uc01lc3NhZ2VzU3RhdHVzZXMsIHRoaXMpKTtcclxuXHJcbiAgICAgICAgLy/QpNC40LvRjNGC0YAg0L/QviDQvdCw0LfQstCw0L3QuNGOINC00LjQu9C10YDQsCAvINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDQuCDQvdC+0LzQtdGA0LAg0LTQuNC70LXRgNCwXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2tleXVwJywgJyN0eHRfZGlzY3Vzc2lvbnNfZmlsdGVyX2J5X25hbWUnLCAkLnByb3h5KHRoaXMub25GaWx0ZXJEaXNjdXNzaW9uc0J5TmFtZSwgdGhpcykpO1xyXG5cclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmpzLXNvcnQtZGVhbGVycycsICQucHJveHkodGhpcy5vbk1ha2VEZWFsZXJzU29ydCwgdGhpcykpO1xyXG5cclxuICAgICAgICB0aGlzLmluaXREZWZhdWx0VmFsdWVzKCk7XHJcbiAgICAgICAgdGhpcy5nZXRVbnJlYWRNZXNzYWdlc0NvdW50KCk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXREZWZhdWx0VmFsdWVzKCkge1xyXG4gICAgICAgIHRoaXMucGFyYW1zLmxhc3RfdXNlcl9pZCA9IHRoaXMuZ2V0RGVhbGVyc0l0ZW1zTGlzdCgpLmVxKDApLmRhdGEoJ3VzZXItaWQnKTtcclxuXHJcbiAgICAgICAgLy/Ql9Cw0LPRgNGD0LbQsNC10Lwg0LrQvtC70LjRh9C10YHRgtCy0L4g0L3QtdC/0YDQvtGH0LjRgtCw0L3QvdGL0YUg0YHQvtC+0LHRidC10L3QuNC5INC00LvRjyDQt9Cw0Y/QstC+0LpcclxuICAgICAgICB0aGlzLmxvYWRVbnJlYWREYXRhRm9yTW9kZWxzKCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2Nyb2xsRG93bih0aGlzLnNjcm9sbF9jb250YWluZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGxvYWRVbnJlYWREYXRhRm9yTW9kZWxzKCkge1xyXG4gICAgICAgIHZhciBtb2RlbHNfaWRzID0gJCgnLmRpc2N1c3Npb25fX2xpc3RfX2l0ZW0nLCB0aGlzLmdldERlYWxlckNvbnRhaW5lckRpc2N1c3Npb25zKCkpLm1hcCgoaW5kLCBpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAkKGl0ZW0pLmRhdGEoXCJtb2RlbC1pZFwiKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBQYWNlLnN0YXJ0KCk7XHJcblxyXG4gICAgICAgICAgICAkLnBvc3QodGhpcy5wYXJhbXMub25fbG9hZF9kaXNjdXNzaW9uX3VucmVhZF9tb2RlbHNfdXJsLCB7XHJcbiAgICAgICAgICAgICAgICBtb2RlbHNfaWRzOiBtb2RlbHNfaWRzLnRvQXJyYXkoKVxyXG4gICAgICAgICAgICB9LCAocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgUGFjZS5zdG9wKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAkLmVhY2gocmVzdWx0LnVucmVhZF9jb3VudCwgKGksIGNvdW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdW5yZWFkX21lc3NhZ2VzX2NvdW50ID0gcGFyc2VJbnQoY291bnQpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh1bnJlYWRfbWVzc2FnZXNfY291bnQgIT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoJ1tkYXRhLW1vZGVsLWlkPScgKyBpICsgJ10nLCB0aGlzLmdldERlYWxlckNvbnRhaW5lckRpc2N1c3Npb25zKCkpLmFwcGVuZChcIjxpIHN0eWxlPSd0b3A6IDkwJTsgcmlnaHQ6IDNweDsgbWluLXdpZHRoOiAwcHg7IGhlaWdodDogOXB4Oyc+Jm5ic3A7PC9pPlwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSkuY2F0Y2goKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yKHJlc3VsdC50aXRsZSwgcmVzdWx0Lm1zZyk7XHJcblxyXG4gICAgICAgICAgICBQYWNlLnN0b3AoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvL9Cf0LXRgNC10LrQu9GO0YfQtdC90LjQtSDQv9Cw0L3QtdC70LXQuSAo0KLQuNC/0Ysg0YHQvtC+0LHRidC10L3QuNC1IC0g0JLRgdC1INGB0L7QvtCx0YnQtdC90LjRjyAvINCi0L7Qu9GM0LrQviDQntCx0YnQuNC1KVxyXG4gICAgb25Td2l0Y2hEaXNjdXNzaW9uc01lc3NhZ2VzVHlwZXMoZXZlbnQpIHtcclxuICAgICAgICB0aGlzLm9uU3dpdGNoUGFuZWwoZXZlbnQsIHRoaXMucGFyYW1zLm9uX3N3aXRjaF9kaXNjdXNzaW9uc19tZXNzYWdlc190eXBlLCAoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBhcmFtcy5tZXNzYWdlc190eXBlID0gaXRlbS5kYXRhKCd0eXBlJyk7XHJcbiAgICAgICAgICAgIHRoaXMucGFyYW1zLm1lc3NhZ2VzX3N0YXR1cyA9ICdhbGwnO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5yZXNldERpc2N1c3Npb25NZXNzYWdlc1N0YXR1cygpO1xyXG4gICAgICAgICAgICB0aGlzLnN3aXRjaFBhbmVsc0J5VHlwZSgpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNlbGVjdGVkX2l0ZW0gPSB0aGlzLmdldEVsZW1lbnRCeUNsYXNzKCcuZGVhbGVyX21vZGVsX2l0ZW0nLCAnYWN0aXZlJyksXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZF9tb2RlbF9pdGVtID0gdGhpcy5nZXRFbGVtZW50QnlDbGFzcyh0aGlzLnBhcmFtcy5vbl9zaG93X2Rpc2N1c3Npb25fbWVzc2FnZXMsICdhY3RpdmUnKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZF9pdGVtICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFyYW1zLmRlYWxlcl9pZCA9IHNlbGVjdGVkX2l0ZW0uZGF0YSgnZGVhbGVyLWlkJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmFtcy5tb2RlbF9pZCA9IHNlbGVjdGVkX21vZGVsX2l0ZW0uZGF0YSgnbW9kZWwtaWQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWREaXNjdXNzaW9uQXNrTWVzc2FnZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8v0JfQsNCz0YDRg9C20LDQtdC8INGB0L/QuNGB0L7QuiDRgdC+0L7QsdGJ0LXQvdC40LUg0LTQu9GPINCy0YvQsdGA0LDQvdC90L7Qs9C+INC00LjQu9C10YDQsCwg0YLQvtC70YzQutC+INCe0LHRidC40LUg0YHQvtC+0LHRidC10L3QuNGPXHJcbiAgICBsb2FkRGlzY3Vzc2lvbkFza01lc3NhZ2VzKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy5tZXNzYWdlc190eXBlID09ICdhc2snKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyYW1zLm1vZGVsX21lc3NhZ2VzX2NvbnRhaW5lciA9ICcjY29udGFpbmVyLWRpc2N1c3Npb24tbWVzc2FnZXMtYXNrJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBhcmFtcy5tb2RlbF9tZXNzYWdlc19jb250YWluZXIgPSAnI2NvbnRhaW5lci1kaXNjdXNzaW9uLW1lc3NhZ2VzJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubG9hZERpc2N1c3Npb25NZXNzYWdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8v0J/QtdGA0LXQvtC/0YDQtdC00LXQu9GP0LXQvCDQvNC10YLQvtC0INC00LvRjyDQvtGC0L/RgNCw0LLQutC4INGB0L7QvtCx0YnQtdC90LjQtSDRgtC+0LvRjNC60L4g0LLRi9Cx0YDQsNC90L3QvtC80YMg0LTQuNC70LXRgNGDXHJcbiAgICBsb2FkQXNrTWVzc2FnZXMoKSB7XHJcbiAgICAgICAgdGhpcy5sb2FkRGlzY3Vzc2lvbkFza01lc3NhZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Td2l0Y2hEaXNjdXNzaW9uc01lc3NhZ2VzU3RhdHVzZXMoZXZlbnQpIHtcclxuICAgICAgICB0aGlzLm9uU3dpdGNoUGFuZWwoZXZlbnQsIHRoaXMucGFyYW1zLm9uX3N3aXRjaF9kaXNjdXNzaW9uc19tZXNzYWdlc19zdGF0dXMsIChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGFyYW1zLm1lc3NhZ2VzX3N0YXR1cyA9IGl0ZW0uZGF0YSgndHlwZScpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNlbGVjdGVkX2l0ZW0gPSB0aGlzLmdldEVsZW1lbnRCeUNsYXNzKHRoaXMucGFyYW1zLm9uX3Nob3dfZGlzY3Vzc2lvbl9tZXNzYWdlcywgJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRfaXRlbSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmFtcy5tb2RlbF9pZCA9IHNlbGVjdGVkX2l0ZW0uZGF0YSgnbW9kZWwtaWQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWREaXNjdXNzaW9uTWVzc2FnZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU3dpdGNoUGFuZWwoZXZlbnQsIGVsZW1lbnQsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgbGV0IGl0ZW0gPSAkKGV2ZW50LnRhcmdldCk7XHJcblxyXG4gICAgICAgIGlmICghaXRlbS5oYXNDbGFzcygnY3VycmVudCcpKSB7XHJcbiAgICAgICAgICAgICQoZWxlbWVudCkucmVtb3ZlQ2xhc3MoJ2N1cnJlbnQnKTtcclxuICAgICAgICAgICAgaXRlbS5hZGRDbGFzcygnY3VycmVudCcpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQpNC40LvRjNGC0YAg0YHQv9C40YHQutCwINC00LjRgdC60YPRgdGB0LjQuVxyXG4gICAgICogQHBhcmFtIGV2ZW50XHJcbiAgICAgKi9cclxuICAgIG9uRmlsdGVyRGlzY3Vzc2lvbnNMaXN0KGV2ZW50KSB7XHJcbiAgICAgICAgc3VwZXIub25GaWx0ZXJEaXNjdXNzaW9uc0xpc3QoZXZlbnQpO1xyXG5cclxuICAgICAgICAkKCcjdHh0X2Rpc2N1c3Npb25zX2ZpbHRlcl9ieV9uYW1lJykudmFsKCcnKTtcclxuICAgIH1cclxuXHJcbiAgICBvblNob3dEZWFsZXJEaXNjdXNzaW9ucyhldmVudCkge1xyXG4gICAgICAgIGxldCBpdGVtID0gJChldmVudC50YXJnZXQpO1xyXG5cclxuICAgICAgICBpZiAoaXRlbS5kYXRhKCd1c2VyLWlkJykgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGl0ZW0gPSBpdGVtLnBhcmVudCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy/QldGB0LvQuCDQv9GA0Lgg0LfQsNCz0YDRg9C30LrQtSDRgdC/0LjRgdC60LAg0YHQvtC+0LHRidC10L3QuNC1INC/0LDQvdC10LvRjCDQv9C10YDQtdC60LvRjtGH0LXQvdCwINC90LAg0J3QtdC/0YDQvtGH0LjRgtCw0L3QvdGL0LUsINCw0LLRgtC+0LzQsNGC0LjRh9C10YHQutC4INC/0LXRgNC10LLQvtC00LjQvCDQv9Cw0L3QtdC70Ywg0LIg0L7QsdGL0YfQvdGL0Lkg0YHRgtCw0YLRg9GBXHJcbiAgICAgICAgLyppZiAodGhpcy5wYXJhbXMubWVzc2FnZXNfc3RhdHVzID09ICd1bnJlYWQnICkge1xyXG4gICAgICAgICB0aGlzLmdldERpc2N1c3Npb25NZXNzYWdlc1N0YXR1c1N3aXRjaCgpLnJlbW92ZUNsYXNzKCdjdXJyZW50JykuZXEoMCkuYWRkQ2xhc3MoJ2N1cnJlbnQnKTtcclxuICAgICAgICAgfSovXHJcbiAgICAgICAgLy/Qn9C+INGD0LzQvtC70YfQsNC90LjRjiDQvtGC0LrRgNGL0LLQsNC10Lwg0L/QvtC90LXQu9GMINGBINC90LXQv9GA0L7Rh9C40YLQsNC90L3Ri9C80Lgg0YHQvtC+0LHRidC10L3QuNGP0LzQuFxyXG4gICAgICAgIHRoaXMuZ2V0RGlzY3Vzc2lvbk1lc3NhZ2VzU3RhdHVzU3dpdGNoKCkucmVtb3ZlQ2xhc3MoJ2N1cnJlbnQnKS5lcSgxKS5hZGRDbGFzcygnY3VycmVudCcpO1xyXG5cclxuICAgICAgICAvL9Cf0YDQuNC90YPQtNC40YLQtdC70YzQvdC+INC/0LXRgNC10LLQvtC00LjQvCDQvdCwINC/0LDQvdC10LvRjCDQt9Cw0Y/QstC+0LpcclxuICAgICAgICBpZiAodGhpcy5wYXJhbXMubWVzc2FnZXNfdHlwZSA9PSAnYXNrJykge1xyXG4gICAgICAgICAgICAkKCdbZGF0YS10eXBlPVwiYWxsXCJdJykudHJpZ2dlcignY2xpY2snKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGFyYW1zLmxhc3RfdXNlcl9pZCA9IGl0ZW0uZGF0YSgndXNlci1pZCcpO1xyXG4gICAgICAgIHRoaXMucGFyYW1zLmRlYWxlcl9pZCA9IGl0ZW0uZGF0YSgnZGVhbGVyLWlkJyk7XHJcblxyXG4gICAgICAgIHRoaXMuZ2V0RGVhbGVyc0l0ZW1zTGlzdCgpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICBpdGVtLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBQYWNlLnN0YXJ0KCk7XHJcblxyXG4gICAgICAgICAgICAkLnBvc3QodGhpcy5wYXJhbXMub25fbG9hZF9kZWFsZXJfZGlzY3Vzc2lvbnNfdXJsLCB7XHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJfYnlfdXNlcjogaXRlbS5kYXRhKCd1c2VyLWlkJyksXHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJfYnlfZGVhbGVyOiB0aGlzLnBhcmFtcy5kZWFsZXJfaWQsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlc190eXBlOiBcInVucmVhZFwiLFxyXG5cclxuICAgICAgICAgICAgfSwgKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgUGFjZS5zdG9wKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmdldERlYWxlckNvbnRhaW5lckRpc2N1c3Npb25zKCkuaHRtbChyZXN1bHQuZGVhbGVyX2Rpc2N1c3Npb25zKTtcclxuICAgICAgICAgICAgdGhpcy5nZXREZWFsZXJDb250YWluZXJEaXNjdXNzaW9uc01lc3NhZ2VzKCkuaHRtbChyZXN1bHQudW5yZWFkX21lc3NhZ2VzX2xpc3QpO1xyXG4gICAgICAgICAgICB0aGlzLmdldERlYWxlckNvbnRhaW5lckRpc2N1c3Npb25zQXNrTWVzc2FnZXMoKS5odG1sKHJlc3VsdC5kZWFsZXJfZGlzY3Vzc2lvbl9hc2tfbWVzc2FnZXNfbGlzdCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNldERlZmF1bHREaXNjdXNzaW9uSXRlbSh0cnVlKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsRG93bih0aGlzLnNjcm9sbF9jb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgLy/Ql9Cw0LPRgNGD0LbQsNC10Lwg0LrQvtC70LjRh9C10YHRgtCy0L4g0L3QtdC/0YDQvtGH0LjRgtCw0L3QvdGL0YUg0YHQvtC+0LHRidC10L3QuNC5INC00LvRjyDQt9Cw0Y/QstC+0LpcclxuICAgICAgICAgICAgdGhpcy5sb2FkVW5yZWFkRGF0YUZvck1vZGVscygpO1xyXG4gICAgICAgIH0pLmNhdGNoKChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvcihyZXN1bHQudGl0bGUsIHJlc3VsdC5tc2cpO1xyXG5cclxuICAgICAgICAgICAgUGFjZS5zdG9wKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzY3Vzc2lvbnNDb250YWluZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJyNkZWFsZXJzLWRpc2N1c3Npb25zLWNvbnRhaW5lcicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0KPRgdGC0LDQvdC+0LLQuNGC0Ywg0L/QviDRg9C80L7Qu9GH0LDQvdC40Y4g0LLRi9Cx0YDQsNC90L3Rg9GOINC00LjRgdC60YPRgdGB0LjRjiDQv9C+INC30LDRj9Cy0LrQtVxyXG4gICAgICogQHBhcmFtIGZvcmNpYmx5X3NldFxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgc2V0RGVmYXVsdERpc2N1c3Npb25JdGVtKGZvcmNpYmx5X3NldCA9IGZhbHNlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubGFzdF9kaXNjdXNzaW9uX2l0ZW0gPT0gbnVsbCB8fCBmb3JjaWJseV9zZXQpIHtcclxuICAgICAgICAgICAgdGhpcy5sYXN0X2Rpc2N1c3Npb25faXRlbSA9ICQoJy5kaXNjdXNzaW9uX19saXN0X19pdGVtJywgdGhpcy5nZXREZWFsZXJDb250YWluZXJEaXNjdXNzaW9ucygpKS5lcSgwKTtcclxuXHJcbiAgICAgICAgICAgIC8v0KPRgdGC0LDQvdCw0LvQuNCy0LDQtdC8INC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOINCw0LrRgtC40LLQvdGD0Y4g0LfQsNGP0LLQutGDXHJcbiAgICAgICAgICAgIHRoaXMucGFyYW1zLm1vZGVsX2lkID0gdGhpcy5sYXN0X2Rpc2N1c3Npb25faXRlbS5kYXRhKCdtb2RlbC1pZCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBkcmF3VW5yZWFkRGlzY3Vzc2lvbkRhdGEocmVzdWx0KSB7XHJcbiAgICAgICAgJC5lYWNoKHJlc3VsdC51bnJlYWRfY291bnQsIChpbmRleCwgdmFsdWUpID0+IHtcclxuICAgICAgICAgICAgJCgnLmRpc2N1c3Npb25fX2xpc3RfX2l0ZW1fXycgKyBpbmRleCwgdGhpcy5nZXREaXNjdXNzaW9uc0NvbnRhaW5lcigpKS5hdHRyKCdkYXRhLXVucmVhZCcsIHRydWUpO1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAkKCcuZGlzY3Vzc2lvbl9fbGlzdF9faXRlbV9fJyArIGluZGV4LCB0aGlzLmdldERpc2N1c3Npb25zQ29udGFpbmVyKCkpLmF0dHIoJ2RhdGEtdW5yZWFkLWNvdW50JywgdmFsdWUpLmFwcGVuZCgnPGk+JyArIHZhbHVlICsgJzwvaT4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERlYWxlckNvbnRhaW5lckRpc2N1c3Npb25zKCkge1xyXG4gICAgICAgIHJldHVybiAkKHRoaXMucGFyYW1zLmNvbnRhaW5lcl9kZWFsZXJfZGlzY3Vzc2lvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0J/QsNC90LXQu9GMINC+0LHRi9GH0L3Ri9GFINGB0L7QvtCx0YnQtdC90LjQuVxyXG4gICAgICogQHJldHVybnMgeyp8alF1ZXJ5fEhUTUxFbGVtZW50fVxyXG4gICAgICovXHJcbiAgICBnZXREZWFsZXJDb250YWluZXJEaXNjdXNzaW9uc01lc3NhZ2VzKCkge1xyXG4gICAgICAgIHJldHVybiAkKHRoaXMucGFyYW1zLmNvbnRhaW5lcl9kaXNjdXNzaW9uX21lc3NhZ2VzKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCf0LDQvdC10LvRjCDQstC+0L/RgNC+0YHQvtCyXHJcbiAgICAgKiBAcmV0dXJucyB7KnxqUXVlcnl8SFRNTEVsZW1lbnR9XHJcbiAgICAgKi9cclxuICAgIGdldERlYWxlckNvbnRhaW5lckRpc2N1c3Npb25zQXNrTWVzc2FnZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuICQodGhpcy5wYXJhbXMuY29udGFpbmVyX2Rpc2N1c3Npb25fYXNrX21lc3NhZ2VzKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREZWFsZXJzSXRlbXNMaXN0KCkge1xyXG4gICAgICAgIHJldHVybiAkKHRoaXMucGFyYW1zLm9uX2RlYWxlcl9zaG93X2Rpc2N1c3Npb25zKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREaXNjdXNzaW9uTWVzc2FnZXNTdGF0dXNTd2l0Y2goKSB7XHJcbiAgICAgICAgcmV0dXJuICQodGhpcy5wYXJhbXMub25fc3dpdGNoX2Rpc2N1c3Npb25zX21lc3NhZ2VzX3N0YXR1cyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzY3Vzc2lvbk1lc3NhZ2VzVHlwZXNTd2l0Y2goKSB7XHJcbiAgICAgICAgcmV0dXJuICQodGhpcy5wYXJhbXMub25fc3dpdGNoX2Rpc2N1c3Npb25zX21lc3NhZ2VzX3R5cGUpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERpc2N1c3Npb25JdGVtUGFyZW50KCkge1xyXG4gICAgICAgIHJldHVybiAkKCcjZGVhbGVycy1kaXNjdXNzaW9ucy1jb250YWluZXInKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCk0LjQu9GM0YLRgCDRgdC/0LjRgdC60LAg0LTQuNC70LXRgNC+0LIg0L/QviDQuNC80LXQvdC4IC8g0L3QvtC80LXRgNGDIC8g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GOXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRcclxuICAgICAqL1xyXG4gICAgb25GaWx0ZXJEaXNjdXNzaW9uc0J5TmFtZShldmVudCkge1xyXG4gICAgICAgIGxldCBmaWVsZCA9ICQoZXZlbnQudGFyZ2V0KSwgdmFsdWUgPSAkLnRyaW0oZmllbGQudmFsKCkpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICQoJ1tkYXRhLXVzZXItbmFtZV0sIFtkYXRhLWRlYWxlci1uYW1lXSwgW2RhdGEtZGVhbGVyLW51bWJlcl0nKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGhpZGVfZWxlbWVudCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCQoZWxlbWVudCkuZGF0YSgndXNlci1uYW1lJykudG9Mb3dlckNhc2UoKS5pbmRleE9mKHZhbHVlKSAhPSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVfZWxlbWVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICQoZWxlbWVudCkuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICgkKGVsZW1lbnQpLmRhdGEoJ2RlYWxlci1uYW1lJykudG9Mb3dlckNhc2UoKS5pbmRleE9mKHZhbHVlKSAhPSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVfZWxlbWVudCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICQoZWxlbWVudCkuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICgkKGVsZW1lbnQpLmRhdGEoJ2RlYWxlci1udW1iZXInKS50b1N0cmluZygpLmluZGV4T2YodmFsdWUpICE9IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZV9lbGVtZW50ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJChlbGVtZW50KS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGhpZGVfZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoZWxlbWVudCkuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmdldERpc2N1c3Npb25MaXN0SXRlbSgpLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc3dpdGNoUGFuZWxzQnlUeXBlKCkge1xyXG4gICAgICAgICQoJy5kaXNjdXNzaW9uLW1lc3NhZ2VzLWxpc3QtYnktdHlwZScpLmhpZGUoKTtcclxuICAgICAgICAkKCdbZGF0YS1jb250YWluZXItdHlwZT0nICsgdGhpcy5wYXJhbXMubWVzc2FnZXNfdHlwZSArICddJykuc2hvdygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBFdmVudCBldmVudFxyXG4gICAgICovXHJcbiAgICBvbk1ha2VEZWFsZXJzU29ydChldmVudCkge1xyXG4gICAgICAgIGxldCAkZWxlbWVudCA9ICQoZXZlbnQudGFyZ2V0KSwgZGVhbGVyc19saXN0ID0gW107XHJcblxyXG4gICAgICAgICQoJy5kZWFsZXJfbW9kZWxfaXRlbScpLmVhY2goKGluZGV4LCBlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGRlYWxlcnNfbGlzdC5wdXNoKCQoZWxlbWVudCkpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBkZWFsZXJzX2xpc3Quc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICBsZXQgYV9uYW1lID0gYS5kYXRhKCdkZWFsZXItbmFtZScpLnRvTG93ZXJDYXNlKCksIGJfbmFtZSA9IGIuZGF0YSgnZGVhbGVyLW5hbWUnKS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGFfbmFtZSA+IGJfbmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRlbGVtZW50LmRhdGEoJ3NvcnQtZGlyZWN0aW9uJykgPT0gJ2FzYycgPyAxIDogLTE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChhX25hbWUgPCBiX25hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkZWxlbWVudC5kYXRhKCdzb3J0LWRpcmVjdGlvbicpID09ICdhc2MnID8gLTEgOiAxO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5nZXREaXNjdXNzaW9uc0NvbnRhaW5lcigpLmh0bWwoJycpO1xyXG4gICAgICAgIGZvciAobGV0IGl0ZW0gb2YgZGVhbGVyc19saXN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RGlzY3Vzc2lvbnNDb250YWluZXIoKS5hcHBlbmQoaXRlbSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkZWxlbWVudC5kYXRhKCdzb3J0LWRpcmVjdGlvbicsICRlbGVtZW50LmRhdGEoJ3NvcnQtZGlyZWN0aW9uJykgPT0gJ2FzYycgPyAnZGVzYycgOiAnYXNjJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgeyp8alF1ZXJ5fEhUTUxFbGVtZW50fVxyXG4gICAgICovXHJcbiAgICBnZXREaXNjdXNzaW9uQXNrTWVzc2FnZXNDb250YWluZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICQodGhpcy5wYXJhbXMuY29udGFpbmVyX2Rpc2N1c3Npb25fYXNrX21lc3NhZ2VzKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCf0L7Qu9GD0YfQuNGC0Ywg0LTQsNC90L3Ri9C1INC+INGC0L7QvCDQutC+0LzRgyDQvtGC0L/RgNCw0LLQu9GP0YLRjCDRgdC+0L7QsdGJ0LXQvdC40LUgKNC00LjQu9C10YDRgyDQuNC70Lgg0LjQvNC/0L7RgNGC0LXRgNCw0LwpXHJcbiAgICAgKiBAcmV0dXJucyB7e2RpcmVjdGlvbjogc3RyaW5nfX1cclxuICAgICAqL1xyXG4gICAgZ2V0TWVzc2FnZURpcmVjdGlvbihtZXNzYWdlX3R5cGUpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAnZGlyZWN0aW9uJzogdGhpcy5nZXRNZXNzYWdlU2VuZFRvKG1lc3NhZ2VfdHlwZSkgIT0gdW5kZWZpbmVkICYmIHRoaXMuZ2V0TWVzc2FnZVNlbmRUbyhtZXNzYWdlX3R5cGUpLmlzKCc6Y2hlY2tlZCcpID8gJ2ltcG9ydGVyJyA6ICcnXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCU0LXQu9Cw0LXQvCDQt9Cw0L/RgNC+0YEg0L/QviB3cyDQtNC70Y8g0LjQvdGE0L7RgNC80LjRgNC+0LLQsNC90LjQuCDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y8g0L4g0L3QvtCy0L7QvCDRgdC+0L7QsdGJ0LXQvdC40LhcclxuICAgICAqIEBwYXJhbSBkYXRhXHJcbiAgICAgKi9cclxuICAgIG1ha2VSZXF1ZXN0RGF0YShkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5tYWtlUmVxdWVzdCgnbmV3TWVzc2FnZScsIGRhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0J/QvtC70YPRh9C40YLRjCDQvdCw0L/RgNCw0LLQu9C10L3QuNC1INC+0YLQv9GA0LDQstC60LjQuCDRgdC+0L7QsdGJ0LXQvdC40Y8gKNC00LvRjyDQtNC40LvQtdGA0LAg0LjQu9C4INC40LzQv9C+0YDRgtC10YDQsClcclxuICAgICAqIEBwYXJhbSBtZXNzYWdlX3R5cGVcclxuICAgICAqIEByZXR1cm5zIHsqfGpRdWVyeXxIVE1MRWxlbWVudH1cclxuICAgICAqL1xyXG4gICAgZ2V0TWVzc2FnZVNlbmRUbyhtZXNzYWdlX3R5cGUpIHtcclxuICAgICAgICBpZiAobWVzc2FnZV90eXBlID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJCgnLm1lc3NhZ2UtdG8taW1wb3J0ZXInLCAkKCdbZGF0YS1jb250YWluZXItdHlwZT1cImFsbFwiXScpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiAkKCcubWVzc2FnZS10by1pbXBvcnRlcicsIG1lc3NhZ2VfdHlwZSA9PSAnbWVzc2FnZScgPyAkKCdbZGF0YS1jb250YWluZXItdHlwZT1cImFsbFwiXScpIDogJCgnW2RhdGEtY29udGFpbmVyLXR5cGU9XCJhc2tcIl0nKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQntCx0L3Rg9C70LXQvdC40LUg0L/QsNC90LXQu9C10Lkg0L7RgtC+0LHRgNCw0LbQtdC90LjQtSDQt9Cw0Y/QstC+0Log0L/QviDRgdGC0LDRgtGD0YHRgyAo0JLRgdC1INC40LvQuCDQndC10L/RgNC+0YfQuNGC0LDQvdC90YvQtSlcclxuICAgICAqL1xyXG4gICAgcmVzZXREaXNjdXNzaW9uTWVzc2FnZXNTdGF0dXMoKSB7XHJcbiAgICAgICAgJCgnLmRpc2N1c3Npb25zLW1lc3NhZ2VzLXN0YXR1cycpLnJlbW92ZUNsYXNzKCdjdXJyZW50Jyk7XHJcbiAgICAgICAgJCgnLmRpc2N1c3Npb25zLW1lc3NhZ2VzLXN0YXR1cycpLmVxKDApLmFkZENsYXNzKCdjdXJyZW50Jyk7XHJcbiAgICB9XHJcbn1cclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHd3dy9qcy9jaGF0cy9kZXYvY2xhc3Nlcy9hZG1pbi5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUlBO0FBQ0E7Ozs7Ozs7OztBQUxBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBU0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7QUFLQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXJCQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBc0JBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUF4QkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBeUJBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUdBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUF0WUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///1\n")},/*!******************************************************!*\
  !*** ./www/js/chats/dev/classes/admin_websockets.js ***!
  \******************************************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _websockets = __webpack_require__(/*! ./websockets */ 0);\n\nvar _websockets2 = _interopRequireDefault(_websockets);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by kostet on 02.09.2017.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar AdminWebSockets = function (_DiscussionWebSockets) {\n    _inherits(AdminWebSockets, _DiscussionWebSockets);\n\n    function AdminWebSockets() {\n        _classCallCheck(this, AdminWebSockets);\n\n        return _possibleConstructorReturn(this, (AdminWebSockets.__proto__ || Object.getPrototypeOf(AdminWebSockets)).call(this));\n    }\n\n    _createClass(AdminWebSockets, [{\n        key: \'onMessage\',\n        value: function onMessage(event) {\n            var data = JSON.parse(event.data);\n\n            if (data.action == \'newMessage\') {\n                console.log(data.data.users_who_get_messages);\n            }\n        }\n    }]);\n\n    return AdminWebSockets;\n}(_websockets2.default);\n\nexports.default = AdminWebSockets;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvYWRtaW5fd2Vic29ja2V0cy5qcz82MDk5Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGtvc3RldCBvbiAwMi4wOS4yMDE3LlxyXG4gKi9cclxuXHJcbmltcG9ydCBEaXNjdXNzaW9uV2ViU29ja2V0cyBmcm9tICcuL3dlYnNvY2tldHMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWRtaW5XZWJTb2NrZXRzIGV4dGVuZHMgRGlzY3Vzc2lvbldlYlNvY2tldHMge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbk1lc3NhZ2UoZXZlbnQpIHtcclxuICAgICAgICBsZXQgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7XHJcblxyXG4gICAgICAgIGlmIChkYXRhLmFjdGlvbiA9PSAnbmV3TWVzc2FnZScpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YS5kYXRhLnVzZXJzX3dob19nZXRfbWVzc2FnZXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn1cclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHd3dy9qcy9jaGF0cy9kZXYvY2xhc3Nlcy9hZG1pbl93ZWJzb2NrZXRzLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUlBO0FBQ0E7Ozs7Ozs7OztBQUxBOzs7O0FBTUE7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQVhBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///2\n')},/*!*********************************!*\
  !*** ./www/js/chats/dev/app.js ***!
  \*********************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _chat_by_ws = __webpack_require__(/*! ./classes/chat_by_ws */ 4);\n\nvar _chat_by_ws2 = _interopRequireDefault(_chat_by_ws);\n\nvar _dealer = __webpack_require__(/*! ./classes/dealer */ 6);\n\nvar _dealer2 = _interopRequireDefault(_dealer);\n\nvar _admin = __webpack_require__(/*! ./classes/admin */ 1);\n\nvar _admin2 = _interopRequireDefault(_admin);\n\nvar _importer = __webpack_require__(/*! ./classes/importer */ 7);\n\nvar _importer2 = _interopRequireDefault(_importer);\n\nvar _dealer_websockets = __webpack_require__(/*! ./classes/dealer_websockets */ 8);\n\nvar _dealer_websockets2 = _interopRequireDefault(_dealer_websockets);\n\nvar _admin_websockets = __webpack_require__(/*! ./classes/admin_websockets */ 2);\n\nvar _admin_websockets2 = _interopRequireDefault(_admin_websockets);\n\nvar _importer_websockets = __webpack_require__(/*! ./classes/importer_websockets */ 9);\n\nvar _importer_websockets2 = _interopRequireDefault(_importer_websockets);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DiscussionOnlineApp = function () {\n    function DiscussionOnlineApp() {\n        _classCallCheck(this, DiscussionOnlineApp);\n    }\n\n    _createClass(DiscussionOnlineApp, [{\n        key: 'startDealer',\n        value: function startDealer(params) {\n            //params.websockets = new DealerWebSockets();\n\n            return new _dealer2.default(params).start();\n        }\n    }, {\n        key: 'startAdmin',\n        value: function startAdmin(params) {\n            //params.websockets = new AdminWebSockets();\n\n            return new _admin2.default(params).start();\n        }\n    }, {\n        key: 'startImporter',\n        value: function startImporter(params) {\n            //params.websockets = new ImporterWebSockets();\n\n            return new _importer2.default(params).start();\n        }\n    }]);\n\n    return DiscussionOnlineApp;\n}();\n\nexports.default = DiscussionOnlineApp;\n\n\nif (RegExp('messages', 'gi').test(window.location.href)) {\n    if (window.discussion_online == undefined) {\n        window.discussion_online = new DiscussionOnlineApp();\n    }\n} else {\n    if (window.discussion_online == undefined) {\n        window.discussion_online = new _chat_by_ws2.default();\n    }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2FwcC5qcz9lZDc3Il0sInNvdXJjZXNDb250ZW50IjpbIlxyXG5pbXBvcnQgQ2hhdEJ5V1MgZnJvbSAnLi9jbGFzc2VzL2NoYXRfYnlfd3MnO1xyXG5cclxuaW1wb3J0IERlYWxlciBmcm9tICcuL2NsYXNzZXMvZGVhbGVyJztcclxuaW1wb3J0IEFkbWluIGZyb20gJy4vY2xhc3Nlcy9hZG1pbic7XHJcbmltcG9ydCBJbXBvcnRlciBmcm9tICcuL2NsYXNzZXMvaW1wb3J0ZXInO1xyXG5cclxuaW1wb3J0IERlYWxlcldlYlNvY2tldHMgZnJvbSAnLi9jbGFzc2VzL2RlYWxlcl93ZWJzb2NrZXRzJztcclxuaW1wb3J0IEFkbWluV2ViU29ja2V0cyBmcm9tICcuL2NsYXNzZXMvYWRtaW5fd2Vic29ja2V0cyc7XHJcbmltcG9ydCBJbXBvcnRlcldlYlNvY2tldHMgZnJvbSAnLi9jbGFzc2VzL2ltcG9ydGVyX3dlYnNvY2tldHMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGlzY3Vzc2lvbk9ubGluZUFwcCB7XHJcbiAgICBzdGFydERlYWxlcihwYXJhbXMpIHtcclxuICAgICAgICAvL3BhcmFtcy53ZWJzb2NrZXRzID0gbmV3IERlYWxlcldlYlNvY2tldHMoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBEZWFsZXIocGFyYW1zKS5zdGFydCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0QWRtaW4ocGFyYW1zKSB7XHJcbiAgICAgICAgLy9wYXJhbXMud2Vic29ja2V0cyA9IG5ldyBBZG1pbldlYlNvY2tldHMoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBBZG1pbihwYXJhbXMpLnN0YXJ0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhcnRJbXBvcnRlcihwYXJhbXMpIHtcclxuICAgICAgICAvL3BhcmFtcy53ZWJzb2NrZXRzID0gbmV3IEltcG9ydGVyV2ViU29ja2V0cygpO1xyXG5cclxuICAgICAgICByZXR1cm4gbmV3IEltcG9ydGVyKHBhcmFtcykuc3RhcnQoKTtcclxuICAgIH1cclxufVxyXG5cclxuaWYgKFJlZ0V4cCgnbWVzc2FnZXMnLCAnZ2knKS50ZXN0KHdpbmRvdy5sb2NhdGlvbi5ocmVmKSkge1xyXG4gICAgaWYgKHdpbmRvdy5kaXNjdXNzaW9uX29ubGluZSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB3aW5kb3cuZGlzY3Vzc2lvbl9vbmxpbmUgPSBuZXcgRGlzY3Vzc2lvbk9ubGluZUFwcCgpO1xyXG4gICAgfVxyXG59IGVsc2Uge1xyXG4gICAgaWYgKHdpbmRvdy5kaXNjdXNzaW9uX29ubGluZSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB3aW5kb3cuZGlzY3Vzc2lvbl9vbmxpbmUgPSBuZXcgQ2hhdEJ5V1MoKTtcclxuICAgIH1cclxufVxyXG5cclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHd3dy9qcy9jaGF0cy9kZXYvYXBwLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7Ozs7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQWpCQTtBQUNBO0FBQ0E7QUFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///3\n")},/*!************************************************!*\
  !*** ./www/js/chats/dev/classes/chat_by_ws.js ***!
  \************************************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _websockets = __webpack_require__(/*! ./websockets */ 0);\n\nvar _websockets2 = _interopRequireDefault(_websockets);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by kostet on 04.09.2017.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar ChatByWS = function (_DiscussionWebSockets) {\n    _inherits(ChatByWS, _DiscussionWebSockets);\n\n    function ChatByWS() {\n        _classCallCheck(this, ChatByWS);\n\n        var _this = _possibleConstructorReturn(this, (ChatByWS.__proto__ || Object.getPrototypeOf(ChatByWS)).call(this));\n\n        _this.initialized = false;\n        _this.in_chat = false;\n        _this.is_open = true;\n        _this.new_messages_counter = 0;\n        _this.discussion_model_messages_chat_uploader = undefined;\n        _this.message_type = null;\n\n        _this.discussion_id = 0;\n        _this.discussions_list = {};\n        _this.model_id = 0;\n\n        _this.clean_chat_items_in_minutes = 5;\n        return _this;\n    }\n\n    _createClass(ChatByWS, [{\n        key: 'init',\n        value: function init() {\n            var _this2 = this;\n\n            if (!this.initialized) {\n                this.initialized = true;\n\n                $(document).on('click', '#discussion-live-chat header', function () {\n                    $('.discussion-chat, .discussion-chat-users').slideToggle(300, 'swing');\n                    $('.chat-message-counter').fadeToggle(300, 'swing');\n\n                    if (!_this2.is_open) {\n                        _this2.getChatMessageCounterElement().html(0);\n                        _this2.new_messages_counter = 0;\n                    }\n\n                    //Спускаемся до последнего сообщения\n                    _this2.scrollDown('chat-history');\n\n                    _this2.is_open = !_this2.is_open;\n                });\n\n                $(document).on('click', '.chat-close', function (e) {\n                    e.preventDefault();\n                    $('#discussion-live-chat').fadeOut(300);\n\n                    _this2.in_chat = false;\n                });\n\n                //Переключение чатов\n                $(document).on('click', '.discussion-chat-user-item', $.proxy(this.onSwitchChat, this));\n\n                //Удаление чата (двойной клик)\n                $(document).on('dblclick', '.discussion-chat-user-item', $.proxy(this.onDestroyChat, this));\n\n                $(document).on('click', '#frm-discussion-chat-send-button', $.proxy(this.onSendChatMessage, this));\n\n                $(document).on('keyup', '#frm-message-chat', $.proxy(this.onMessagesFieldEnterKeyPress, this));\n\n                //Если дискуссия уже велась отображаем диалог дискусси между пользователями, берем данные с localStorage\n                this.loadChatDiscussionsIfWeHaveAlreadyChatsWithUsers();\n                //$document\n\n                //Очистка данных в чате если время последней беседы больше 5 минут\n                this.cleanChats();\n            }\n        }\n    }, {\n        key: 'onOpen',\n        value: function onOpen() {\n            _get(ChatByWS.prototype.__proto__ || Object.getPrototypeOf(ChatByWS.prototype), 'onOpen', this).call(this);\n\n            this.init();\n        }\n\n        /**\r\n         * Отправка сообщение по Enter\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onMessagesFieldEnterKeyPress',\n        value: function onMessagesFieldEnterKeyPress(event) {\n            if (event.keyCode == 13) {\n                this.onSendChatMessage(event);\n            }\n        }\n\n        //Отправить сообщение\n\n    }, {\n        key: 'onSendChatMessage',\n        value: function onSendChatMessage(event, callback) {\n            var _this3 = this;\n\n            event.preventDefault();\n\n            var element = $(event.target),\n                send_url = element.closest('form').data('send-url'),\n                total_uploaded_files = 0,\n                active_discussion_item = this.getActiveUserChat();\n\n            if (active_discussion_item.length == 0) {\n                showAlertPopup('Ошибка.', 'Выберите чат.');\n                return;\n            }\n\n            var discussion_item = this.discussions_list[active_discussion_item.data('discussion-id')];\n\n            this.discussion_id = discussion_item.discussion_id;\n            this.discussions_list[this.discussion_id].time = Date.now();\n\n            for (var i in this.getFilesParam(this.discussion_model_messages_chat_uploader)) {\n                if (this.getFilesParam(this.discussion_model_messages_chat_uploader).hasOwnProperty(i)) {\n                    total_uploaded_files++;\n                }\n            }\n\n            if (this.posting || $.trim(this.getMessage()) == '' && total_uploaded_files == 0) {\n                showAlertPopup('Ошибка.', 'Введите сообщение или загрузите файл.');\n                return;\n            }\n\n            var data = $.extend(this.getFilesParam(), {\n                id: discussion_item.discussion_id,\n                model_id: discussion_item.model_id,\n                dealer_id: discussion_item.dealer_id,\n                message: this.getMessage(),\n                reply_on_message_id: 0,\n                message_type: discussion_item.message_type\n            });\n\n            this.posting = true;\n            new Promise(function (resolve, reject) {\n                $.post(send_url, data, function (result) {\n                    resolve(result);\n                    _this3.posting = false;\n                });\n            }).then(function (result) {\n                _this3.getMessageField().val('');\n                _this3.deleteSentFiles(_this3.discussion_model_messages_chat_uploader);\n\n                if (result.response != undefined) {\n                    _this3.getChatDialogContentContainer().html(result.response.messages_list);\n\n                    _this3.scrollDown('chat-history');\n\n                    data = $.extend(result.response, data);\n\n                    _this3.sendMessageToOthersUsers(data);\n                    _this3.saveDiscussionList();\n                }\n\n                if (callback != undefined) {\n                    callback(result);\n                }\n            });\n        }\n\n        /**\r\n         * Удаление чата\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onDestroyChat',\n        value: function onDestroyChat(event) {\n            var element = $(event.target),\n                discussion_id = element.data('discussion-id'),\n                discussions_list = {};\n\n            element.remove();\n            $.each(this.discussions_list, function (index, item) {\n                if (item.discussion_id != discussion_id) {\n                    discussions_list[item.discussion_id] = item;\n                }\n            });\n\n            this.getUserNameElement().html('');\n\n            this.discussions_list = discussions_list;\n\n            //Очищаем список сообщений\n            this.getChatDialogContentContainer().html('');\n\n            //Созраняем список дискуссий в локальную память\n            this.saveDiscussionList();\n\n            //Если количество дискуссий 0, скрываем диалог\n            if (this.getDiscussionsCountInChat() <= 0) {\n                //Убараем список сообщений\n                this.getChatDialogContentContainer().html('');\n                this.getChatMessageCounterElement().html('0');\n\n                $('#discussion-live-chat header').trigger('click');\n            } else {\n                this.getDiscussionChatItem().eq(0).trigger('click');\n            }\n        }\n\n        /**\r\n         * Загрузка последних чатов с пользователями\r\n         */\n\n    }, {\n        key: 'loadChatDiscussionsIfWeHaveAlreadyChatsWithUsers',\n        value: function loadChatDiscussionsIfWeHaveAlreadyChatsWithUsers() {\n            var _this4 = this;\n\n            //if (window.localStorage && window.localStorage.getItem('discussions_list') != undefined) {\n            var open_dialog = setInterval(function () {\n                if (_this4.getChatDialog().length > 0) {\n                    //this.discussions_list = JSON.parse(window.localStorage.getItem('discussions_list'));\n                    if (amplify.store.localStorage('discussions_list') != undefined) {\n                        _this4.discussions_list = JSON.parse(amplify.store.localStorage('discussions_list'));\n                        $.each(_this4.discussions_list, function (index, item) {\n                            _this4.getChatDiscussionsUsersListContainer().prepend(_this4.formatChatUserItem(item, item.selected));\n\n                            if (item.selected) {\n                                _this4.discussion_id = item.discussion_id;\n\n                                //Загрузка списка сообщений для последней активной дискуссии\n                                _this4.loadDiscussionMessages($('[data-discussion-id=\"' + _this4.discussion_id + '\"]'));\n                            }\n                        });\n\n                        if (_this4.getDiscussionsCountInChat() == 0) {\n                            $('#discussion-live-chat').fadeOut(300);\n                        } else {\n                            _this4.openChatDialog(true);\n                        }\n\n                        clearInterval(open_dialog);\n                    }\n                }\n            }, 1000);\n            //}\n        }\n\n        /**\r\n         * Переключение чата пользователей\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onSwitchChat',\n        value: function onSwitchChat(event) {\n            var _this5 = this;\n\n            var element = $(event.target);\n\n            if (element.data('discussion-id') == undefined) {\n                element = element.parent();\n            }\n\n            this.discussion_id = element.data('discussion-id');\n\n            this.discussions_list[this.discussion_id].new_messages_counter = 0;\n            this.setDiscussionChatItemCounter(0);\n\n            //Обнуляем список выбора\n            $.each(this.discussions_list, function (index, item) {\n                _this5.discussions_list[index].selected = false;\n            });\n\n            this.discussions_list[this.discussion_id].selected = true;\n\n            this.getDiscussionChatItem().removeClass('active-chat-user-item');\n            element.addClass('active-chat-user-item');\n\n            this.getUserNameElement().html(this.discussions_list[this.discussion_id].chat_with_user);\n\n            //Делаем пересохранение списка открытых чатов с учетом последнего выбранного\n            this.saveDiscussionList();\n\n            //Загрузка списка сообщение для выбранной дискуссии\n            this.loadDiscussionMessages(element);\n        }\n\n        /**\r\n         * Загрузка списка сообщение для выбранной дискуссии\r\n         * @param element\r\n         */\n\n    }, {\n        key: 'loadDiscussionMessages',\n        value: function loadDiscussionMessages(element) {\n            $.post(element.closest('#discussion-live-chat').data('load-chat-url'), {\n                model_id: this.discussions_list[this.discussion_id].model_id,\n                messages_type: this.discussions_list[this.discussion_id].message_type\n            }, $.proxy(this.onLoadChatMessagesResult, this));\n        }\n\n        /**\r\n         * Добавление сообщений\r\n         * @param data\r\n         */\n\n    }, {\n        key: 'onLoadChatMessagesResult',\n        value: function onLoadChatMessagesResult(data) {\n            this.getChatDialogContentContainer().html('Нет сообщений.');\n            if (data.success) {\n                this.getChatDialogContentContainer().html(data.messages_list);\n\n                this.scrollDown('chat-history');\n            }\n        }\n\n        /**\r\n         * Получение сообщения и разбор его\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onMessage',\n        value: function onMessage(event) {\n            var data = JSON.parse(event.data),\n                allow_append = true;\n\n            console.log(data);\n            if (data.action == 'newMessage') {\n                if (data.data.users_who_get_messages != undefined && data.data.users_who_get_messages.length > 0) {\n                    var _iteratorNormalCompletion = true;\n                    var _didIteratorError = false;\n                    var _iteratorError = undefined;\n\n                    try {\n                        for (var _iterator = data.data.users_who_get_messages[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                            var item = _step.value;\n\n                            if ($('[data-auth-user-id=' + item + ']').length > 0) {\n                                this.getUserNameElement().html(data.data.users_names);\n\n                                //Номера дискуссии и заявки\n                                this.discussion_id = data.data.discussion_id;\n\n                                //Создаем список активных дискуссий с кем переписывается пользователь\n                                if (this.discussions_list[this.discussion_id] == undefined) {\n                                    this.discussions_list[this.discussion_id] = {\n                                        model_id: data.data.model_id,\n                                        dealer_id: data.data.dealer_id,\n                                        discussion_id: data.data.discussion_id,\n                                        message_type: data.data.message_type,\n                                        new_messages_counter: parseInt(data.data.messages_count),\n                                        chat_with_user: data.data.users_names,\n                                        model_url: data.data.model_url,\n                                        time: Date.now(),\n                                        selected: false\n                                    };\n                                } else {\n                                    this.discussions_list[this.discussion_id].new_messages_counter += parseInt(data.data.messages_count);\n                                    this.discussions_list[this.discussion_id].time = Date.now();\n\n                                    this.setDiscussionChatItemCounter(this.discussions_list[this.discussion_id].new_messages_counter);\n\n                                    //Если отправляется сообщение в активный чат, обновляем список сообщений\n                                    var active_chat = this.getActiveUserChat();\n                                    if (active_chat.length > 0 && active_chat.data('discussion-id') == this.discussion_id) {\n                                        this.getChatDialogContentContainer().html(data.data.messages_list);\n                                    }\n\n                                    allow_append = false;\n                                }\n\n                                //По умолчанию добавляем только первое сообщение от пользователя, в дальнейшем пользователь сам переключает чаты\n\n                                if (this.getDiscussionsCountInChat() == 1) {\n                                    if (data.data.messages_list.length > 0) {\n                                        this.getChatDialogContentContainer().html(data.data.messages_list);\n                                    }\n\n                                    //Отметка о последней выбранной дискуссии\n                                    this.discussions_list[this.discussion_id].selected = true;\n                                }\n\n                                var discussion_item = this.discussions_list[this.discussion_id];\n                                if (allow_append) {\n                                    this.getChatDiscussionsUsersListContainer().prepend(this.formatChatUserItem(discussion_item, this.discussion_id == discussion_item.discussion_id && this.getDiscussionsCountInChat() == 1, data.data.messages_list.length == 0));\n\n                                    //Плавный вывод последнего добавленного сообщения\n                                    this.getDiscussionChatItem().eq(0).fadeIn();\n                                }\n\n                                //Принудительная загрузка списка сообщений\n                                if (this.discussions_list[this.discussion_id].selected) {\n                                    $('[data-discussion-id=\"' + data.data.discussion_id + '\"]').trigger('click');\n                                }\n\n                                //this.discussions_list[discussion_item.discussion_id].new_messages_counter = 0;\n\n                                //Учитываем общее количество новых сообщений\n                                this.new_messages_counter += parseInt(data.data.messages_count);\n                                this.getChatMessageCounterElement().html(this.new_messages_counter);\n\n                                if (!this.isChatOpen()) {\n                                    this.openChatDialog();\n                                }\n\n                                this.saveDiscussionList();\n                                //this.messages.showInfo(data.data.message, 5000);\n                            }\n                        }\n                    } catch (err) {\n                        _didIteratorError = true;\n                        _iteratorError = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion && _iterator.return) {\n                                _iterator.return();\n                            }\n                        } finally {\n                            if (_didIteratorError) {\n                                throw _iteratorError;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        /**\r\n         * Установить количество новых сообщений\r\n         */\n\n    }, {\n        key: 'setDiscussionChatItemCounter',\n        value: function setDiscussionChatItemCounter(counter) {\n            addShakeAnim('[data-discussion-id=\"' + this.discussion_id + '\"]', null);\n\n            $('.chat-message-user-counter-' + this.discussion_id).html(counter);\n        }\n    }, {\n        key: 'openChatDialog',\n        value: function openChatDialog() {\n            var collapsed = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n            if (!this.in_chat) {\n                this.in_chat = true;\n\n                if (collapsed) {\n                    this.getChatDialogHeader().show();\n                    this.getChatMessageCounterElement().show();\n\n                    this.getDiscussionChat().hide();\n                    this.getChatDiscussionUsersList().hide();\n                }\n\n                this.getChatDialog().fadeIn();\n\n                if (this.discussion_model_messages_chat_uploader == undefined) {\n                    this.discussion_model_messages_chat_uploader = new JQueryUploader({\n                        file_uploader_el: '#discussion_message_files_chat',\n                        max_file_size: '5485760',\n                        uploader_url: '/upload_ajax.php',\n                        delete_temp_file_url: '/temp_file_ajax/delete',\n                        delete_uploaded_file_url: '/agreement/model/delete/uploaded/file',\n                        uploaded_files_container: '#discussion_files_chat',\n                        el_attach_files_model_field: '#discussion_message_files_chat',\n                        progress_bar: '#discussion-messages-files-progress-bar-chat',\n                        upload_files_ids_el: 'upload_files_discussion_ids',\n                        upload_file_object_type: 'discussion',\n                        upload_file_type: 'discussion',\n                        upload_field: 'discussion_message_files_chat',\n                        draw_only_labels: true,\n                        //el_attach_files_click_bt: '#discussion_message_files',\n                        disabled_files_extensions: ['js'],\n                        model_form: '#frm-discussion-model-messages-chat'\n                    }).start();\n                }\n            }\n        }\n    }, {\n        key: 'isChatOpen',\n        value: function isChatOpen() {\n            return this.in_chat;\n        }\n    }, {\n        key: 'getChatDialog',\n        value: function getChatDialog() {\n            return $('#discussion-live-chat');\n        }\n    }, {\n        key: 'getChatDialogHeader',\n        value: function getChatDialogHeader() {\n            return $('header', this.getChatDialog());\n        }\n    }, {\n        key: 'getChatDialogContentContainer',\n        value: function getChatDialogContentContainer() {\n            return $('.chat-history', this.getChatDialog());\n        }\n    }, {\n        key: 'getUserNameElement',\n        value: function getUserNameElement() {\n            return $('#discussion-chat-user-name');\n        }\n    }, {\n        key: 'getChatMessageCounterElement',\n        value: function getChatMessageCounterElement() {\n            return $('.chat-message-counter');\n        }\n    }, {\n        key: 'getChatDiscussionUsersList',\n        value: function getChatDiscussionUsersList() {\n            return $('.discussion-chat-users');\n        }\n    }, {\n        key: 'getDiscussionChat',\n        value: function getDiscussionChat() {\n            return $('.discussion-chat');\n        }\n    }, {\n        key: 'getChatDiscussionsUsersListContainer',\n        value: function getChatDiscussionsUsersListContainer() {\n            return $('.chat-message-content', this.getChatDiscussionUsersList());\n        }\n    }, {\n        key: 'getForm',\n        value: function getForm() {\n            return $('#frm-discussion-model-messages-chat');\n        }\n\n        /**\r\n         * Созраняем список открытых дискуссий на случай если пользователь перейдет по ссылке, чат должен автоматически открываться\r\n         */\n\n    }, {\n        key: 'saveDiscussionList',\n        value: function saveDiscussionList() {\n            var discussions_list = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n            amplify.store.localStorage('discussions_list', JSON.stringify(discussions_list != undefined ? discussions_list : this.discussions_list));\n            //if (window.localStorage) {\n            //window.localStorage.setItem();\n            //}\n        }\n\n        /**\r\n         * Форматирование вывода пользователя\r\n         * @returns {string}\r\n         * @param discussion_item\r\n         * @param active\r\n         */\n\n    }, {\n        key: 'formatChatUserItem',\n        value: function formatChatUserItem(discussion_item, active, forcibly_click) {\n            if (active) {\n                this.getUserNameElement().html(discussion_item.chat_with_user);\n            }\n\n            return '\\n            <div class=\"discussion-chat-user-item ' + (active ? 'active-chat-user-item' : '') + ' ' + (forcibly_click != undefined && forcibly_click ? 'allow-click' : '') + '\" \\n                data-discussion-id=\"' + discussion_item.discussion_id + '\" \\n                data-model-id=\"' + discussion_item.model_id + '\"\\n                data-dealer-id=\"' + discussion_item.dealer_id + '\"\\n            >\\n                ' + discussion_item.chat_with_user + '\\n                <span class=\"chat-message-user-counter chat-message-user-counter-' + discussion_item.discussion_id + '\">' + discussion_item.new_messages_counter + '</span>\\n                <span class=\"chat-message-user-model\"><a href=\"' + discussion_item.model_url + '\">\\u2116' + discussion_item.model_id + '</a></span>\\n                \x3c!--<a href=\"javascript:;\" data-discussion-id=\"' + discussion_item.discussion_id + '\" class=\"chat-user-close\">x</a>--\x3e\\n            </div>\\n        ';\n        }\n\n        /**\r\n         * Очистка данных по чатам с истекшим времени последнего общения\r\n         */\n\n    }, {\n        key: 'cleanChats',\n        value: function cleanChats() {\n            var _this6 = this;\n\n            setInterval(function () {\n                if (_this6.getDiscussionsCountInChat() > 0) {\n                    var current_time = Date.now(),\n                        discussions_list = {};\n\n                    $.each(_this6.discussions_list, function (index, item) {\n                        var diff_time = current_time - item.time;\n\n                        diff_time /= 1000; //убираем милисекунды\n                        diff_time = Math.round(diff_time / 60); //убираем секунды\n\n                        //Если время больше чем установлено удаляем запись из чата\n                        if (diff_time > _this6.clean_chat_items_in_minutes && !_this6.discussions_list[item.discussion_id].selected) {\n                            //$(`[data-discussion-id=\"${item.discussion_id}\"]`).remove();\n                            $('[data-discussion-id=\"' + item.discussion_id + '\"]').remove();\n\n                            //Если не осталось не одного чата удаляем все данные по чату\n                            if (_this6.getDiscussionsCountInChat() == 0) {\n                                _this6.getChatDialogContentContainer().html('');\n                                _this6.getUserNameElement().html('');\n                            }\n                        } else {\n                            discussions_list[item.discussion_id] = _this6.discussions_list[item.discussion_id];\n                        }\n                    });\n\n                    //Сохраняем данные в локальную память\n                    _this6.saveDiscussionList(discussions_list);\n                }\n            }, 5000);\n        }\n    }, {\n        key: 'getActiveUserChat',\n        value: function getActiveUserChat() {\n            return $('.active-chat-user-item');\n        }\n    }, {\n        key: 'getMessage',\n        value: function getMessage() {\n            return $.trim(this.getMessageField().val());\n        }\n    }, {\n        key: 'getMessageField',\n        value: function getMessageField() {\n            return $('#frm-message-chat');\n        }\n\n        /**\r\n         * Отправка нового сообщения пользователям\r\n         */\n\n    }, {\n        key: 'sendMessageToOthersUsers',\n        value: function sendMessageToOthersUsers(data) {\n            this.makeRequest('newMessage', data);\n        }\n\n        /**\r\n         * Чат с пользователем\r\n         * @returns {*|jQuery|HTMLElement}\r\n         */\n\n    }, {\n        key: 'getDiscussionChatItem',\n        value: function getDiscussionChatItem() {\n            return $('.discussion-chat-user-item');\n        }\n\n        /**\r\n         * Получаем количество активных дискуссий\r\n         * @returns {number}\r\n         */\n\n    }, {\n        key: 'getDiscussionsCountInChat',\n        value: function getDiscussionsCountInChat() {\n            var count = 0;\n\n            $.each(this.discussions_list, function (index, item) {\n                count++;\n            });\n\n            return count;\n        }\n    }]);\n\n    return ChatByWS;\n}(_websockets2.default);\n\nexports.default = ChatByWS;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvY2hhdF9ieV93cy5qcz9kYTFlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGtvc3RldCBvbiAwNC4wOS4yMDE3LlxyXG4gKi9cclxuXHJcbmltcG9ydCBEaXNjdXNzaW9uV2ViU29ja2V0cyBmcm9tIFwiLi93ZWJzb2NrZXRzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaGF0QnlXUyBleHRlbmRzIERpc2N1c3Npb25XZWJTb2NrZXRzIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmluX2NoYXQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmlzX29wZW4gPSB0cnVlO1xyXG4gICAgICAgIHRoaXMubmV3X21lc3NhZ2VzX2NvdW50ZXIgPSAwO1xyXG4gICAgICAgIHRoaXMuZGlzY3Vzc2lvbl9tb2RlbF9tZXNzYWdlc19jaGF0X3VwbG9hZGVyID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZV90eXBlID0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5kaXNjdXNzaW9uX2lkID0gMDtcclxuICAgICAgICB0aGlzLmRpc2N1c3Npb25zX2xpc3QgPSB7fTtcclxuICAgICAgICB0aGlzLm1vZGVsX2lkID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5jbGVhbl9jaGF0X2l0ZW1zX2luX21pbnV0ZXMgPSA1O1xyXG4gICAgfVxyXG5cclxuICAgIGluaXQoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmluaXRpYWxpemVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNkaXNjdXNzaW9uLWxpdmUtY2hhdCBoZWFkZXInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAkKCcuZGlzY3Vzc2lvbi1jaGF0LCAuZGlzY3Vzc2lvbi1jaGF0LXVzZXJzJykuc2xpZGVUb2dnbGUoMzAwLCAnc3dpbmcnKTtcclxuICAgICAgICAgICAgICAgICQoJy5jaGF0LW1lc3NhZ2UtY291bnRlcicpLmZhZGVUb2dnbGUoMzAwLCAnc3dpbmcnKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNfb3Blbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q2hhdE1lc3NhZ2VDb3VudGVyRWxlbWVudCgpLmh0bWwoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXdfbWVzc2FnZXNfY291bnRlciA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy/QodC/0YPRgdC60LDQtdC80YHRjyDQtNC+INC/0L7RgdC70LXQtNC90LXQs9C+INGB0L7QvtCx0YnQtdC90LjRj1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxEb3duKCdjaGF0LWhpc3RvcnknKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzX29wZW4gPSAhdGhpcy5pc19vcGVuO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY2hhdC1jbG9zZScsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAkKCcjZGlzY3Vzc2lvbi1saXZlLWNoYXQnKS5mYWRlT3V0KDMwMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5pbl9jaGF0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy/Qn9C10YDQtdC60LvRjtGH0LXQvdC40LUg0YfQsNGC0L7QslxyXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmRpc2N1c3Npb24tY2hhdC11c2VyLWl0ZW0nLCAkLnByb3h5KHRoaXMub25Td2l0Y2hDaGF0LCB0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICAvL9Cj0LTQsNC70LXQvdC40LUg0YfQsNGC0LAgKNC00LLQvtC50L3QvtC5INC60LvQuNC6KVxyXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbignZGJsY2xpY2snLCAnLmRpc2N1c3Npb24tY2hhdC11c2VyLWl0ZW0nLCAkLnByb3h5KHRoaXMub25EZXN0cm95Q2hhdCwgdGhpcykpO1xyXG5cclxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNmcm0tZGlzY3Vzc2lvbi1jaGF0LXNlbmQtYnV0dG9uJywgJC5wcm94eSh0aGlzLm9uU2VuZENoYXRNZXNzYWdlLCB0aGlzKSk7XHJcblxyXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbigna2V5dXAnLCAnI2ZybS1tZXNzYWdlLWNoYXQnLCAkLnByb3h5KHRoaXMub25NZXNzYWdlc0ZpZWxkRW50ZXJLZXlQcmVzcywgdGhpcykpO1xyXG5cclxuICAgICAgICAgICAgLy/QldGB0LvQuCDQtNC40YHQutGD0YHRgdC40Y8g0YPQttC1INCy0LXQu9Cw0YHRjCDQvtGC0L7QsdGA0LDQttCw0LXQvCDQtNC40LDQu9C+0LMg0LTQuNGB0LrRg9GB0YHQuCDQvNC10LbQtNGDINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj9C80LgsINCx0LXRgNC10Lwg0LTQsNC90L3Ri9C1INGBIGxvY2FsU3RvcmFnZVxyXG4gICAgICAgICAgICB0aGlzLmxvYWRDaGF0RGlzY3Vzc2lvbnNJZldlSGF2ZUFscmVhZHlDaGF0c1dpdGhVc2VycygpO1xyXG4gICAgICAgICAgICAvLyRkb2N1bWVudFxyXG5cclxuICAgICAgICAgICAgLy/QntGH0LjRgdGC0LrQsCDQtNCw0L3QvdGL0YUg0LIg0YfQsNGC0LUg0LXRgdC70Lgg0LLRgNC10LzRjyDQv9C+0YHQu9C10LTQvdC10Lkg0LHQtdGB0LXQtNGLINCx0L7Qu9GM0YjQtSA1INC80LjQvdGD0YJcclxuICAgICAgICAgICAgdGhpcy5jbGVhbkNoYXRzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgICBzdXBlci5vbk9wZW4oKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQntGC0L/RgNCw0LLQutCwINGB0L7QvtCx0YnQtdC90LjQtSDQv9C+IEVudGVyXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRcclxuICAgICAqL1xyXG4gICAgb25NZXNzYWdlc0ZpZWxkRW50ZXJLZXlQcmVzcyhldmVudCkge1xyXG4gICAgICAgIGlmIChldmVudC5rZXlDb2RlID09IDEzKSB7XHJcbiAgICAgICAgICAgIHRoaXMub25TZW5kQ2hhdE1lc3NhZ2UoZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvL9Ce0YLQv9GA0LDQstC40YLRjCDRgdC+0L7QsdGJ0LXQvdC40LVcclxuICAgIG9uU2VuZENoYXRNZXNzYWdlKGV2ZW50LCBjYWxsYmFjaykge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIGxldCBlbGVtZW50ID0gJChldmVudC50YXJnZXQpLCBzZW5kX3VybCA9IGVsZW1lbnQuY2xvc2VzdCgnZm9ybScpLmRhdGEoJ3NlbmQtdXJsJyksIHRvdGFsX3VwbG9hZGVkX2ZpbGVzID0gMCwgYWN0aXZlX2Rpc2N1c3Npb25faXRlbSA9IHRoaXMuZ2V0QWN0aXZlVXNlckNoYXQoKTtcclxuXHJcbiAgICAgICAgaWYgKGFjdGl2ZV9kaXNjdXNzaW9uX2l0ZW0ubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgc2hvd0FsZXJ0UG9wdXAoJ9Ce0YjQuNCx0LrQsC4nLCAn0JLRi9Cx0LXRgNC40YLQtSDRh9Cw0YIuJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBkaXNjdXNzaW9uX2l0ZW0gPSB0aGlzLmRpc2N1c3Npb25zX2xpc3RbYWN0aXZlX2Rpc2N1c3Npb25faXRlbS5kYXRhKCdkaXNjdXNzaW9uLWlkJyldO1xyXG5cclxuICAgICAgICB0aGlzLmRpc2N1c3Npb25faWQgPSBkaXNjdXNzaW9uX2l0ZW0uZGlzY3Vzc2lvbl9pZDtcclxuICAgICAgICB0aGlzLmRpc2N1c3Npb25zX2xpc3RbdGhpcy5kaXNjdXNzaW9uX2lkXS50aW1lID0gRGF0ZS5ub3coKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmdldEZpbGVzUGFyYW0odGhpcy5kaXNjdXNzaW9uX21vZGVsX21lc3NhZ2VzX2NoYXRfdXBsb2FkZXIpKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmdldEZpbGVzUGFyYW0odGhpcy5kaXNjdXNzaW9uX21vZGVsX21lc3NhZ2VzX2NoYXRfdXBsb2FkZXIpLmhhc093blByb3BlcnR5KGkpKSB7XHJcbiAgICAgICAgICAgICAgICB0b3RhbF91cGxvYWRlZF9maWxlcysrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5wb3N0aW5nIHx8ICgkLnRyaW0odGhpcy5nZXRNZXNzYWdlKCkpID09ICcnICYmIHRvdGFsX3VwbG9hZGVkX2ZpbGVzID09IDApKSB7XHJcbiAgICAgICAgICAgIHNob3dBbGVydFBvcHVwKCfQntGI0LjQsdC60LAuJywgJ9CS0LLQtdC00LjRgtC1INGB0L7QvtCx0YnQtdC90LjQtSDQuNC70Lgg0LfQsNCz0YDRg9C30LjRgtC1INGE0LDQudC7LicpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgZGF0YSA9ICQuZXh0ZW5kKHRoaXMuZ2V0RmlsZXNQYXJhbSgpLCB7XHJcbiAgICAgICAgICAgICAgICBpZDogZGlzY3Vzc2lvbl9pdGVtLmRpc2N1c3Npb25faWQsXHJcbiAgICAgICAgICAgICAgICBtb2RlbF9pZDogZGlzY3Vzc2lvbl9pdGVtLm1vZGVsX2lkLFxyXG4gICAgICAgICAgICAgICAgZGVhbGVyX2lkOiBkaXNjdXNzaW9uX2l0ZW0uZGVhbGVyX2lkLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5nZXRNZXNzYWdlKCksXHJcbiAgICAgICAgICAgICAgICByZXBseV9vbl9tZXNzYWdlX2lkOiAwLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZV90eXBlOiBkaXNjdXNzaW9uX2l0ZW0ubWVzc2FnZV90eXBlLFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgdGhpcy5wb3N0aW5nID0gdHJ1ZTtcclxuICAgICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgICQucG9zdChzZW5kX3VybCxcclxuICAgICAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgICAgICAocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9KS50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5nZXRNZXNzYWdlRmllbGQoKS52YWwoJycpO1xyXG4gICAgICAgICAgICB0aGlzLmRlbGV0ZVNlbnRGaWxlcyh0aGlzLmRpc2N1c3Npb25fbW9kZWxfbWVzc2FnZXNfY2hhdF91cGxvYWRlcik7XHJcblxyXG4gICAgICAgICAgICBpZiAocmVzdWx0LnJlc3BvbnNlICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRDaGF0RGlhbG9nQ29udGVudENvbnRhaW5lcigpLmh0bWwocmVzdWx0LnJlc3BvbnNlLm1lc3NhZ2VzX2xpc3QpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsRG93bignY2hhdC1oaXN0b3J5Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgZGF0YSA9ICQuZXh0ZW5kKHJlc3VsdC5yZXNwb25zZSwgZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZW5kTWVzc2FnZVRvT3RoZXJzVXNlcnMoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVEaXNjdXNzaW9uTGlzdCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhyZXN1bHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQo9C00LDQu9C10L3QuNC1INGH0LDRgtCwXHJcbiAgICAgKiBAcGFyYW0gZXZlbnRcclxuICAgICAqL1xyXG4gICAgb25EZXN0cm95Q2hhdChldmVudCkge1xyXG4gICAgICAgIGxldCBlbGVtZW50ID0gJChldmVudC50YXJnZXQpLCBkaXNjdXNzaW9uX2lkID0gZWxlbWVudC5kYXRhKCdkaXNjdXNzaW9uLWlkJyksIGRpc2N1c3Npb25zX2xpc3QgPSB7fTtcclxuXHJcbiAgICAgICAgZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICAkLmVhY2godGhpcy5kaXNjdXNzaW9uc19saXN0LCAoaW5kZXgsIGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uZGlzY3Vzc2lvbl9pZCAhPSBkaXNjdXNzaW9uX2lkKSB7XHJcbiAgICAgICAgICAgICAgICBkaXNjdXNzaW9uc19saXN0W2l0ZW0uZGlzY3Vzc2lvbl9pZF0gPSBpdGVtO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuZ2V0VXNlck5hbWVFbGVtZW50KCkuaHRtbCgnJyk7XHJcblxyXG4gICAgICAgIHRoaXMuZGlzY3Vzc2lvbnNfbGlzdCA9IGRpc2N1c3Npb25zX2xpc3Q7XHJcblxyXG4gICAgICAgIC8v0J7Rh9C40YnQsNC10Lwg0YHQv9C40YHQvtC6INGB0L7QvtCx0YnQtdC90LjQuVxyXG4gICAgICAgIHRoaXMuZ2V0Q2hhdERpYWxvZ0NvbnRlbnRDb250YWluZXIoKS5odG1sKCcnKTtcclxuXHJcbiAgICAgICAgLy/QodC+0LfRgNCw0L3Rj9C10Lwg0YHQv9C40YHQvtC6INC00LjRgdC60YPRgdGB0LjQuSDQsiDQu9C+0LrQsNC70YzQvdGD0Y4g0L/QsNC80Y/RgtGMXHJcbiAgICAgICAgdGhpcy5zYXZlRGlzY3Vzc2lvbkxpc3QoKTtcclxuXHJcbiAgICAgICAgLy/QldGB0LvQuCDQutC+0LvQuNGH0LXRgdGC0LLQviDQtNC40YHQutGD0YHRgdC40LkgMCwg0YHQutGA0YvQstCw0LXQvCDQtNC40LDQu9C+0LNcclxuICAgICAgICBpZiAodGhpcy5nZXREaXNjdXNzaW9uc0NvdW50SW5DaGF0KCkgPD0gMCkge1xyXG4gICAgICAgICAgICAvL9Cj0LHQsNGA0LDQtdC8INGB0L/QuNGB0L7QuiDRgdC+0L7QsdGJ0LXQvdC40LlcclxuICAgICAgICAgICAgdGhpcy5nZXRDaGF0RGlhbG9nQ29udGVudENvbnRhaW5lcigpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICB0aGlzLmdldENoYXRNZXNzYWdlQ291bnRlckVsZW1lbnQoKS5odG1sKCcwJyk7XHJcblxyXG4gICAgICAgICAgICAkKCcjZGlzY3Vzc2lvbi1saXZlLWNoYXQgaGVhZGVyJykudHJpZ2dlcignY2xpY2snKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmdldERpc2N1c3Npb25DaGF0SXRlbSgpLmVxKDApLnRyaWdnZXIoJ2NsaWNrJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0JfQsNCz0YDRg9C30LrQsCDQv9C+0YHQu9C10LTQvdC40YUg0YfQsNGC0L7QsiDRgSDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y/QvNC4XHJcbiAgICAgKi9cclxuICAgIGxvYWRDaGF0RGlzY3Vzc2lvbnNJZldlSGF2ZUFscmVhZHlDaGF0c1dpdGhVc2VycygpIHtcclxuICAgICAgICAvL2lmICh3aW5kb3cubG9jYWxTdG9yYWdlICYmIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGlzY3Vzc2lvbnNfbGlzdCcpICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBsZXQgb3Blbl9kaWFsb2cgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXRDaGF0RGlhbG9nKCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5kaXNjdXNzaW9uc19saXN0ID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Rpc2N1c3Npb25zX2xpc3QnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFtcGxpZnkuc3RvcmUubG9jYWxTdG9yYWdlKCdkaXNjdXNzaW9uc19saXN0JykgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzY3Vzc2lvbnNfbGlzdCA9IEpTT04ucGFyc2UoYW1wbGlmeS5zdG9yZS5sb2NhbFN0b3JhZ2UoJ2Rpc2N1c3Npb25zX2xpc3QnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaCh0aGlzLmRpc2N1c3Npb25zX2xpc3QsIChpbmRleCwgaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDaGF0RGlzY3Vzc2lvbnNVc2Vyc0xpc3RDb250YWluZXIoKS5wcmVwZW5kKHRoaXMuZm9ybWF0Q2hhdFVzZXJJdGVtKGl0ZW0sIGl0ZW0uc2VsZWN0ZWQpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbS5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzY3Vzc2lvbl9pZCA9IGl0ZW0uZGlzY3Vzc2lvbl9pZDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/Ql9Cw0LPRgNGD0LfQutCwINGB0L/QuNGB0LrQsCDRgdC+0L7QsdGJ0LXQvdC40Lkg0LTQu9GPINC/0L7RgdC70LXQtNC90LXQuSDQsNC60YLQuNCy0L3QvtC5INC00LjRgdC60YPRgdGB0LjQuFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZERpc2N1c3Npb25NZXNzYWdlcygkKGBbZGF0YS1kaXNjdXNzaW9uLWlkPVwiJHt0aGlzLmRpc2N1c3Npb25faWR9XCJdYCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldERpc2N1c3Npb25zQ291bnRJbkNoYXQoKSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcjZGlzY3Vzc2lvbi1saXZlLWNoYXQnKS5mYWRlT3V0KDMwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW5DaGF0RGlhbG9nKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKG9wZW5fZGlhbG9nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgIC8vfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0J/QtdGA0LXQutC70Y7Rh9C10L3QuNC1INGH0LDRgtCwINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQtdC5XHJcbiAgICAgKiBAcGFyYW0gZXZlbnRcclxuICAgICAqL1xyXG4gICAgb25Td2l0Y2hDaGF0KGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IGVsZW1lbnQgPSAkKGV2ZW50LnRhcmdldCk7XHJcblxyXG4gICAgICAgIGlmIChlbGVtZW50LmRhdGEoJ2Rpc2N1c3Npb24taWQnKSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmRpc2N1c3Npb25faWQgPSBlbGVtZW50LmRhdGEoJ2Rpc2N1c3Npb24taWQnKTtcclxuXHJcbiAgICAgICAgdGhpcy5kaXNjdXNzaW9uc19saXN0W3RoaXMuZGlzY3Vzc2lvbl9pZF0ubmV3X21lc3NhZ2VzX2NvdW50ZXIgPSAwO1xyXG4gICAgICAgIHRoaXMuc2V0RGlzY3Vzc2lvbkNoYXRJdGVtQ291bnRlcigwKTtcclxuXHJcbiAgICAgICAgLy/QntCx0L3Rg9C70Y/QtdC8INGB0L/QuNGB0L7QuiDQstGL0LHQvtGA0LBcclxuICAgICAgICAkLmVhY2godGhpcy5kaXNjdXNzaW9uc19saXN0LCAoaW5kZXgsIGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kaXNjdXNzaW9uc19saXN0W2luZGV4XS5zZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmRpc2N1c3Npb25zX2xpc3RbdGhpcy5kaXNjdXNzaW9uX2lkXS5zZWxlY3RlZCA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMuZ2V0RGlzY3Vzc2lvbkNoYXRJdGVtKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZS1jaGF0LXVzZXItaXRlbScpO1xyXG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2FjdGl2ZS1jaGF0LXVzZXItaXRlbScpO1xyXG5cclxuICAgICAgICB0aGlzLmdldFVzZXJOYW1lRWxlbWVudCgpLmh0bWwodGhpcy5kaXNjdXNzaW9uc19saXN0W3RoaXMuZGlzY3Vzc2lvbl9pZF0uY2hhdF93aXRoX3VzZXIpO1xyXG5cclxuICAgICAgICAvL9CU0LXQu9Cw0LXQvCDQv9C10YDQtdGB0L7RhdGA0LDQvdC10L3QuNC1INGB0L/QuNGB0LrQsCDQvtGC0LrRgNGL0YLRi9GFINGH0LDRgtC+0LIg0YEg0YPRh9C10YLQvtC8INC/0L7RgdC70LXQtNC90LXQs9C+INCy0YvQsdGA0LDQvdC90L7Qs9C+XHJcbiAgICAgICAgdGhpcy5zYXZlRGlzY3Vzc2lvbkxpc3QoKTtcclxuXHJcbiAgICAgICAgLy/Ql9Cw0LPRgNGD0LfQutCwINGB0L/QuNGB0LrQsCDRgdC+0L7QsdGJ0LXQvdC40LUg0LTQu9GPINCy0YvQsdGA0LDQvdC90L7QuSDQtNC40YHQutGD0YHRgdC40LhcclxuICAgICAgICB0aGlzLmxvYWREaXNjdXNzaW9uTWVzc2FnZXMoZWxlbWVudClcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCX0LDQs9GA0YPQt9C60LAg0YHQv9C40YHQutCwINGB0L7QvtCx0YnQtdC90LjQtSDQtNC70Y8g0LLRi9Cx0YDQsNC90L3QvtC5INC00LjRgdC60YPRgdGB0LjQuFxyXG4gICAgICogQHBhcmFtIGVsZW1lbnRcclxuICAgICAqL1xyXG4gICAgbG9hZERpc2N1c3Npb25NZXNzYWdlcyhlbGVtZW50KSB7XHJcbiAgICAgICAgJC5wb3N0KGVsZW1lbnQuY2xvc2VzdCgnI2Rpc2N1c3Npb24tbGl2ZS1jaGF0JykuZGF0YSgnbG9hZC1jaGF0LXVybCcpLCB7XHJcbiAgICAgICAgICAgIG1vZGVsX2lkOiB0aGlzLmRpc2N1c3Npb25zX2xpc3RbdGhpcy5kaXNjdXNzaW9uX2lkXS5tb2RlbF9pZCxcclxuICAgICAgICAgICAgbWVzc2FnZXNfdHlwZTogdGhpcy5kaXNjdXNzaW9uc19saXN0W3RoaXMuZGlzY3Vzc2lvbl9pZF0ubWVzc2FnZV90eXBlLFxyXG4gICAgICAgIH0sICQucHJveHkodGhpcy5vbkxvYWRDaGF0TWVzc2FnZXNSZXN1bHQsIHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCU0L7QsdCw0LLQu9C10L3QuNC1INGB0L7QvtCx0YnQtdC90LjQuVxyXG4gICAgICogQHBhcmFtIGRhdGFcclxuICAgICAqL1xyXG4gICAgb25Mb2FkQ2hhdE1lc3NhZ2VzUmVzdWx0KGRhdGEpIHtcclxuICAgICAgICB0aGlzLmdldENoYXREaWFsb2dDb250ZW50Q29udGFpbmVyKCkuaHRtbCgn0J3QtdGCINGB0L7QvtCx0YnQtdC90LjQuS4nKTtcclxuICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Q2hhdERpYWxvZ0NvbnRlbnRDb250YWluZXIoKS5odG1sKGRhdGEubWVzc2FnZXNfbGlzdCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbERvd24oJ2NoYXQtaGlzdG9yeScpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQn9C+0LvRg9GH0LXQvdC40LUg0YHQvtC+0LHRidC10L3QuNGPINC4INGA0LDQt9Cx0L7RgCDQtdCz0L5cclxuICAgICAqIEBwYXJhbSBldmVudFxyXG4gICAgICovXHJcbiAgICBvbk1lc3NhZ2UoZXZlbnQpIHtcclxuICAgICAgICBsZXQgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSksIGFsbG93X2FwcGVuZCA9IHRydWU7XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgIGlmIChkYXRhLmFjdGlvbiA9PSAnbmV3TWVzc2FnZScpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEuZGF0YS51c2Vyc193aG9fZ2V0X21lc3NhZ2VzICE9IHVuZGVmaW5lZCAmJiBkYXRhLmRhdGEudXNlcnNfd2hvX2dldF9tZXNzYWdlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIG9mIGRhdGEuZGF0YS51c2Vyc193aG9fZ2V0X21lc3NhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQoJ1tkYXRhLWF1dGgtdXNlci1pZD0nICsgaXRlbSArICddJykubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFVzZXJOYW1lRWxlbWVudCgpLmh0bWwoZGF0YS5kYXRhLnVzZXJzX25hbWVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v0J3QvtC80LXRgNCwINC00LjRgdC60YPRgdGB0LjQuCDQuCDQt9Cw0Y/QstC60LhcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNjdXNzaW9uX2lkID0gZGF0YS5kYXRhLmRpc2N1c3Npb25faWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL9Ch0L7Qt9C00LDQtdC8INGB0L/QuNGB0L7QuiDQsNC60YLQuNCy0L3Ri9GFINC00LjRgdC60YPRgdGB0LjQuSDRgSDQutC10Lwg0L/QtdGA0LXQv9C40YHRi9Cy0LDQtdGC0YHRjyDQv9C+0LvRjNC30L7QstCw0YLQtdC70YxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGlzY3Vzc2lvbnNfbGlzdFt0aGlzLmRpc2N1c3Npb25faWRdID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNjdXNzaW9uc19saXN0W3RoaXMuZGlzY3Vzc2lvbl9pZF0gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxfaWQ6IGRhdGEuZGF0YS5tb2RlbF9pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWFsZXJfaWQ6IGRhdGEuZGF0YS5kZWFsZXJfaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzY3Vzc2lvbl9pZDogZGF0YS5kYXRhLmRpc2N1c3Npb25faWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZV90eXBlOiBkYXRhLmRhdGEubWVzc2FnZV90eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld19tZXNzYWdlc19jb3VudGVyOiBwYXJzZUludChkYXRhLmRhdGEubWVzc2FnZXNfY291bnQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXRfd2l0aF91c2VyOiBkYXRhLmRhdGEudXNlcnNfbmFtZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxfdXJsOiBkYXRhLmRhdGEubW9kZWxfdXJsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6IERhdGUubm93KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc2N1c3Npb25zX2xpc3RbdGhpcy5kaXNjdXNzaW9uX2lkXS5uZXdfbWVzc2FnZXNfY291bnRlciArPSBwYXJzZUludChkYXRhLmRhdGEubWVzc2FnZXNfY291bnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNjdXNzaW9uc19saXN0W3RoaXMuZGlzY3Vzc2lvbl9pZF0udGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXREaXNjdXNzaW9uQ2hhdEl0ZW1Db3VudGVyKHRoaXMuZGlzY3Vzc2lvbnNfbGlzdFt0aGlzLmRpc2N1c3Npb25faWRdLm5ld19tZXNzYWdlc19jb3VudGVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL9CV0YHQu9C4INC+0YLQv9GA0LDQstC70Y/QtdGC0YHRjyDRgdC+0L7QsdGJ0LXQvdC40LUg0LIg0LDQutGC0LjQstC90YvQuSDRh9Cw0YIsINC+0LHQvdC+0LLQu9GP0LXQvCDRgdC/0LjRgdC+0Log0YHQvtC+0LHRidC10L3QuNC5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlX2NoYXQgPSB0aGlzLmdldEFjdGl2ZVVzZXJDaGF0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlX2NoYXQubGVuZ3RoID4gMCAmJiBhY3RpdmVfY2hhdC5kYXRhKCdkaXNjdXNzaW9uLWlkJykgPT0gdGhpcy5kaXNjdXNzaW9uX2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDaGF0RGlhbG9nQ29udGVudENvbnRhaW5lcigpLmh0bWwoZGF0YS5kYXRhLm1lc3NhZ2VzX2xpc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93X2FwcGVuZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL9Cf0L4g0YPQvNC+0LvRh9Cw0L3QuNGOINC00L7QsdCw0LLQu9GP0LXQvCDRgtC+0LvRjNC60L4g0L/QtdGA0LLQvtC1INGB0L7QvtCx0YnQtdC90LjQtSDQvtGCINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjywg0LIg0LTQsNC70YzQvdC10LnRiNC10Lwg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GMINGB0LDQvCDQv9C10YDQtdC60LvRjtGH0LDQtdGCINGH0LDRgtGLXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXREaXNjdXNzaW9uc0NvdW50SW5DaGF0KCkgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZGF0YS5tZXNzYWdlc19saXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldENoYXREaWFsb2dDb250ZW50Q29udGFpbmVyKCkuaHRtbChkYXRhLmRhdGEubWVzc2FnZXNfbGlzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/QntGC0LzQtdGC0LrQsCDQviDQv9C+0YHQu9C10LTQvdC10Lkg0LLRi9Cx0YDQsNC90L3QvtC5INC00LjRgdC60YPRgdGB0LjQuFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNjdXNzaW9uc19saXN0W3RoaXMuZGlzY3Vzc2lvbl9pZF0uc2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGlzY3Vzc2lvbl9pdGVtID0gdGhpcy5kaXNjdXNzaW9uc19saXN0W3RoaXMuZGlzY3Vzc2lvbl9pZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbGxvd19hcHBlbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q2hhdERpc2N1c3Npb25zVXNlcnNMaXN0Q29udGFpbmVyKCkucHJlcGVuZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1hdENoYXRVc2VySXRlbShkaXNjdXNzaW9uX2l0ZW0sIHRoaXMuZGlzY3Vzc2lvbl9pZCA9PSBkaXNjdXNzaW9uX2l0ZW0uZGlzY3Vzc2lvbl9pZCAmJiB0aGlzLmdldERpc2N1c3Npb25zQ291bnRJbkNoYXQoKSA9PSAxLCBkYXRhLmRhdGEubWVzc2FnZXNfbGlzdC5sZW5ndGggPT0gMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/Qn9C70LDQstC90YvQuSDQstGL0LLQvtC0INC/0L7RgdC70LXQtNC90LXQs9C+INC00L7QsdCw0LLQu9C10L3QvdC+0LPQviDRgdC+0L7QsdGJ0LXQvdC40Y9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0RGlzY3Vzc2lvbkNoYXRJdGVtKCkuZXEoMCkuZmFkZUluKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v0J/RgNC40L3Rg9C00LjRgtC10LvRjNC90LDRjyDQt9Cw0LPRgNGD0LfQutCwINGB0L/QuNGB0LrQsCDRgdC+0L7QsdGJ0LXQvdC40LlcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGlzY3Vzc2lvbnNfbGlzdFt0aGlzLmRpc2N1c3Npb25faWRdLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGBbZGF0YS1kaXNjdXNzaW9uLWlkPVwiJHtkYXRhLmRhdGEuZGlzY3Vzc2lvbl9pZH1cIl1gKS50cmlnZ2VyKCdjbGljaycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RoaXMuZGlzY3Vzc2lvbnNfbGlzdFtkaXNjdXNzaW9uX2l0ZW0uZGlzY3Vzc2lvbl9pZF0ubmV3X21lc3NhZ2VzX2NvdW50ZXIgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/Qo9GH0LjRgtGL0LLQsNC10Lwg0L7QsdGJ0LXQtSDQutC+0LvQuNGH0LXRgdGC0LLQviDQvdC+0LLRi9GFINGB0L7QvtCx0YnQtdC90LjQuVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5ld19tZXNzYWdlc19jb3VudGVyICs9IHBhcnNlSW50KGRhdGEuZGF0YS5tZXNzYWdlc19jb3VudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q2hhdE1lc3NhZ2VDb3VudGVyRWxlbWVudCgpLmh0bWwodGhpcy5uZXdfbWVzc2FnZXNfY291bnRlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNDaGF0T3BlbigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW5DaGF0RGlhbG9nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZURpc2N1c3Npb25MaXN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcy5tZXNzYWdlcy5zaG93SW5mbyhkYXRhLmRhdGEubWVzc2FnZSwgNTAwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0KPRgdGC0LDQvdC+0LLQuNGC0Ywg0LrQvtC70LjRh9C10YHRgtCy0L4g0L3QvtCy0YvRhSDRgdC+0L7QsdGJ0LXQvdC40LlcclxuICAgICAqL1xyXG4gICAgc2V0RGlzY3Vzc2lvbkNoYXRJdGVtQ291bnRlcihjb3VudGVyKSB7XHJcbiAgICAgICAgYWRkU2hha2VBbmltKGBbZGF0YS1kaXNjdXNzaW9uLWlkPVwiJHt0aGlzLmRpc2N1c3Npb25faWR9XCJdYCwgbnVsbCk7XHJcblxyXG4gICAgICAgICQoYC5jaGF0LW1lc3NhZ2UtdXNlci1jb3VudGVyLSR7dGhpcy5kaXNjdXNzaW9uX2lkfWApLmh0bWwoY291bnRlcik7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbkNoYXREaWFsb2coY29sbGFwc2VkID0gZmFsc2UpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaW5fY2hhdCkge1xyXG4gICAgICAgICAgICB0aGlzLmluX2NoYXQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRDaGF0RGlhbG9nSGVhZGVyKCkuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRDaGF0TWVzc2FnZUNvdW50ZXJFbGVtZW50KCkuc2hvdygpO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0RGlzY3Vzc2lvbkNoYXQoKS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldENoYXREaXNjdXNzaW9uVXNlcnNMaXN0KCkuaGlkZSgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmdldENoYXREaWFsb2coKS5mYWRlSW4oKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRpc2N1c3Npb25fbW9kZWxfbWVzc2FnZXNfY2hhdF91cGxvYWRlciA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzY3Vzc2lvbl9tb2RlbF9tZXNzYWdlc19jaGF0X3VwbG9hZGVyID0gbmV3IEpRdWVyeVVwbG9hZGVyKHtcclxuICAgICAgICAgICAgICAgICAgICBmaWxlX3VwbG9hZGVyX2VsOiAnI2Rpc2N1c3Npb25fbWVzc2FnZV9maWxlc19jaGF0JyxcclxuICAgICAgICAgICAgICAgICAgICBtYXhfZmlsZV9zaXplOiAnNTQ4NTc2MCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXBsb2FkZXJfdXJsOiAnL3VwbG9hZF9hamF4LnBocCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlX3RlbXBfZmlsZV91cmw6ICcvdGVtcF9maWxlX2FqYXgvZGVsZXRlJyxcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGVfdXBsb2FkZWRfZmlsZV91cmw6ICcvYWdyZWVtZW50L21vZGVsL2RlbGV0ZS91cGxvYWRlZC9maWxlJyxcclxuICAgICAgICAgICAgICAgICAgICB1cGxvYWRlZF9maWxlc19jb250YWluZXI6ICcjZGlzY3Vzc2lvbl9maWxlc19jaGF0JyxcclxuICAgICAgICAgICAgICAgICAgICBlbF9hdHRhY2hfZmlsZXNfbW9kZWxfZmllbGQ6ICcjZGlzY3Vzc2lvbl9tZXNzYWdlX2ZpbGVzX2NoYXQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHByb2dyZXNzX2JhcjogJyNkaXNjdXNzaW9uLW1lc3NhZ2VzLWZpbGVzLXByb2dyZXNzLWJhci1jaGF0JyxcclxuICAgICAgICAgICAgICAgICAgICB1cGxvYWRfZmlsZXNfaWRzX2VsOiAndXBsb2FkX2ZpbGVzX2Rpc2N1c3Npb25faWRzJyxcclxuICAgICAgICAgICAgICAgICAgICB1cGxvYWRfZmlsZV9vYmplY3RfdHlwZTogJ2Rpc2N1c3Npb24nLFxyXG4gICAgICAgICAgICAgICAgICAgIHVwbG9hZF9maWxlX3R5cGU6ICdkaXNjdXNzaW9uJyxcclxuICAgICAgICAgICAgICAgICAgICB1cGxvYWRfZmllbGQ6ICdkaXNjdXNzaW9uX21lc3NhZ2VfZmlsZXNfY2hhdCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZHJhd19vbmx5X2xhYmVsczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAvL2VsX2F0dGFjaF9maWxlc19jbGlja19idDogJyNkaXNjdXNzaW9uX21lc3NhZ2VfZmlsZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkX2ZpbGVzX2V4dGVuc2lvbnM6IFsnanMnXSxcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbF9mb3JtOiAnI2ZybS1kaXNjdXNzaW9uLW1vZGVsLW1lc3NhZ2VzLWNoYXQnXHJcbiAgICAgICAgICAgICAgICB9KS5zdGFydCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlzQ2hhdE9wZW4oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5fY2hhdDtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDaGF0RGlhbG9nKCkge1xyXG4gICAgICAgIHJldHVybiAkKCcjZGlzY3Vzc2lvbi1saXZlLWNoYXQnKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDaGF0RGlhbG9nSGVhZGVyKCkge1xyXG4gICAgICAgIHJldHVybiAkKCdoZWFkZXInLCB0aGlzLmdldENoYXREaWFsb2coKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q2hhdERpYWxvZ0NvbnRlbnRDb250YWluZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJy5jaGF0LWhpc3RvcnknLCB0aGlzLmdldENoYXREaWFsb2coKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlck5hbWVFbGVtZW50KCkge1xyXG4gICAgICAgIHJldHVybiAkKCcjZGlzY3Vzc2lvbi1jaGF0LXVzZXItbmFtZScpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldENoYXRNZXNzYWdlQ291bnRlckVsZW1lbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJy5jaGF0LW1lc3NhZ2UtY291bnRlcicpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldENoYXREaXNjdXNzaW9uVXNlcnNMaXN0KCkge1xyXG4gICAgICAgIHJldHVybiAkKCcuZGlzY3Vzc2lvbi1jaGF0LXVzZXJzJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzY3Vzc2lvbkNoYXQoKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJy5kaXNjdXNzaW9uLWNoYXQnKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDaGF0RGlzY3Vzc2lvbnNVc2Vyc0xpc3RDb250YWluZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJy5jaGF0LW1lc3NhZ2UtY29udGVudCcsIHRoaXMuZ2V0Q2hhdERpc2N1c3Npb25Vc2Vyc0xpc3QoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Rm9ybSgpIHtcclxuICAgICAgICByZXR1cm4gJCgnI2ZybS1kaXNjdXNzaW9uLW1vZGVsLW1lc3NhZ2VzLWNoYXQnKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQodC+0LfRgNCw0L3Rj9C10Lwg0YHQv9C40YHQvtC6INC+0YLQutGA0YvRgtGL0YUg0LTQuNGB0LrRg9GB0YHQuNC5INC90LAg0YHQu9GD0YfQsNC5INC10YHQu9C4INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjCDQv9C10YDQtdC50LTQtdGCINC/0L4g0YHRgdGL0LvQutC1LCDRh9Cw0YIg0LTQvtC70LbQtdC9INCw0LLRgtC+0LzQsNGC0LjRh9C10YHQutC4INC+0YLQutGA0YvQstCw0YLRjNGB0Y9cclxuICAgICAqL1xyXG4gICAgc2F2ZURpc2N1c3Npb25MaXN0KGRpc2N1c3Npb25zX2xpc3QgPSB1bmRlZmluZWQpIHtcclxuICAgICAgICBhbXBsaWZ5LnN0b3JlLmxvY2FsU3RvcmFnZSgnZGlzY3Vzc2lvbnNfbGlzdCcsIEpTT04uc3RyaW5naWZ5KGRpc2N1c3Npb25zX2xpc3QgIT0gdW5kZWZpbmVkID8gZGlzY3Vzc2lvbnNfbGlzdCA6IHRoaXMuZGlzY3Vzc2lvbnNfbGlzdCkpO1xyXG4gICAgICAgIC8vaWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UpIHtcclxuICAgICAgICAgICAgLy93aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oKTtcclxuICAgICAgICAvL31cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCk0L7RgNC80LDRgtC40YDQvtCy0LDQvdC40LUg0LLRi9Cy0L7QtNCwINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRj1xyXG4gICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAqIEBwYXJhbSBkaXNjdXNzaW9uX2l0ZW1cclxuICAgICAqIEBwYXJhbSBhY3RpdmVcclxuICAgICAqL1xyXG4gICAgZm9ybWF0Q2hhdFVzZXJJdGVtKGRpc2N1c3Npb25faXRlbSwgYWN0aXZlLCBmb3JjaWJseV9jbGljaykge1xyXG4gICAgICAgIGlmIChhY3RpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRVc2VyTmFtZUVsZW1lbnQoKS5odG1sKGRpc2N1c3Npb25faXRlbS5jaGF0X3dpdGhfdXNlcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gYFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZGlzY3Vzc2lvbi1jaGF0LXVzZXItaXRlbSAke2FjdGl2ZSA/ICdhY3RpdmUtY2hhdC11c2VyLWl0ZW0nIDogJyd9ICR7Zm9yY2libHlfY2xpY2sgIT0gdW5kZWZpbmVkICYmIGZvcmNpYmx5X2NsaWNrID8gJ2FsbG93LWNsaWNrJyA6ICcnfVwiIFxyXG4gICAgICAgICAgICAgICAgZGF0YS1kaXNjdXNzaW9uLWlkPVwiJHtkaXNjdXNzaW9uX2l0ZW0uZGlzY3Vzc2lvbl9pZH1cIiBcclxuICAgICAgICAgICAgICAgIGRhdGEtbW9kZWwtaWQ9XCIke2Rpc2N1c3Npb25faXRlbS5tb2RlbF9pZH1cIlxyXG4gICAgICAgICAgICAgICAgZGF0YS1kZWFsZXItaWQ9XCIke2Rpc2N1c3Npb25faXRlbS5kZWFsZXJfaWR9XCJcclxuICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgJHtkaXNjdXNzaW9uX2l0ZW0uY2hhdF93aXRoX3VzZXJ9XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImNoYXQtbWVzc2FnZS11c2VyLWNvdW50ZXIgY2hhdC1tZXNzYWdlLXVzZXItY291bnRlci0ke2Rpc2N1c3Npb25faXRlbS5kaXNjdXNzaW9uX2lkfVwiPiR7ZGlzY3Vzc2lvbl9pdGVtLm5ld19tZXNzYWdlc19jb3VudGVyfTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY2hhdC1tZXNzYWdlLXVzZXItbW9kZWxcIj48YSBocmVmPVwiJHtkaXNjdXNzaW9uX2l0ZW0ubW9kZWxfdXJsfVwiPuKEliR7ZGlzY3Vzc2lvbl9pdGVtLm1vZGVsX2lkfTwvYT48L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8IS0tPGEgaHJlZj1cImphdmFzY3JpcHQ6O1wiIGRhdGEtZGlzY3Vzc2lvbi1pZD1cIiR7ZGlzY3Vzc2lvbl9pdGVtLmRpc2N1c3Npb25faWR9XCIgY2xhc3M9XCJjaGF0LXVzZXItY2xvc2VcIj54PC9hPi0tPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICBgO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0J7Rh9C40YHRgtC60LAg0LTQsNC90L3Ri9GFINC/0L4g0YfQsNGC0LDQvCDRgSDQuNGB0YLQtdC60YjQuNC8INCy0YDQtdC80LXQvdC4INC/0L7RgdC70LXQtNC90LXQs9C+INC+0LHRidC10L3QuNGPXHJcbiAgICAgKi9cclxuICAgIGNsZWFuQ2hhdHMoKSB7XHJcbiAgICAgICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5nZXREaXNjdXNzaW9uc0NvdW50SW5DaGF0KCkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudF90aW1lID0gRGF0ZS5ub3coKSwgZGlzY3Vzc2lvbnNfbGlzdCA9ICB7fTtcclxuXHJcbiAgICAgICAgICAgICAgICAkLmVhY2godGhpcy5kaXNjdXNzaW9uc19saXN0LCAoaW5kZXgsIGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZGlmZl90aW1lID0gY3VycmVudF90aW1lIC0gaXRlbS50aW1lO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkaWZmX3RpbWUgLz0gMTAwMDsgLy/Rg9Cx0LjRgNCw0LXQvCDQvNC40LvQuNGB0LXQutGD0L3QtNGLXHJcbiAgICAgICAgICAgICAgICAgICAgZGlmZl90aW1lID0gTWF0aC5yb3VuZChkaWZmX3RpbWUgLyA2MCk7IC8v0YPQsdC40YDQsNC10Lwg0YHQtdC60YPQvdC00YtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy/QldGB0LvQuCDQstGA0LXQvNGPINCx0L7Qu9GM0YjQtSDRh9C10Lwg0YPRgdGC0LDQvdC+0LLQu9C10L3QviDRg9C00LDQu9GP0LXQvCDQt9Cw0L/QuNGB0Ywg0LjQtyDRh9Cw0YLQsFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkaWZmX3RpbWUgPiB0aGlzLmNsZWFuX2NoYXRfaXRlbXNfaW5fbWludXRlcyAmJiAhdGhpcy5kaXNjdXNzaW9uc19saXN0W2l0ZW0uZGlzY3Vzc2lvbl9pZF0uc2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8kKGBbZGF0YS1kaXNjdXNzaW9uLWlkPVwiJHtpdGVtLmRpc2N1c3Npb25faWR9XCJdYCkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoYFtkYXRhLWRpc2N1c3Npb24taWQ9XCIke2l0ZW0uZGlzY3Vzc2lvbl9pZH1cIl1gKS5yZW1vdmUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v0JXRgdC70Lgg0L3QtSDQvtGB0YLQsNC70L7RgdGMINC90LUg0L7QtNC90L7Qs9C+INGH0LDRgtCwINGD0LTQsNC70Y/QtdC8INCy0YHQtSDQtNCw0L3QvdGL0LUg0L/QviDRh9Cw0YLRg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXREaXNjdXNzaW9uc0NvdW50SW5DaGF0KCkgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDaGF0RGlhbG9nQ29udGVudENvbnRhaW5lcigpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRVc2VyTmFtZUVsZW1lbnQoKS5odG1sKCcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc2N1c3Npb25zX2xpc3RbaXRlbS5kaXNjdXNzaW9uX2lkXSA9IHRoaXMuZGlzY3Vzc2lvbnNfbGlzdFtpdGVtLmRpc2N1c3Npb25faWRdO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8v0KHQvtGF0YDQsNC90Y/QtdC8INC00LDQvdC90YvQtSDQsiDQu9C+0LrQsNC70YzQvdGD0Y4g0L/QsNC80Y/RgtGMXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVEaXNjdXNzaW9uTGlzdChkaXNjdXNzaW9uc19saXN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIDUwMDApO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEFjdGl2ZVVzZXJDaGF0KCkge1xyXG4gICAgICAgIHJldHVybiAkKCcuYWN0aXZlLWNoYXQtdXNlci1pdGVtJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TWVzc2FnZSgpIHtcclxuICAgICAgICByZXR1cm4gJC50cmltKHRoaXMuZ2V0TWVzc2FnZUZpZWxkKCkudmFsKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE1lc3NhZ2VGaWVsZCgpIHtcclxuICAgICAgICByZXR1cm4gJCgnI2ZybS1tZXNzYWdlLWNoYXQnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCe0YLQv9GA0LDQstC60LAg0L3QvtCy0L7Qs9C+INGB0L7QvtCx0YnQtdC90LjRjyDQv9C+0LvRjNC30L7QstCw0YLQtdC70Y/QvFxyXG4gICAgICovXHJcbiAgICBzZW5kTWVzc2FnZVRvT3RoZXJzVXNlcnMoZGF0YSkge1xyXG4gICAgICAgIHRoaXMubWFrZVJlcXVlc3QoJ25ld01lc3NhZ2UnLCBkYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCn0LDRgiDRgSDQv9C+0LvRjNC30L7QstCw0YLQtdC70LXQvFxyXG4gICAgICogQHJldHVybnMgeyp8alF1ZXJ5fEhUTUxFbGVtZW50fVxyXG4gICAgICovXHJcbiAgICBnZXREaXNjdXNzaW9uQ2hhdEl0ZW0oKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJy5kaXNjdXNzaW9uLWNoYXQtdXNlci1pdGVtJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQn9C+0LvRg9GH0LDQtdC8INC60L7Qu9C40YfQtdGB0YLQstC+INCw0LrRgtC40LLQvdGL0YUg0LTQuNGB0LrRg9GB0YHQuNC5XHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG4gICAgICovXHJcbiAgICBnZXREaXNjdXNzaW9uc0NvdW50SW5DaGF0KCkge1xyXG4gICAgICAgIGxldCBjb3VudCA9IDA7XHJcblxyXG4gICAgICAgICQuZWFjaCh0aGlzLmRpc2N1c3Npb25zX2xpc3QsIChpbmRleCwgaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gY291bnQ7XHJcbiAgICB9XHJcbn1cclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHd3dy9qcy9jaGF0cy9kZXYvY2xhc3Nlcy9jaGF0X2J5X3dzLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBSUE7QUFDQTs7Ozs7Ozs7O0FBTEE7Ozs7QUFNQTs7O0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWRBO0FBZUE7QUFDQTs7O0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUlBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7Ozs7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQTRFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWhCQTtBQWtCQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7OztBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFZQTtBQUNBO0FBQ0E7Ozs7OztBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQWhqQkEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///4\n")},/*!*****************************************************!*\
  !*** ./www/js/chats/dev/classes/base_discussion.js ***!
  \*****************************************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * Created by kostet on 03.08.2017.\r\n */\n\nvar BaseDiscussion = function () {\n    function BaseDiscussion(params) {\n        _classCallCheck(this, BaseDiscussion);\n\n        this.params = params;\n        this.sending_files = [];\n\n        this.last_item = null;\n        this.last_discussion_item = null;\n        this.filter = {};\n        this.last_panel = undefined;\n        this.posting = false;\n        this.msg_field = '';\n        this.default_object_id = 0;\n\n        this.message_field = null;\n        this.message_ask_field = null;\n\n        this.dealer_id = 0;\n\n        this.reply_on_message_id = 0;\n\n        this.sidebar_panel_hide_interval = null;\n        this.scroll_container = 'container-discussion-messages';\n    }\n\n    _createClass(BaseDiscussion, [{\n        key: 'start',\n        value: function start() {\n            //Фильтр списка сообщение\n            $(document).on('click', this.params.filter_visibility_messages, $.proxy(this.onFilterDiscussionsList, this));\n\n            //Загрузка списка сообщение выбранной дискуссии\n            $(document).on('click', this.params.on_show_discussion_messages, $.proxy(this.onLoadDiscussionMessagesByDiscussion, this));\n\n            //Отображение / скрытие панелий при наведении курсора\n            $(document).on('mouseover', this.params.container_discussion_panel, $.proxy(this.onMouseMoveInDiscussionContainer, this));\n\n            //Отправка обычного сообщения\n            $(document).on('click', this.params.frm_discussion_send_button, $.proxy(this.onSendMessage, this));\n\n            //Отправка сообщение с вопросом\n            $(document).on('click', this.params.frm_discussion_send_ask_button, $.proxy(this.onSendAskMessage, this));\n\n            //Работа с правой панелью сообщений\n            $(document).on('mousemove', '#sidebar-wrapper', $.proxy(this.onShowSidebarPanel, this));\n            $(document).on('mouseout', '#sidebar-wrapper', $.proxy(this.onHideSidebarPanel, this));\n\n            //Открытие панели сообщений по клику\n            $(document).on('click', '#js-chat-messages-counter', $.proxy(this.onShowSidebarPanel, this));\n\n            //Цитирование сообщения\n            $(document).on('click', '.js-reply-on-comment', $.proxy(this.onReplyMessage, this));\n\n            //Отобразить данные по дискуссии\n            $(document).on('click', '.discussion-chat-item-in-sidebar', $.proxy(this.onShowDiscussionDataByChatItem, this));\n\n            this.initEditors();\n        }\n\n        /**\r\n         * Отобразить информацию о дискусси по\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onShowDiscussionDataByChatItem',\n        value: function onShowDiscussionDataByChatItem(event) {\n            var element = $(event.target);\n\n            if (element.data('discussion-id') == undefined) {\n                element = element.parent();\n            }\n\n            //Принудильный клик для загрузки последних сообщений\n            if ($('.discussion__dealer__item__' + element.data('dealer-id')).length != 0) {\n                $('.discussion__dealer__item__' + element.data('dealer-id')).trigger('click');\n\n                //Скроллим до небходимого итема\n                scrollTop('.discussion__dealer__item__' + element.data('dealer-id'), 'dealers-discussions-container');\n\n                //Проверка на тип сообщений\n                //Если сообщение пришло с раздела Задачать вопрос делаем проверку на активную панель и дальшеесли она неактивна\n                if (element.data('message-type') == 'ask') {\n                    var discussion_type = $('.discussions-messages-types');\n\n                    $.each(discussion_type, function (index, item) {\n                        var element = $(item);\n\n                        if (!element.hasClass('current') && element.data('type') == 'ask') {\n                            element.trigger('click');\n                        }\n                    });\n                } else {\n                    //Тайм аут для загрузки списка сообщений\n                    var attemts_count = 0; //Количество попыток\n                    var item_interval = setInterval(function () {\n                        if ($('.discussion__list__item__' + element.data('discussion-id')).length > 0 || attemts_count < 5) {\n                            $('.discussion__list__item__' + element.data('discussion-id')).trigger('click');\n\n                            clearInterval(item_interval);\n                        }\n\n                        attemts_count++;\n                    }, 1000);\n                }\n            } else {\n                $('.discussion__list__item__' + element.data('discussion-id')).trigger('click');\n            }\n        }\n    }, {\n        key: 'onShowSidebarPanel',\n        value: function onShowSidebarPanel(event) {\n            var element = $(event.target);\n\n            if (element.data('open') == undefined) {\n                element = element.parent();\n            }\n\n            if (element.data('open') != undefined) {\n                $(\"#discussion-wrapper\").toggleClass('toggled');\n\n                element.css('right', '-230px');\n\n                //Обнуляем количетво сообщений от пользователей\n                this.getDiscussionChatBySidebarCounter().text(0);\n            }\n\n            clearInterval(this.sidebar_panel_hide_interval);\n        }\n    }, {\n        key: 'onHideSidebarPanel',\n        value: function onHideSidebarPanel() {\n            var _this = this;\n\n            this.sidebar_panel_hide_interval = setInterval(function () {\n                $(\"#discussion-wrapper\").toggleClass('toggled');\n\n                $('#js-chat-messages-counter').css('right', '0px');\n\n                clearInterval(_this.sidebar_panel_hide_interval);\n            }, 500);\n        }\n\n        /**\r\n         * Инициалицзация текстовых полей для сообщений\r\n         */\n\n    }, {\n        key: 'initEditors',\n        value: function initEditors() {\n            if (this.getFrmDiscussionMessageElement()) {\n                this.getFrmDiscussionMessageElement().html('');\n\n                if (this.message_field == null) {\n                    this.message_field = new Medium({\n                        element: document.getElementById(this.params.frm_discussion_message_element),\n                        mode: Medium.richMode,\n                        placeholder: 'Введите комментарий',\n                        attributes: null,\n                        autofocus: true,\n                        autoHR: false,\n                        tags: null\n                    });\n                }\n            }\n\n            if (this.getFrmDiscussionAskMessageElement()) {\n                this.getFrmDiscussionAskMessageElement().html('');\n\n                if (this.message_ask_field == null) {\n                    this.message_ask_field = new Medium({\n                        element: document.getElementById(this.params.frm_discussion_ask_message_element),\n                        mode: Medium.richMode,\n                        placeholder: 'Введите комментарий',\n                        attributes: null,\n                        tags: null\n                    });\n                }\n            }\n        }\n\n        /**\r\n         * Цитировать сообщение\r\n         */\n\n    }, {\n        key: 'onReplyMessage',\n        value: function onReplyMessage(event) {\n            var $element = $(event.target),\n                message_type = $element.data('message-type'),\n                message_id = $element.data('message-id'),\n                element_msg = $element.data('msg'),\n                text_element = $('[data-message-field=' + message_type + ']');\n\n            $element.hide();\n            if (text_element != undefined) {\n                var element_id = message_type == 'message' ? this.params.frm_discussion_message_element : this.params.frm_discussion_ask_message_element,\n                    text_area = $('#' + element_id);\n\n                text_area.focus();\n\n                text_area.html('');\n                text_area.append('<blockquote>' + element_msg + '</blockquote><br/>');\n\n                this.reply_on_message_id = message_id;\n\n                this.placeCaretAtEnd(document.getElementById(element_id));\n            }\n        }\n    }, {\n        key: 'onSendMessage',\n        value: function onSendMessage(event) {\n            var _this2 = this;\n\n            event.preventDefault();\n\n            this.msg_field = this.params.frm_discussion_message_element;\n            this.sendMessage(this.params.on_post_new_message_url, this.params.discussion_model_messages, 'message', function (result) {\n                if (result.success) {\n                    _this2.loadDiscussionMessages();\n                }\n            });\n        }\n    }, {\n        key: 'onSendAskMessage',\n        value: function onSendAskMessage(event) {\n            var _this3 = this;\n\n            event.preventDefault();\n\n            this.msg_field = this.params.frm_discussion_ask_message_element;\n            this.sendMessage(this.params.on_post_new_message_url, this.params.discussion_ask, 'ask', function (result) {\n                if (result.success) {\n                    _this3.loadAskMessages();\n                }\n            });\n        }\n    }, {\n        key: 'sendMessage',\n        value: function sendMessage(url, uploader, message_type, callback) {\n            var _this4 = this;\n\n            var total_uploaded_files = 0;\n\n            this.setDefaultDiscussionItem();\n            for (var i in this.getFilesParam(uploader)) {\n                if (this.getFilesParam(uploader).hasOwnProperty(i)) {\n                    total_uploaded_files++;\n                }\n            }\n\n            if (this.posting || $.trim(this.getMessage()) == '' && total_uploaded_files == 0) {\n                showAlertPopup('Ошибка.', 'Введите сообщение или загрузите файл.');\n                return;\n            }\n\n            this.message_type = message_type;\n            var data = $.extend(this.getFilesParam(), {\n                id: this.last_discussion_item.data('discussion-id'),\n                model_id: this.last_discussion_item.data('model-id'),\n                dealer_id: this.getDealerId(),\n                message: this.getMessage(),\n                reply_on_message_id: this.reply_on_message_id,\n                message_type: message_type\n            });\n\n            data = $.extend(this.getMessageDirection(message_type), data);\n            console.log(data);\n\n            this.posting = true;\n            new Promise(function (resolve, reject) {\n                $.post(url, data, function (result) {\n                    resolve(result);\n                    _this4.posting = false;\n                });\n            }).then(function (result) {\n                _this4.getMessageField().html('');\n                _this4.deleteSentFiles(uploader);\n\n                if (result.response != undefined) {\n                    data = $.extend(result.response, data);\n\n                    _this4.makeRequestData(data);\n                }\n\n                if (callback != undefined) {\n                    callback(result);\n                }\n            });\n        }\n    }, {\n        key: 'loadAskMessages',\n        value: function loadAskMessages() {\n            var _this5 = this;\n\n            new Promise(function (resolve, reject) {\n                $.post(_this5.params.on_load_ask_messages_url, {\n                    id: _this5.last_discussion_item.data('discussion-id'),\n                    model_id: _this5.last_discussion_item.data('model-id'),\n                    dealer_id: _this5.getDealerId(),\n                    reply_on_message_id: _this5.reply_on_message_id,\n                    message_type: _this5.message_type\n                }, function (result) {\n                    if (result.success) {\n                        resolve(result);\n                    } else {\n                        reject(result);\n                    }\n                });\n            }).then(function (result) {\n                _this5.getDiscussionAskMessagesContainer().html(result.messages_list);\n            }).catch(function (result) {});\n        }\n    }, {\n        key: 'getMessage',\n        value: function getMessage() {\n            return this.getMessageField().html();\n        }\n    }, {\n        key: 'getMessageField',\n        value: function getMessageField() {\n            return $('#' + this.msg_field);\n        }\n\n        /**\r\n         * Загрузка списка сообщений по выбранной дискуссии (заявки)\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onLoadDiscussionMessagesByDiscussion',\n        value: function onLoadDiscussionMessagesByDiscussion(event) {\n            var discussion_item = $(event.target);\n\n            if (discussion_item.data('model-id') == undefined) {\n                discussion_item = discussion_item.parent();\n            }\n\n            this.params.model_id = discussion_item.data('model-id');\n            this.last_discussion_item = discussion_item;\n\n            this.resetDiscussionItems();\n            this.loadDiscussionMessages();\n        }\n\n        /**\r\n         * Загрузка списка сообщений\r\n         */\n\n    }, {\n        key: 'loadDiscussionMessages',\n        value: function loadDiscussionMessages() {\n            var _this6 = this;\n\n            this.initEditors();\n\n            this.setDefaultDiscussionItem();\n            this.last_discussion_item.addClass('active');\n\n            new Promise(function (resolve, reject) {\n                Pace.start();\n\n                $.post(_this6.params.on_load_messages_list_by_model_url, {\n                    model_id: _this6.params.model_id != undefined ? _this6.params.model_id : _this6.params.default_model_id,\n                    dealer_id: _this6.params.dealer_id != undefined ? _this6.params.dealer_id : '',\n                    messages_status: _this6.params.messages_status,\n                    messages_type: _this6.params.messages_type,\n                    filter_by_user_id: _this6.params.last_user_id\n                }, function (result) {\n                    if (result.success) {\n                        resolve(result);\n                    } else {\n                        reject(result);\n                    }\n                });\n            }).then(function (result) {\n                //По умолчанию сделам первую из списка дискуссию выбранной\n                _this6.setDefaultDiscussionItem();\n\n                if (result.messages_list.length == 0) {\n                    _this6.getModelMessagesContainer().html('Нет сообщений');\n                } else {\n                    _this6.getModelMessagesContainer().html(result.messages_list);\n                    _this6.getUnreadMessagesCount();\n                }\n\n                _this6.scrollDown(_this6.scroll_container);\n\n                Pace.stop();\n            }).catch(function (result) {\n                _this6.getModelMessagesContainer().html('Ошибка при получении списка сообщений.');\n\n                Pace.stop();\n            });\n        }\n\n        /**\r\n         * Отображение списка дискуссий (Все или только непрочитанные)\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onFilterDiscussionsList',\n        value: function onFilterDiscussionsList(event) {\n            var $element = $(event.target);\n\n            this.getDiscussionVisibilityButtons().removeClass('current');\n            $element.addClass('current');\n\n            if ($element.data('show') == 'unread') {\n                this.getDiscussionListItem().hide();\n                $('[data-unread-count]').show();\n            } else {\n                this.getDiscussionListItem().show();\n            }\n        }\n    }, {\n        key: 'getUnreadMessagesCount',\n        value: function getUnreadMessagesCount() {\n            var _this7 = this;\n\n            var discussion_ids = [];\n\n            $('.discussion__list__item', this.getDiscussionsContainer()).each(function (ind, el) {\n                var discussion_item = $(el);\n\n                if (discussion_item.attr('data-unread') == undefined) {\n                    discussion_ids.push(discussion_item.data('discussion-id'));\n                } else {\n                    return;\n                }\n            });\n\n            if (discussion_ids.length > 0) {\n                new Promise(function (resolve2, reject2) {\n                    $.post(_this7.params.on_load_discussion_unread_url, {\n                        discussion_ids: discussion_ids.join(':')\n                    }, function (result) {\n                        resolve2(result);\n                    });\n                }).then(function (result) {\n                    _this7.drawUnreadDiscussionData(result);\n                });\n            }\n        }\n    }, {\n        key: 'drawUnreadDiscussionData',\n        value: function drawUnreadDiscussionData(result) {\n            var _this8 = this;\n\n            $.each(result.unread_count, function (index, value) {\n                $('.discussion__list__item__' + index, _this8.getDiscussionsContainer()).attr('data-unread', true);\n                if (value > 0) {\n                    $('.discussion__list__item__' + index, _this8.getDiscussionsContainer()).attr('data-unread-count', value);\n                }\n            });\n        }\n\n        /**\r\n         * Видимость панелей при движении курсора\r\n         * @param event\r\n         */\n\n    }, {\n        key: 'onMouseMoveInDiscussionContainer',\n        value: function onMouseMoveInDiscussionContainer(event) {\n            var panel = $(event.target).closest(this.params.container_discussion_panel);\n\n            if (this.last_panel != panel) {\n                this.last_panel = panel;\n\n                $(this.params.container_discussion_panel).removeClass('animate-show-panel');\n                $(this.params.container_discussion_panel).addClass('animate-hide-panel');\n\n                this.last_panel.removeClass('animate-hide-panel').addClass('animate-show-panel');\n            }\n        }\n    }, {\n        key: 'addDiscussionLastItemClass',\n        value: function addDiscussionLastItemClass(cls) {\n            if (this.last_discussion_item != null) {\n                this.last_discussion_item.addClass(cls);\n            }\n        }\n    }, {\n        key: 'getDiscussionVisibilityButtons',\n        value: function getDiscussionVisibilityButtons() {\n            return $(this.params.filter_visibility_messages);\n        }\n    }, {\n        key: 'getDiscussionsContainer',\n        value: function getDiscussionsContainer() {\n            return undefined;\n        }\n    }, {\n        key: 'getModelMessagesContainer',\n        value: function getModelMessagesContainer() {\n            return $(this.params.model_messages_container);\n        }\n    }, {\n        key: 'getDiscussionAskMessagesContainer',\n        value: function getDiscussionAskMessagesContainer() {\n            return $(this.params.discussion_ask_messages_container);\n        }\n    }, {\n        key: 'getElShowDiscussionMessages',\n        value: function getElShowDiscussionMessages() {\n            return $(this.params.on_show_discussion_messages);\n        }\n    }, {\n        key: 'resetDiscussionItems',\n        value: function resetDiscussionItems() {\n            $(this.params.on_show_discussion_messages).removeClass('active');\n        }\n    }, {\n        key: 'getElementByClass',\n        value: function getElementByClass(element, cls) {\n            var current_item = null;\n\n            $(element).each(function (ind, item) {\n                if ($(item).hasClass(cls)) {\n                    current_item = $(item);\n                }\n            });\n\n            return current_item;\n        }\n    }, {\n        key: 'getDiscussionItemParent',\n        value: function getDiscussionItemParent() {\n            return $('#dealer-discussions-container');\n        }\n    }, {\n        key: 'getDiscussionListItem',\n        value: function getDiscussionListItem() {\n            return $('.discussion__list__item', this.getDiscussionItemParent());\n        }\n    }, {\n        key: 'getDiscussionModelsList',\n        value: function getDiscussionModelsList() {\n            return $('.js-dealers-discussion-list-item');\n        }\n    }, {\n        key: 'getFrmDiscussionMessageElement',\n        value: function getFrmDiscussionMessageElement() {\n            if (this.params.frm_discussion_message_element != undefined) {\n                return $('#' + this.params.frm_discussion_message_element);\n            }\n\n            return undefined;\n        }\n    }, {\n        key: 'getFrmDiscussionAskMessageElement',\n        value: function getFrmDiscussionAskMessageElement() {\n            if (this.params.frm_discussion_ask_message_element != undefined) {\n                return $('#' + this.params.frm_discussion_ask_message_element);\n            }\n\n            return undefined;\n        }\n    }, {\n        key: 'setDefaultDiscussionItem',\n        value: function setDefaultDiscussionItem() {\n            if (this.last_discussion_item == null) {\n                this.last_discussion_item = $('.discussion__list__item', this.getDiscussionsContainer()).eq(0);\n\n                this.addDiscussionLastItemClass('active');\n            }\n        }\n\n        /**\r\n         *\r\n         * @param message_type\r\n         * @returns {{}}\r\n         */\n\n    }, {\n        key: 'getMessageDirection',\n        value: function getMessageDirection(message_type) {\n            return {};\n        }\n    }, {\n        key: 'makeRequestData',\n        value: function makeRequestData(data) {\n            alert('Not implemented');\n        }\n\n        /**\r\n         * Получить обьект ws\r\n         * @returns {WebSocket}\r\n         */\n\n    }, {\n        key: 'getWebSocket',\n        value: function getWebSocket() {\n            return this.params.websockets;\n        }\n    }, {\n        key: 'placeCaretAtEnd',\n        value: function placeCaretAtEnd(el) {\n            el.focus();\n            if (typeof window.getSelection != \"undefined\" && typeof document.createRange != \"undefined\") {\n                var range = document.createRange();\n                range.selectNodeContents(el);\n                range.collapse(false);\n                var sel = window.getSelection();\n                sel.removeAllRanges();\n                sel.addRange(range);\n            } else if (typeof document.body.createTextRange != \"undefined\") {\n                var textRange = document.body.createTextRange();\n                textRange.moveToElementText(el);\n                textRange.collapse(false);\n                textRange.select();\n            }\n        }\n    }, {\n        key: 'getFilesParam',\n        value: function getFilesParam(uploader) {\n            var params = {};\n\n            if (this.sending_files.length == 0 && uploader) {\n                this.sending_files = uploader.getFilesUploadList();\n            }\n\n            for (var i = 0; i < this.sending_files.length; i++) {\n                params['files[' + i + ']'] = this.sending_files[i];\n            }\n\n            return params;\n        }\n    }, {\n        key: 'deleteSentFiles',\n        value: function deleteSentFiles(uploader) {\n            if (uploader) {\n                if (uploader != null) {\n                    uploader.reset();\n                    uploader.drawFiles();\n                }\n\n                this.sending_files = [];\n            }\n        }\n    }, {\n        key: 'error',\n        value: function error(title, msg) {\n            //this.showMessage('error', msg);\n            showAlertPopup(title, msg);\n        }\n    }, {\n        key: 'info',\n        value: function info(msg) {\n            this.showMessage('info', msg);\n        }\n    }, {\n        key: 'success',\n        value: function success(msg) {\n            this.showMessage('success', msg);\n        }\n    }, {\n        key: 'warning',\n        value: function warning(msg) {\n            this.showMessage('warning', msg);\n        }\n    }, {\n        key: 'showMessage',\n        value: function showMessage(type, msg) {}\n\n        /**\r\n         *\r\n         * @returns {*|jQuery|HTMLElement}\r\n         */\n\n    }, {\n        key: 'getDiscussionChatBySidebarPanel',\n        value: function getDiscussionChatBySidebarPanel() {\n            return $('#discussion-rightbar-chat');\n        }\n\n        /**\r\n         * Контейнер подсчета новых сообщений\r\n         */\n\n    }, {\n        key: 'getDiscussionChatBySidebarCounter',\n        value: function getDiscussionChatBySidebarCounter() {\n            return $('.container-messages-counter');\n        }\n\n        /**\r\n         *\r\n         * @param data\r\n         * @returns {string}\r\n         */\n\n    }, {\n        key: 'formatSidebarChatItem',\n        value: function formatSidebarChatItem(data) {\n            return '\\n            <li class=\"discussion-chat-item-in-sidebar\" \\n                data-discussion-id=\"' + data.discussion_id + '\" \\n                data-model-id=\"' + data.model_id + '\" \\n                data-dealer-id=\"' + data.dealer_id + '\" \\n                data-message-type=\"' + data.message_type + '\"\\n            >\\n                <span class=\"model\">\\u2116 ' + data.model_id + '</span>\\n                <span class=\"author\">' + data.send_user + '</span>\\n                <span>' + data.message + '</span>\\n                <span class=\"time\">' + data.message_time + '</span>\\n            </li>\\n        ';\n        }\n    }, {\n        key: 'reloadAskMessages',\n        value: function reloadAskMessages() {}\n\n        /**\r\n         * Определяем номер дилера\r\n         * @returns {number}\r\n         */\n\n    }, {\n        key: 'getDealerId',\n        value: function getDealerId() {\n            var selected_dealer_item = this.getElementByClass('.dealer_model_item', 'active'),\n                dealer_id = 0;\n            if (selected_dealer_item != undefined) {\n                dealer_id = selected_dealer_item.data('dealer-id');\n            } else if ($('.js-dealer-discussion-list-item').eq(0).length > 0) {\n                dealer_id = $('.js-dealer-discussion-list-item').eq(0).data('dealer-id');\n            }\n\n            return dealer_id;\n        }\n\n        /**\r\n         * Скороллинг до последнего сообщения\r\n         * @param element\r\n         */\n\n    }, {\n        key: 'scrollDown',\n        value: function scrollDown(element) {\n            var height = document.getElementById(element).scrollHeight;\n\n            $('#' + element).animate({\n                scrollTop: height + \"px\"\n            }, { duration: 500 });\n        }\n    }]);\n\n    return BaseDiscussion;\n}();\n\nexports.default = BaseDiscussion;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvYmFzZV9kaXNjdXNzaW9uLmpzPzNmMzIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkga29zdGV0IG9uIDAzLjA4LjIwMTcuXHJcbiAqL1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQmFzZURpc2N1c3Npb24ge1xyXG4gICAgY29uc3RydWN0b3IocGFyYW1zKSB7XHJcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XHJcbiAgICAgICAgdGhpcy5zZW5kaW5nX2ZpbGVzID0gW107XHJcblxyXG4gICAgICAgIHRoaXMubGFzdF9pdGVtID0gbnVsbDtcclxuICAgICAgICB0aGlzLmxhc3RfZGlzY3Vzc2lvbl9pdGVtID0gbnVsbDtcclxuICAgICAgICB0aGlzLmZpbHRlciA9IHt9O1xyXG4gICAgICAgIHRoaXMubGFzdF9wYW5lbCA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLnBvc3RpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm1zZ19maWVsZCA9ICcnO1xyXG4gICAgICAgIHRoaXMuZGVmYXVsdF9vYmplY3RfaWQgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLm1lc3NhZ2VfZmllbGQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZV9hc2tfZmllbGQgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmRlYWxlcl9pZCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMucmVwbHlfb25fbWVzc2FnZV9pZCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuc2lkZWJhcl9wYW5lbF9oaWRlX2ludGVydmFsID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNjcm9sbF9jb250YWluZXIgPSAnY29udGFpbmVyLWRpc2N1c3Npb24tbWVzc2FnZXMnO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0KCkge1xyXG4gICAgICAgIC8v0KTQuNC70YzRgtGAINGB0L/QuNGB0LrQsCDRgdC+0L7QsdGJ0LXQvdC40LVcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCB0aGlzLnBhcmFtcy5maWx0ZXJfdmlzaWJpbGl0eV9tZXNzYWdlcywgJC5wcm94eSh0aGlzLm9uRmlsdGVyRGlzY3Vzc2lvbnNMaXN0LCB0aGlzKSk7XHJcblxyXG4gICAgICAgIC8v0JfQsNCz0YDRg9C30LrQsCDRgdC/0LjRgdC60LAg0YHQvtC+0LHRidC10L3QuNC1INCy0YvQsdGA0LDQvdC90L7QuSDQtNC40YHQutGD0YHRgdC40LhcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCB0aGlzLnBhcmFtcy5vbl9zaG93X2Rpc2N1c3Npb25fbWVzc2FnZXMsICQucHJveHkodGhpcy5vbkxvYWREaXNjdXNzaW9uTWVzc2FnZXNCeURpc2N1c3Npb24sIHRoaXMpKTtcclxuXHJcbiAgICAgICAgLy/QntGC0L7QsdGA0LDQttC10L3QuNC1IC8g0YHQutGA0YvRgtC40LUg0L/QsNC90LXQu9C40Lkg0L/RgNC4INC90LDQstC10LTQtdC90LjQuCDQutGD0YDRgdC+0YDQsFxyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZW92ZXInLCB0aGlzLnBhcmFtcy5jb250YWluZXJfZGlzY3Vzc2lvbl9wYW5lbCwgJC5wcm94eSh0aGlzLm9uTW91c2VNb3ZlSW5EaXNjdXNzaW9uQ29udGFpbmVyLCB0aGlzKSk7XHJcblxyXG4gICAgICAgIC8v0J7RgtC/0YDQsNCy0LrQsCDQvtCx0YvRh9C90L7Qs9C+INGB0L7QvtCx0YnQtdC90LjRj1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsIHRoaXMucGFyYW1zLmZybV9kaXNjdXNzaW9uX3NlbmRfYnV0dG9uLCAkLnByb3h5KHRoaXMub25TZW5kTWVzc2FnZSwgdGhpcykpO1xyXG5cclxuICAgICAgICAvL9Ce0YLQv9GA0LDQstC60LAg0YHQvtC+0LHRidC10L3QuNC1INGBINCy0L7Qv9GA0L7RgdC+0LxcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCB0aGlzLnBhcmFtcy5mcm1fZGlzY3Vzc2lvbl9zZW5kX2Fza19idXR0b24sICQucHJveHkodGhpcy5vblNlbmRBc2tNZXNzYWdlLCB0aGlzKSk7XHJcblxyXG4gICAgICAgIC8v0KDQsNCx0L7RgtCwINGBINC/0YDQsNCy0L7QuSDQv9Cw0L3QtdC70YzRjiDRgdC+0L7QsdGJ0LXQvdC40LlcclxuICAgICAgICAkKGRvY3VtZW50KS5vbignbW91c2Vtb3ZlJywgJyNzaWRlYmFyLXdyYXBwZXInLCAkLnByb3h5KHRoaXMub25TaG93U2lkZWJhclBhbmVsLCB0aGlzKSk7XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ21vdXNlb3V0JywgJyNzaWRlYmFyLXdyYXBwZXInLCAkLnByb3h5KHRoaXMub25IaWRlU2lkZWJhclBhbmVsLCB0aGlzKSk7XHJcblxyXG4gICAgICAgIC8v0J7RgtC60YDRi9GC0LjQtSDQv9Cw0L3QtdC70Lgg0YHQvtC+0LHRidC10L3QuNC5INC/0L4g0LrQu9C40LrRg1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjanMtY2hhdC1tZXNzYWdlcy1jb3VudGVyJywgJC5wcm94eSh0aGlzLm9uU2hvd1NpZGViYXJQYW5lbCwgdGhpcykpO1xyXG5cclxuICAgICAgICAvL9Cm0LjRgtC40YDQvtCy0LDQvdC40LUg0YHQvtC+0LHRidC10L3QuNGPXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5qcy1yZXBseS1vbi1jb21tZW50JywgJC5wcm94eSh0aGlzLm9uUmVwbHlNZXNzYWdlLCB0aGlzKSk7XHJcblxyXG4gICAgICAgIC8v0J7RgtC+0LHRgNCw0LfQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0L4g0LTQuNGB0LrRg9GB0YHQuNC4XHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5kaXNjdXNzaW9uLWNoYXQtaXRlbS1pbi1zaWRlYmFyJywgJC5wcm94eSh0aGlzLm9uU2hvd0Rpc2N1c3Npb25EYXRhQnlDaGF0SXRlbSwgdGhpcykpO1xyXG5cclxuICAgICAgICB0aGlzLmluaXRFZGl0b3JzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQntGC0L7QsdGA0LDQt9C40YLRjCDQuNC90YTQvtGA0LzQsNGG0LjRjiDQviDQtNC40YHQutGD0YHRgdC4INC/0L5cclxuICAgICAqIEBwYXJhbSBldmVudFxyXG4gICAgICovXHJcbiAgICBvblNob3dEaXNjdXNzaW9uRGF0YUJ5Q2hhdEl0ZW0oZXZlbnQpIHtcclxuICAgICAgICBsZXQgZWxlbWVudCA9ICQoZXZlbnQudGFyZ2V0KTtcclxuXHJcbiAgICAgICAgaWYgKGVsZW1lbnQuZGF0YSgnZGlzY3Vzc2lvbi1pZCcpID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8v0J/RgNC40L3Rg9C00LjQu9GM0L3Ri9C5INC60LvQuNC6INC00LvRjyDQt9Cw0LPRgNGD0LfQutC4INC/0L7RgdC70LXQtNC90LjRhSDRgdC+0L7QsdGJ0LXQvdC40LlcclxuICAgICAgICBpZiAoJCgnLmRpc2N1c3Npb25fX2RlYWxlcl9faXRlbV9fJyArIGVsZW1lbnQuZGF0YSgnZGVhbGVyLWlkJykpLmxlbmd0aCAhPSAwKSB7XHJcbiAgICAgICAgICAgICQoJy5kaXNjdXNzaW9uX19kZWFsZXJfX2l0ZW1fXycgKyBlbGVtZW50LmRhdGEoJ2RlYWxlci1pZCcpKS50cmlnZ2VyKCdjbGljaycpO1xyXG5cclxuICAgICAgICAgICAgLy/QodC60YDQvtC70LvQuNC8INC00L4g0L3QtdCx0YXQvtC00LjQvNC+0LPQviDQuNGC0LXQvNCwXHJcbiAgICAgICAgICAgIHNjcm9sbFRvcCgnLmRpc2N1c3Npb25fX2RlYWxlcl9faXRlbV9fJyArIGVsZW1lbnQuZGF0YSgnZGVhbGVyLWlkJyksICdkZWFsZXJzLWRpc2N1c3Npb25zLWNvbnRhaW5lcicpO1xyXG5cclxuICAgICAgICAgICAgLy/Qn9GA0L7QstC10YDQutCwINC90LAg0YLQuNC/INGB0L7QvtCx0YnQtdC90LjQuVxyXG4gICAgICAgICAgICAvL9CV0YHQu9C4INGB0L7QvtCx0YnQtdC90LjQtSDQv9GA0LjRiNC70L4g0YEg0YDQsNC30LTQtdC70LAg0JfQsNC00LDRh9Cw0YLRjCDQstC+0L/RgNC+0YEg0LTQtdC70LDQtdC8INC/0YDQvtCy0LXRgNC60YMg0L3QsCDQsNC60YLQuNCy0L3Rg9GOINC/0LDQvdC10LvRjCDQuCDQtNCw0LvRjNGI0LXQtdGB0LvQuCDQvtC90LAg0L3QtdCw0LrRgtC40LLQvdCwXHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50LmRhdGEoJ21lc3NhZ2UtdHlwZScpID09ICdhc2snKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGlzY3Vzc2lvbl90eXBlID0gJCgnLmRpc2N1c3Npb25zLW1lc3NhZ2VzLXR5cGVzJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgJC5lYWNoKGRpc2N1c3Npb25fdHlwZSwgKGluZGV4LCBpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVsZW1lbnQgPSAkKGl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWVsZW1lbnQuaGFzQ2xhc3MoJ2N1cnJlbnQnKSAmJiBlbGVtZW50LmRhdGEoJ3R5cGUnKSA9PSAnYXNrJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnRyaWdnZXIoJ2NsaWNrJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvL9Ci0LDQudC8INCw0YPRgiDQtNC70Y8g0LfQsNCz0YDRg9C30LrQuCDRgdC/0LjRgdC60LAg0YHQvtC+0LHRidC10L3QuNC5XHJcbiAgICAgICAgICAgICAgICBsZXQgYXR0ZW10c19jb3VudCA9IDA7IC8v0JrQvtC70LjRh9C10YHRgtCy0L4g0L/QvtC/0YvRgtC+0LpcclxuICAgICAgICAgICAgICAgIGxldCBpdGVtX2ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkKCcuZGlzY3Vzc2lvbl9fbGlzdF9faXRlbV9fJyArIGVsZW1lbnQuZGF0YSgnZGlzY3Vzc2lvbi1pZCcpKS5sZW5ndGggPiAwIHx8IGF0dGVtdHNfY291bnQgPCA1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJy5kaXNjdXNzaW9uX19saXN0X19pdGVtX18nICsgZWxlbWVudC5kYXRhKCdkaXNjdXNzaW9uLWlkJykpLnRyaWdnZXIoJ2NsaWNrJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGl0ZW1faW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0ZW10c19jb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCgnLmRpc2N1c3Npb25fX2xpc3RfX2l0ZW1fXycgKyBlbGVtZW50LmRhdGEoJ2Rpc2N1c3Npb24taWQnKSkudHJpZ2dlcignY2xpY2snKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25TaG93U2lkZWJhclBhbmVsKGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IGVsZW1lbnQgPSAkKGV2ZW50LnRhcmdldCk7XHJcblxyXG4gICAgICAgIGlmIChlbGVtZW50LmRhdGEoJ29wZW4nKSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgZWxlbWVudCA9IGVsZW1lbnQucGFyZW50KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZWxlbWVudC5kYXRhKCdvcGVuJykgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICQoXCIjZGlzY3Vzc2lvbi13cmFwcGVyXCIpLnRvZ2dsZUNsYXNzKCd0b2dnbGVkJyk7XHJcblxyXG4gICAgICAgICAgICBlbGVtZW50LmNzcygncmlnaHQnLCAnLTIzMHB4Jyk7XHJcblxyXG4gICAgICAgICAgICAvL9Ce0LHQvdGD0LvRj9C10Lwg0LrQvtC70LjRh9C10YLQstC+INGB0L7QvtCx0YnQtdC90LjQuSDQvtGCINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvQtdC5XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RGlzY3Vzc2lvbkNoYXRCeVNpZGViYXJDb3VudGVyKCkudGV4dCgwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5zaWRlYmFyX3BhbmVsX2hpZGVfaW50ZXJ2YWwpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uSGlkZVNpZGViYXJQYW5lbCgpIHtcclxuICAgICAgICB0aGlzLnNpZGViYXJfcGFuZWxfaGlkZV9pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICAgICAgJChcIiNkaXNjdXNzaW9uLXdyYXBwZXJcIikudG9nZ2xlQ2xhc3MoJ3RvZ2dsZWQnKTtcclxuXHJcbiAgICAgICAgICAgICQoJyNqcy1jaGF0LW1lc3NhZ2VzLWNvdW50ZXInKS5jc3MoJ3JpZ2h0JywgJzBweCcpO1xyXG5cclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnNpZGViYXJfcGFuZWxfaGlkZV9pbnRlcnZhbCk7XHJcbiAgICAgICAgfSwgNTAwKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCY0L3QuNGG0LjQsNC70LjRhtC30LDRhtC40Y8g0YLQtdC60YHRgtC+0LLRi9GFINC/0L7Qu9C10Lkg0LTQu9GPINGB0L7QvtCx0YnQtdC90LjQuVxyXG4gICAgICovXHJcbiAgICBpbml0RWRpdG9ycygpIHtcclxuICAgICAgICBpZiAodGhpcy5nZXRGcm1EaXNjdXNzaW9uTWVzc2FnZUVsZW1lbnQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmdldEZybURpc2N1c3Npb25NZXNzYWdlRWxlbWVudCgpLmh0bWwoJycpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMubWVzc2FnZV9maWVsZCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VfZmllbGQgPSBuZXcgTWVkaXVtKHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnBhcmFtcy5mcm1fZGlzY3Vzc2lvbl9tZXNzYWdlX2VsZW1lbnQpLFxyXG4gICAgICAgICAgICAgICAgICAgIG1vZGU6IE1lZGl1bS5yaWNoTW9kZSxcclxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogJ9CS0LLQtdC00LjRgtC1INC60L7QvNC80LXQvdGC0LDRgNC40LknLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgYXV0b2ZvY3VzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGF1dG9IUjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgdGFnczogbnVsbFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmdldEZybURpc2N1c3Npb25Bc2tNZXNzYWdlRWxlbWVudCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RnJtRGlzY3Vzc2lvbkFza01lc3NhZ2VFbGVtZW50KCkuaHRtbCgnJyk7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5tZXNzYWdlX2Fza19maWVsZCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VfYXNrX2ZpZWxkID0gbmV3IE1lZGl1bSh7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5wYXJhbXMuZnJtX2Rpc2N1c3Npb25fYXNrX21lc3NhZ2VfZWxlbWVudCksXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZTogTWVkaXVtLnJpY2hNb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAn0JLQstC10LTQuNGC0LUg0LrQvtC80LzQtdC90YLQsNGA0LjQuScsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICB0YWdzOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCm0LjRgtC40YDQvtCy0LDRgtGMINGB0L7QvtCx0YnQtdC90LjQtVxyXG4gICAgICovXHJcbiAgICBvblJlcGx5TWVzc2FnZShldmVudCkge1xyXG4gICAgICAgIGxldCAkZWxlbWVudCA9ICQoZXZlbnQudGFyZ2V0KSwgbWVzc2FnZV90eXBlID0gJGVsZW1lbnQuZGF0YSgnbWVzc2FnZS10eXBlJyksXHJcbiAgICAgICAgICAgIG1lc3NhZ2VfaWQgPSAkZWxlbWVudC5kYXRhKCdtZXNzYWdlLWlkJyksIGVsZW1lbnRfbXNnID0gJGVsZW1lbnQuZGF0YSgnbXNnJyksXHJcbiAgICAgICAgICAgIHRleHRfZWxlbWVudCA9ICQoJ1tkYXRhLW1lc3NhZ2UtZmllbGQ9JyArIG1lc3NhZ2VfdHlwZSArICddJyk7XHJcblxyXG4gICAgICAgICRlbGVtZW50LmhpZGUoKTtcclxuICAgICAgICBpZiAodGV4dF9lbGVtZW50ICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBsZXQgZWxlbWVudF9pZCA9IChtZXNzYWdlX3R5cGUgPT0gJ21lc3NhZ2UnID8gdGhpcy5wYXJhbXMuZnJtX2Rpc2N1c3Npb25fbWVzc2FnZV9lbGVtZW50IDogdGhpcy5wYXJhbXMuZnJtX2Rpc2N1c3Npb25fYXNrX21lc3NhZ2VfZWxlbWVudCksXHJcbiAgICAgICAgICAgICAgICB0ZXh0X2FyZWEgPSAkKCcjJyArIGVsZW1lbnRfaWQpO1xyXG5cclxuICAgICAgICAgICAgdGV4dF9hcmVhLmZvY3VzKCk7XHJcblxyXG4gICAgICAgICAgICB0ZXh0X2FyZWEuaHRtbCgnJyk7XHJcbiAgICAgICAgICAgIHRleHRfYXJlYS5hcHBlbmQoJzxibG9ja3F1b3RlPicgKyBlbGVtZW50X21zZyArICc8L2Jsb2NrcXVvdGU+PGJyLz4nKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVwbHlfb25fbWVzc2FnZV9pZCA9IG1lc3NhZ2VfaWQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnBsYWNlQ2FyZXRBdEVuZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50X2lkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uU2VuZE1lc3NhZ2UoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICB0aGlzLm1zZ19maWVsZCA9IHRoaXMucGFyYW1zLmZybV9kaXNjdXNzaW9uX21lc3NhZ2VfZWxlbWVudDtcclxuICAgICAgICB0aGlzLnNlbmRNZXNzYWdlKHRoaXMucGFyYW1zLm9uX3Bvc3RfbmV3X21lc3NhZ2VfdXJsLCB0aGlzLnBhcmFtcy5kaXNjdXNzaW9uX21vZGVsX21lc3NhZ2VzLCAnbWVzc2FnZScsIChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWREaXNjdXNzaW9uTWVzc2FnZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU2VuZEFza01lc3NhZ2UoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICB0aGlzLm1zZ19maWVsZCA9IHRoaXMucGFyYW1zLmZybV9kaXNjdXNzaW9uX2Fza19tZXNzYWdlX2VsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5zZW5kTWVzc2FnZSh0aGlzLnBhcmFtcy5vbl9wb3N0X25ld19tZXNzYWdlX3VybCwgdGhpcy5wYXJhbXMuZGlzY3Vzc2lvbl9hc2ssICdhc2snLCAocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkQXNrTWVzc2FnZXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNlbmRNZXNzYWdlKHVybCwgdXBsb2FkZXIsIG1lc3NhZ2VfdHlwZSwgY2FsbGJhY2spIHtcclxuICAgICAgICBsZXQgdG90YWxfdXBsb2FkZWRfZmlsZXMgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLnNldERlZmF1bHREaXNjdXNzaW9uSXRlbSgpO1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5nZXRGaWxlc1BhcmFtKHVwbG9hZGVyKSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5nZXRGaWxlc1BhcmFtKHVwbG9hZGVyKS5oYXNPd25Qcm9wZXJ0eShpKSkge1xyXG4gICAgICAgICAgICAgICAgdG90YWxfdXBsb2FkZWRfZmlsZXMrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucG9zdGluZyB8fCAoJC50cmltKHRoaXMuZ2V0TWVzc2FnZSgpKSA9PSAnJyAmJiB0b3RhbF91cGxvYWRlZF9maWxlcyA9PSAwKSkge1xyXG4gICAgICAgICAgICBzaG93QWxlcnRQb3B1cCgn0J7RiNC40LHQutCwLicsICfQktCy0LXQtNC40YLQtSDRgdC+0L7QsdGJ0LXQvdC40LUg0LjQu9C4INC30LDQs9GA0YPQt9C40YLQtSDRhNCw0LnQuy4nKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5tZXNzYWdlX3R5cGUgPSBtZXNzYWdlX3R5cGU7XHJcbiAgICAgICAgbGV0IGRhdGEgPSAkLmV4dGVuZCh0aGlzLmdldEZpbGVzUGFyYW0oKSwge1xyXG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMubGFzdF9kaXNjdXNzaW9uX2l0ZW0uZGF0YSgnZGlzY3Vzc2lvbi1pZCcpLFxyXG4gICAgICAgICAgICAgICAgbW9kZWxfaWQ6IHRoaXMubGFzdF9kaXNjdXNzaW9uX2l0ZW0uZGF0YSgnbW9kZWwtaWQnKSxcclxuICAgICAgICAgICAgICAgIGRlYWxlcl9pZDogdGhpcy5nZXREZWFsZXJJZCgpLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5nZXRNZXNzYWdlKCksXHJcbiAgICAgICAgICAgICAgICByZXBseV9vbl9tZXNzYWdlX2lkOiB0aGlzLnJlcGx5X29uX21lc3NhZ2VfaWQsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlX3R5cGU6IG1lc3NhZ2VfdHlwZSxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGRhdGEgPSAkLmV4dGVuZCh0aGlzLmdldE1lc3NhZ2VEaXJlY3Rpb24obWVzc2FnZV90eXBlKSwgZGF0YSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcblxyXG4gICAgICAgIHRoaXMucG9zdGluZyA9IHRydWU7XHJcbiAgICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICAkLnBvc3QodXJsLFxyXG4gICAgICAgICAgICAgICAgZGF0YSxcclxuICAgICAgICAgICAgICAgIChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3N0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmdldE1lc3NhZ2VGaWVsZCgpLmh0bWwoJycpO1xyXG4gICAgICAgICAgICB0aGlzLmRlbGV0ZVNlbnRGaWxlcyh1cGxvYWRlcik7XHJcblxyXG4gICAgICAgICAgICBpZiAocmVzdWx0LnJlc3BvbnNlICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgZGF0YSA9ICQuZXh0ZW5kKHJlc3VsdC5yZXNwb25zZSwgZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5tYWtlUmVxdWVzdERhdGEoZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBsb2FkQXNrTWVzc2FnZXMoKSB7XHJcbiAgICAgICAgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICAkLnBvc3QodGhpcy5wYXJhbXMub25fbG9hZF9hc2tfbWVzc2FnZXNfdXJsLFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLmxhc3RfZGlzY3Vzc2lvbl9pdGVtLmRhdGEoJ2Rpc2N1c3Npb24taWQnKSxcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbF9pZDogdGhpcy5sYXN0X2Rpc2N1c3Npb25faXRlbS5kYXRhKCdtb2RlbC1pZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgIGRlYWxlcl9pZDogdGhpcy5nZXREZWFsZXJJZCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlcGx5X29uX21lc3NhZ2VfaWQ6IHRoaXMucmVwbHlfb25fbWVzc2FnZV9pZCxcclxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlX3R5cGU6IHRoaXMubWVzc2FnZV90eXBlLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmdldERpc2N1c3Npb25Bc2tNZXNzYWdlc0NvbnRhaW5lcigpLmh0bWwocmVzdWx0Lm1lc3NhZ2VzX2xpc3QpO1xyXG4gICAgICAgIH0pLmNhdGNoKChyZXN1bHQpID0+IHtcclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TWVzc2FnZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXNzYWdlRmllbGQoKS5odG1sKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TWVzc2FnZUZpZWxkKCkge1xyXG4gICAgICAgIHJldHVybiAkKCcjJyArIHRoaXMubXNnX2ZpZWxkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCX0LDQs9GA0YPQt9C60LAg0YHQv9C40YHQutCwINGB0L7QvtCx0YnQtdC90LjQuSDQv9C+INCy0YvQsdGA0LDQvdC90L7QuSDQtNC40YHQutGD0YHRgdC40LggKNC30LDRj9Cy0LrQuClcclxuICAgICAqIEBwYXJhbSBldmVudFxyXG4gICAgICovXHJcbiAgICBvbkxvYWREaXNjdXNzaW9uTWVzc2FnZXNCeURpc2N1c3Npb24oZXZlbnQpIHtcclxuICAgICAgICBsZXQgZGlzY3Vzc2lvbl9pdGVtID0gJChldmVudC50YXJnZXQpO1xyXG5cclxuICAgICAgICBpZiAoZGlzY3Vzc2lvbl9pdGVtLmRhdGEoJ21vZGVsLWlkJykgPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGRpc2N1c3Npb25faXRlbSA9IGRpc2N1c3Npb25faXRlbS5wYXJlbnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGFyYW1zLm1vZGVsX2lkID0gZGlzY3Vzc2lvbl9pdGVtLmRhdGEoJ21vZGVsLWlkJyk7XHJcbiAgICAgICAgdGhpcy5sYXN0X2Rpc2N1c3Npb25faXRlbSA9IGRpc2N1c3Npb25faXRlbTtcclxuXHJcbiAgICAgICAgdGhpcy5yZXNldERpc2N1c3Npb25JdGVtcygpO1xyXG4gICAgICAgIHRoaXMubG9hZERpc2N1c3Npb25NZXNzYWdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0JfQsNCz0YDRg9C30LrQsCDRgdC/0LjRgdC60LAg0YHQvtC+0LHRidC10L3QuNC5XHJcbiAgICAgKi9cclxuICAgIGxvYWREaXNjdXNzaW9uTWVzc2FnZXMoKSB7XHJcbiAgICAgICAgdGhpcy5pbml0RWRpdG9ycygpO1xyXG5cclxuICAgICAgICB0aGlzLnNldERlZmF1bHREaXNjdXNzaW9uSXRlbSgpO1xyXG4gICAgICAgIHRoaXMubGFzdF9kaXNjdXNzaW9uX2l0ZW0uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cclxuICAgICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIFBhY2Uuc3RhcnQoKTtcclxuXHJcbiAgICAgICAgICAgICQucG9zdCh0aGlzLnBhcmFtcy5vbl9sb2FkX21lc3NhZ2VzX2xpc3RfYnlfbW9kZWxfdXJsLCB7XHJcbiAgICAgICAgICAgICAgICBtb2RlbF9pZDogdGhpcy5wYXJhbXMubW9kZWxfaWQgIT0gdW5kZWZpbmVkID8gdGhpcy5wYXJhbXMubW9kZWxfaWQgOiB0aGlzLnBhcmFtcy5kZWZhdWx0X21vZGVsX2lkLFxyXG4gICAgICAgICAgICAgICAgZGVhbGVyX2lkOiB0aGlzLnBhcmFtcy5kZWFsZXJfaWQgIT0gdW5kZWZpbmVkID8gdGhpcy5wYXJhbXMuZGVhbGVyX2lkIDogJycsXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlc19zdGF0dXM6IHRoaXMucGFyYW1zLm1lc3NhZ2VzX3N0YXR1cyxcclxuICAgICAgICAgICAgICAgIG1lc3NhZ2VzX3R5cGU6IHRoaXMucGFyYW1zLm1lc3NhZ2VzX3R5cGUsXHJcbiAgICAgICAgICAgICAgICBmaWx0ZXJfYnlfdXNlcl9pZDogdGhpcy5wYXJhbXMubGFzdF91c2VyX2lkXHJcbiAgICAgICAgICAgIH0sIChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSkudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgICAgICAgIC8v0J/QviDRg9C80L7Qu9GH0LDQvdC40Y4g0YHQtNC10LvQsNC8INC/0LXRgNCy0YPRjiDQuNC3INGB0L/QuNGB0LrQsCDQtNC40YHQutGD0YHRgdC40Y4g0LLRi9Cx0YDQsNC90L3QvtC5XHJcbiAgICAgICAgICAgIHRoaXMuc2V0RGVmYXVsdERpc2N1c3Npb25JdGVtKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAocmVzdWx0Lm1lc3NhZ2VzX2xpc3QubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0TW9kZWxNZXNzYWdlc0NvbnRhaW5lcigpLmh0bWwoJ9Cd0LXRgiDRgdC+0L7QsdGJ0LXQvdC40LknKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0TW9kZWxNZXNzYWdlc0NvbnRhaW5lcigpLmh0bWwocmVzdWx0Lm1lc3NhZ2VzX2xpc3QpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRVbnJlYWRNZXNzYWdlc0NvdW50KCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsRG93bih0aGlzLnNjcm9sbF9jb250YWluZXIpO1xyXG5cclxuICAgICAgICAgICAgUGFjZS5zdG9wKCk7XHJcbiAgICAgICAgfSkuY2F0Y2goKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmdldE1vZGVsTWVzc2FnZXNDb250YWluZXIoKS5odG1sKCfQntGI0LjQsdC60LAg0L/RgNC4INC/0L7Qu9GD0YfQtdC90LjQuCDRgdC/0LjRgdC60LAg0YHQvtC+0LHRidC10L3QuNC5LicpO1xyXG5cclxuICAgICAgICAgICAgUGFjZS5zdG9wKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQntGC0L7QsdGA0LDQttC10L3QuNC1INGB0L/QuNGB0LrQsCDQtNC40YHQutGD0YHRgdC40LkgKNCS0YHQtSDQuNC70Lgg0YLQvtC70YzQutC+INC90LXQv9GA0L7Rh9C40YLQsNC90L3Ri9C1KVxyXG4gICAgICogQHBhcmFtIGV2ZW50XHJcbiAgICAgKi9cclxuICAgIG9uRmlsdGVyRGlzY3Vzc2lvbnNMaXN0KGV2ZW50KSB7XHJcbiAgICAgICAgbGV0ICRlbGVtZW50ID0gJChldmVudC50YXJnZXQpO1xyXG5cclxuICAgICAgICB0aGlzLmdldERpc2N1c3Npb25WaXNpYmlsaXR5QnV0dG9ucygpLnJlbW92ZUNsYXNzKCdjdXJyZW50Jyk7XHJcbiAgICAgICAgJGVsZW1lbnQuYWRkQ2xhc3MoJ2N1cnJlbnQnKTtcclxuXHJcbiAgICAgICAgaWYgKCRlbGVtZW50LmRhdGEoJ3Nob3cnKSA9PSAndW5yZWFkJykge1xyXG4gICAgICAgICAgICB0aGlzLmdldERpc2N1c3Npb25MaXN0SXRlbSgpLmhpZGUoKTtcclxuICAgICAgICAgICAgJCgnW2RhdGEtdW5yZWFkLWNvdW50XScpLnNob3coKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmdldERpc2N1c3Npb25MaXN0SXRlbSgpLnNob3coKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VW5yZWFkTWVzc2FnZXNDb3VudCgpIHtcclxuICAgICAgICBsZXQgZGlzY3Vzc2lvbl9pZHMgPSBbXTtcclxuXHJcbiAgICAgICAgJCgnLmRpc2N1c3Npb25fX2xpc3RfX2l0ZW0nLCB0aGlzLmdldERpc2N1c3Npb25zQ29udGFpbmVyKCkpLmVhY2goKGluZCwgZWwpID0+IHtcclxuICAgICAgICAgICAgbGV0IGRpc2N1c3Npb25faXRlbSA9ICQoZWwpO1xyXG5cclxuICAgICAgICAgICAgaWYgKGRpc2N1c3Npb25faXRlbS5hdHRyKCdkYXRhLXVucmVhZCcpID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgZGlzY3Vzc2lvbl9pZHMucHVzaChkaXNjdXNzaW9uX2l0ZW0uZGF0YSgnZGlzY3Vzc2lvbi1pZCcpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoZGlzY3Vzc2lvbl9pZHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZTIsIHJlamVjdDIpID0+IHtcclxuICAgICAgICAgICAgICAgICQucG9zdCh0aGlzLnBhcmFtcy5vbl9sb2FkX2Rpc2N1c3Npb25fdW5yZWFkX3VybCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpc2N1c3Npb25faWRzOiBkaXNjdXNzaW9uX2lkcy5qb2luKCc6JylcclxuICAgICAgICAgICAgICAgIH0sIChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlMihyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3VW5yZWFkRGlzY3Vzc2lvbkRhdGEocmVzdWx0KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGRyYXdVbnJlYWREaXNjdXNzaW9uRGF0YShyZXN1bHQpIHtcclxuICAgICAgICAkLmVhY2gocmVzdWx0LnVucmVhZF9jb3VudCwgKGluZGV4LCB2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAkKCcuZGlzY3Vzc2lvbl9fbGlzdF9faXRlbV9fJyArIGluZGV4LCB0aGlzLmdldERpc2N1c3Npb25zQ29udGFpbmVyKCkpLmF0dHIoJ2RhdGEtdW5yZWFkJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICQoJy5kaXNjdXNzaW9uX19saXN0X19pdGVtX18nICsgaW5kZXgsIHRoaXMuZ2V0RGlzY3Vzc2lvbnNDb250YWluZXIoKSkuYXR0cignZGF0YS11bnJlYWQtY291bnQnLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCS0LjQtNC40LzQvtGB0YLRjCDQv9Cw0L3QtdC70LXQuSDQv9GA0Lgg0LTQstC40LbQtdC90LjQuCDQutGD0YDRgdC+0YDQsFxyXG4gICAgICogQHBhcmFtIGV2ZW50XHJcbiAgICAgKi9cclxuICAgIG9uTW91c2VNb3ZlSW5EaXNjdXNzaW9uQ29udGFpbmVyKGV2ZW50KSB7XHJcbiAgICAgICAgbGV0IHBhbmVsID0gJChldmVudC50YXJnZXQpLmNsb3Nlc3QodGhpcy5wYXJhbXMuY29udGFpbmVyX2Rpc2N1c3Npb25fcGFuZWwpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5sYXN0X3BhbmVsICE9IHBhbmVsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdF9wYW5lbCA9IHBhbmVsO1xyXG5cclxuICAgICAgICAgICAgJCh0aGlzLnBhcmFtcy5jb250YWluZXJfZGlzY3Vzc2lvbl9wYW5lbCkucmVtb3ZlQ2xhc3MoJ2FuaW1hdGUtc2hvdy1wYW5lbCcpO1xyXG4gICAgICAgICAgICAkKHRoaXMucGFyYW1zLmNvbnRhaW5lcl9kaXNjdXNzaW9uX3BhbmVsKS5hZGRDbGFzcygnYW5pbWF0ZS1oaWRlLXBhbmVsJylcclxuXHJcbiAgICAgICAgICAgIHRoaXMubGFzdF9wYW5lbC5yZW1vdmVDbGFzcygnYW5pbWF0ZS1oaWRlLXBhbmVsJykuYWRkQ2xhc3MoJ2FuaW1hdGUtc2hvdy1wYW5lbCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhZGREaXNjdXNzaW9uTGFzdEl0ZW1DbGFzcyhjbHMpIHtcclxuICAgICAgICBpZiAodGhpcy5sYXN0X2Rpc2N1c3Npb25faXRlbSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdF9kaXNjdXNzaW9uX2l0ZW0uYWRkQ2xhc3MoY2xzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzY3Vzc2lvblZpc2liaWxpdHlCdXR0b25zKCkge1xyXG4gICAgICAgIHJldHVybiAkKHRoaXMucGFyYW1zLmZpbHRlcl92aXNpYmlsaXR5X21lc3NhZ2VzKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREaXNjdXNzaW9uc0NvbnRhaW5lcigpIHtcclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE1vZGVsTWVzc2FnZXNDb250YWluZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICQodGhpcy5wYXJhbXMubW9kZWxfbWVzc2FnZXNfY29udGFpbmVyKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXREaXNjdXNzaW9uQXNrTWVzc2FnZXNDb250YWluZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICQodGhpcy5wYXJhbXMuZGlzY3Vzc2lvbl9hc2tfbWVzc2FnZXNfY29udGFpbmVyKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRFbFNob3dEaXNjdXNzaW9uTWVzc2FnZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuICQodGhpcy5wYXJhbXMub25fc2hvd19kaXNjdXNzaW9uX21lc3NhZ2VzKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldERpc2N1c3Npb25JdGVtcygpIHtcclxuICAgICAgICAkKHRoaXMucGFyYW1zLm9uX3Nob3dfZGlzY3Vzc2lvbl9tZXNzYWdlcykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEVsZW1lbnRCeUNsYXNzKGVsZW1lbnQsIGNscykge1xyXG4gICAgICAgIGxldCBjdXJyZW50X2l0ZW0gPSBudWxsO1xyXG5cclxuICAgICAgICAkKGVsZW1lbnQpLmVhY2goKGluZCwgaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoJChpdGVtKS5oYXNDbGFzcyhjbHMpKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50X2l0ZW0gPSAkKGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBjdXJyZW50X2l0ZW07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzY3Vzc2lvbkl0ZW1QYXJlbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJyNkZWFsZXItZGlzY3Vzc2lvbnMtY29udGFpbmVyJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzY3Vzc2lvbkxpc3RJdGVtKCkge1xyXG4gICAgICAgIHJldHVybiAkKCcuZGlzY3Vzc2lvbl9fbGlzdF9faXRlbScsIHRoaXMuZ2V0RGlzY3Vzc2lvbkl0ZW1QYXJlbnQoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlzY3Vzc2lvbk1vZGVsc0xpc3QoKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJy5qcy1kZWFsZXJzLWRpc2N1c3Npb24tbGlzdC1pdGVtJyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RnJtRGlzY3Vzc2lvbk1lc3NhZ2VFbGVtZW50KCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBhcmFtcy5mcm1fZGlzY3Vzc2lvbl9tZXNzYWdlX2VsZW1lbnQgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkKCcjJyArIHRoaXMucGFyYW1zLmZybV9kaXNjdXNzaW9uX21lc3NhZ2VfZWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEZybURpc2N1c3Npb25Bc2tNZXNzYWdlRWxlbWVudCgpIHtcclxuICAgICAgICBpZiAodGhpcy5wYXJhbXMuZnJtX2Rpc2N1c3Npb25fYXNrX21lc3NhZ2VfZWxlbWVudCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICQoJyMnICsgdGhpcy5wYXJhbXMuZnJtX2Rpc2N1c3Npb25fYXNrX21lc3NhZ2VfZWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG5cclxuICAgIHNldERlZmF1bHREaXNjdXNzaW9uSXRlbSgpIHtcclxuICAgICAgICBpZiAodGhpcy5sYXN0X2Rpc2N1c3Npb25faXRlbSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGFzdF9kaXNjdXNzaW9uX2l0ZW0gPSAkKCcuZGlzY3Vzc2lvbl9fbGlzdF9faXRlbScsIHRoaXMuZ2V0RGlzY3Vzc2lvbnNDb250YWluZXIoKSkuZXEoMCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFkZERpc2N1c3Npb25MYXN0SXRlbUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG1lc3NhZ2VfdHlwZVxyXG4gICAgICogQHJldHVybnMge3t9fVxyXG4gICAgICovXHJcbiAgICBnZXRNZXNzYWdlRGlyZWN0aW9uKG1lc3NhZ2VfdHlwZSkge1xyXG4gICAgICAgIHJldHVybiB7fTtcclxuICAgIH1cclxuXHJcbiAgICBtYWtlUmVxdWVzdERhdGEoZGF0YSkge1xyXG4gICAgICAgIGFsZXJ0KCdOb3QgaW1wbGVtZW50ZWQnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqINCf0L7Qu9GD0YfQuNGC0Ywg0L7QsdGM0LXQutGCIHdzXHJcbiAgICAgKiBAcmV0dXJucyB7V2ViU29ja2V0fVxyXG4gICAgICovXHJcbiAgICBnZXRXZWJTb2NrZXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGFyYW1zLndlYnNvY2tldHM7XHJcbiAgICB9XHJcblxyXG4gICAgcGxhY2VDYXJldEF0RW5kKGVsKSB7XHJcbiAgICAgICAgZWwuZm9jdXMoKTtcclxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5nZXRTZWxlY3Rpb24gIT0gXCJ1bmRlZmluZWRcIlxyXG4gICAgICAgICAgICAmJiB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlUmFuZ2UgIT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICB2YXIgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xyXG4gICAgICAgICAgICByYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoZWwpO1xyXG4gICAgICAgICAgICByYW5nZS5jb2xsYXBzZShmYWxzZSk7XHJcbiAgICAgICAgICAgIHZhciBzZWwgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgIHNlbC5yZW1vdmVBbGxSYW5nZXMoKTtcclxuICAgICAgICAgICAgc2VsLmFkZFJhbmdlKHJhbmdlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSAhPSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0UmFuZ2UgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpO1xyXG4gICAgICAgICAgICB0ZXh0UmFuZ2UubW92ZVRvRWxlbWVudFRleHQoZWwpO1xyXG4gICAgICAgICAgICB0ZXh0UmFuZ2UuY29sbGFwc2UoZmFsc2UpO1xyXG4gICAgICAgICAgICB0ZXh0UmFuZ2Uuc2VsZWN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEZpbGVzUGFyYW0odXBsb2FkZXIpIHtcclxuICAgICAgICB2YXIgcGFyYW1zID0ge31cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2VuZGluZ19maWxlcy5sZW5ndGggPT0gMCAmJiB1cGxvYWRlcikge1xyXG4gICAgICAgICAgICB0aGlzLnNlbmRpbmdfZmlsZXMgPSB1cGxvYWRlci5nZXRGaWxlc1VwbG9hZExpc3QoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zZW5kaW5nX2ZpbGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHBhcmFtc1snZmlsZXNbJyArIGkgKyAnXSddID0gdGhpcy5zZW5kaW5nX2ZpbGVzW2ldO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHBhcmFtcztcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVTZW50RmlsZXModXBsb2FkZXIpIHtcclxuICAgICAgICBpZiAodXBsb2FkZXIpIHtcclxuICAgICAgICAgICAgaWYgKHVwbG9hZGVyICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHVwbG9hZGVyLnJlc2V0KCk7XHJcbiAgICAgICAgICAgICAgICB1cGxvYWRlci5kcmF3RmlsZXMoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5zZW5kaW5nX2ZpbGVzID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGVycm9yKHRpdGxlLCBtc2cpIHtcclxuICAgICAgICAvL3RoaXMuc2hvd01lc3NhZ2UoJ2Vycm9yJywgbXNnKTtcclxuICAgICAgICBzaG93QWxlcnRQb3B1cCh0aXRsZSwgbXNnKTtcclxuICAgIH1cclxuXHJcbiAgICBpbmZvKG1zZykge1xyXG4gICAgICAgIHRoaXMuc2hvd01lc3NhZ2UoJ2luZm8nLCBtc2cpO1xyXG4gICAgfVxyXG5cclxuICAgIHN1Y2Nlc3MobXNnKSB7XHJcbiAgICAgICAgdGhpcy5zaG93TWVzc2FnZSgnc3VjY2VzcycsIG1zZyk7XHJcbiAgICB9XHJcblxyXG4gICAgd2FybmluZyhtc2cpIHtcclxuICAgICAgICB0aGlzLnNob3dNZXNzYWdlKCd3YXJuaW5nJywgbXNnKTtcclxuICAgIH1cclxuXHJcbiAgICBzaG93TWVzc2FnZSh0eXBlLCBtc2cpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMgeyp8alF1ZXJ5fEhUTUxFbGVtZW50fVxyXG4gICAgICovXHJcbiAgICBnZXREaXNjdXNzaW9uQ2hhdEJ5U2lkZWJhclBhbmVsKCkge1xyXG4gICAgICAgIHJldHVybiAkKCcjZGlzY3Vzc2lvbi1yaWdodGJhci1jaGF0Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQmtC+0L3RgtC10LnQvdC10YAg0L/QvtC00YHRh9C10YLQsCDQvdC+0LLRi9GFINGB0L7QvtCx0YnQtdC90LjQuVxyXG4gICAgICovXHJcbiAgICBnZXREaXNjdXNzaW9uQ2hhdEJ5U2lkZWJhckNvdW50ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuICQoJy5jb250YWluZXItbWVzc2FnZXMtY291bnRlcicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBkYXRhXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gICAgICovXHJcbiAgICBmb3JtYXRTaWRlYmFyQ2hhdEl0ZW0oZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBgXHJcbiAgICAgICAgICAgIDxsaSBjbGFzcz1cImRpc2N1c3Npb24tY2hhdC1pdGVtLWluLXNpZGViYXJcIiBcclxuICAgICAgICAgICAgICAgIGRhdGEtZGlzY3Vzc2lvbi1pZD1cIiR7ZGF0YS5kaXNjdXNzaW9uX2lkfVwiIFxyXG4gICAgICAgICAgICAgICAgZGF0YS1tb2RlbC1pZD1cIiR7ZGF0YS5tb2RlbF9pZH1cIiBcclxuICAgICAgICAgICAgICAgIGRhdGEtZGVhbGVyLWlkPVwiJHtkYXRhLmRlYWxlcl9pZH1cIiBcclxuICAgICAgICAgICAgICAgIGRhdGEtbWVzc2FnZS10eXBlPVwiJHtkYXRhLm1lc3NhZ2VfdHlwZX1cIlxyXG4gICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1vZGVsXCI+4oSWICR7ZGF0YS5tb2RlbF9pZH08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImF1dGhvclwiPiR7ZGF0YS5zZW5kX3VzZXJ9PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4+JHtkYXRhLm1lc3NhZ2V9PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJ0aW1lXCI+JHtkYXRhLm1lc3NhZ2VfdGltZX08L3NwYW4+XHJcbiAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgYDtcclxuICAgIH1cclxuXHJcbiAgICByZWxvYWRBc2tNZXNzYWdlcygpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQntC/0YDQtdC00LXQu9GP0LXQvCDQvdC+0LzQtdGAINC00LjQu9C10YDQsFxyXG4gICAgICogQHJldHVybnMge251bWJlcn1cclxuICAgICAqL1xyXG4gICAgZ2V0RGVhbGVySWQoKSB7XHJcbiAgICAgICAgbGV0IHNlbGVjdGVkX2RlYWxlcl9pdGVtID0gdGhpcy5nZXRFbGVtZW50QnlDbGFzcygnLmRlYWxlcl9tb2RlbF9pdGVtJywgJ2FjdGl2ZScpLCBkZWFsZXJfaWQgPSAwO1xyXG4gICAgICAgIGlmIChzZWxlY3RlZF9kZWFsZXJfaXRlbSAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgZGVhbGVyX2lkID0gc2VsZWN0ZWRfZGVhbGVyX2l0ZW0uZGF0YSgnZGVhbGVyLWlkJyk7XHJcbiAgICAgICAgfSBlbHNlIGlmICgkKCcuanMtZGVhbGVyLWRpc2N1c3Npb24tbGlzdC1pdGVtJykuZXEoMCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBkZWFsZXJfaWQgPSAkKCcuanMtZGVhbGVyLWRpc2N1c3Npb24tbGlzdC1pdGVtJykuZXEoMCkuZGF0YSgnZGVhbGVyLWlkJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZGVhbGVyX2lkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0KHQutC+0YDQvtC70LvQuNC90LMg0LTQviDQv9C+0YHQu9C10LTQvdC10LPQviDRgdC+0L7QsdGJ0LXQvdC40Y9cclxuICAgICAqIEBwYXJhbSBlbGVtZW50XHJcbiAgICAgKi9cclxuICAgIHNjcm9sbERvd24oZWxlbWVudCkge1xyXG4gICAgICAgIGxldCBoZWlnaHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50KS5zY3JvbGxIZWlnaHQ7XHJcblxyXG4gICAgICAgICQoJyMnICsgZWxlbWVudCkuYW5pbWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBzY3JvbGxUb3A6IGhlaWdodCArIFwicHhcIlxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7ZHVyYXRpb246IDUwMH0pO1xyXG5cclxuICAgIH1cclxufVxyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd3d3L2pzL2NoYXRzL2Rldi9jbGFzc2VzL2Jhc2VfZGlzY3Vzc2lvbi5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOzs7O0FBSUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBQ0E7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFHQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBS0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUdBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7QUFLQTtBQUNBO0FBYUE7OztBQUVBO0FBQ0E7QUFHQTs7Ozs7OztBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBS0E7Ozs7OztBQXhwQkEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///5\n")},/*!********************************************!*\
  !*** ./www/js/chats/dev/classes/dealer.js ***!
  \********************************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _websockets = __webpack_require__(/*! ./websockets */ 0);\n\nvar _websockets2 = _interopRequireDefault(_websockets);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by kostet on 03.08.2017.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar Dealer = function (_DiscussionWebSockets) {\n    _inherits(Dealer, _DiscussionWebSockets);\n\n    function Dealer(params) {\n        _classCallCheck(this, Dealer);\n\n        var _this = _possibleConstructorReturn(this, (Dealer.__proto__ || Object.getPrototypeOf(Dealer)).call(this, params));\n\n        _this.msg_field = params.frm_discussion_message_element;\n        _this.scroll_container = 'container-model-messages';\n        return _this;\n    }\n\n    _createClass(Dealer, [{\n        key: 'start',\n        value: function start() {\n            _get(Dealer.prototype.__proto__ || Object.getPrototypeOf(Dealer.prototype), 'start', this).call(this);\n\n            $(document).on('change', this.params.on_models_by_activity, $.proxy(this.onGetDiscussionMessagesByActivity, this));\n\n            //Загрузка списка сообщенией при загрузке страницы\n            //Для первой завке в списке\n            this.loadDiscussionMessages();\n\n            return this;\n        }\n\n        /**\r\n        * Получение списка дискуссий по выбранной активность\r\n        * @param event\r\n        */\n\n    }, {\n        key: 'onGetDiscussionMessagesByActivity',\n        value: function onGetDiscussionMessagesByActivity(event) {\n            var filter = $(event.target),\n                filter_value = filter.val();\n\n            this.getDiscussionVisibilityButtons().removeClass('current');\n            this.getDiscussionVisibilityButtons().eq(0).addClass('current');\n\n            this.filter.filter_by_activity = filter_value;\n            this.loadDiscussionList();\n        }\n\n        /**\r\n         * Загрузка списка дискуссий\r\n         */\n\n    }, {\n        key: 'loadDiscussionList',\n        value: function loadDiscussionList() {\n            var _this2 = this;\n\n            new Promise(function (resolve, reject) {\n                Pace.start();\n                $.post(_this2.params.on_load_discussions_url, _this2.filter, function (result) {\n                    resolve(result);\n                });\n            }).then(function (result) {\n                Pace.stop();\n\n                if (result.first_message.model != undefined) {\n                    _this2.params.default_model_id = result.first_message.model.id;\n                    _this2.params.model_id = undefined;\n                }\n                _this2.getDiscussionsContainer().html(result.discussions);\n\n                //Подгружаем список сообщений для первой дискуссии из выбранной активности в списке\n                _this2.loadDiscussionMessages();\n            }).catch(function (result) {\n                Pace.stop();\n            });\n        }\n    }, {\n        key: 'getDiscussionsContainer',\n        value: function getDiscussionsContainer() {\n            return $('#dealer-discussions-container');\n        }\n\n        /**\r\n         * Делаем запрос по ws для информировании пользователя о новом сообщении\r\n         * @param data\r\n         */\n\n    }, {\n        key: 'makeRequestData',\n        value: function makeRequestData(data) {\n            this.makeRequest('newMessage', data);\n        }\n    }, {\n        key: 'reloadAskMessages',\n        value: function reloadAskMessages(data) {\n            if (data.message_type == 'ask') {\n                this.loadAskMessages();\n            }\n        }\n    }]);\n\n    return Dealer;\n}(_websockets2.default);\n\nexports.default = Dealer;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvZGVhbGVyLmpzPzE2NDgiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkga29zdGV0IG9uIDAzLjA4LjIwMTcuXHJcbiAqL1xyXG5cclxuaW1wb3J0IERpc2N1c3Npb25XZWJTb2NrZXRzIGZyb20gXCIuL3dlYnNvY2tldHNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERlYWxlciBleHRlbmRzIERpc2N1c3Npb25XZWJTb2NrZXRzIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmFtcykge1xyXG4gICAgICAgIHN1cGVyKHBhcmFtcyk7XHJcblxyXG4gICAgICAgIHRoaXMubXNnX2ZpZWxkID0gcGFyYW1zLmZybV9kaXNjdXNzaW9uX21lc3NhZ2VfZWxlbWVudDtcclxuICAgICAgICB0aGlzLnNjcm9sbF9jb250YWluZXIgPSAnY29udGFpbmVyLW1vZGVsLW1lc3NhZ2VzJztcclxuICAgIH1cclxuXHJcbiAgICBzdGFydCgpIHtcclxuICAgICAgICBzdXBlci5zdGFydCgpO1xyXG5cclxuICAgICAgICAkKGRvY3VtZW50KS5vbignY2hhbmdlJywgdGhpcy5wYXJhbXMub25fbW9kZWxzX2J5X2FjdGl2aXR5LCAkLnByb3h5KHRoaXMub25HZXREaXNjdXNzaW9uTWVzc2FnZXNCeUFjdGl2aXR5LCB0aGlzKSk7XHJcblxyXG4gICAgICAgIC8v0JfQsNCz0YDRg9C30LrQsCDRgdC/0LjRgdC60LAg0YHQvtC+0LHRidC10L3QuNC10Lkg0L/RgNC4INC30LDQs9GA0YPQt9C60LUg0YHRgtGA0LDQvdC40YbRi1xyXG4gICAgICAgIC8v0JTQu9GPINC/0LXRgNCy0L7QuSDQt9Cw0LLQutC1INCyINGB0L/QuNGB0LrQtVxyXG4gICAgICAgIHRoaXMubG9hZERpc2N1c3Npb25NZXNzYWdlcygpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgKiDQn9C+0LvRg9GH0LXQvdC40LUg0YHQv9C40YHQutCwINC00LjRgdC60YPRgdGB0LjQuSDQv9C+INCy0YvQsdGA0LDQvdC90L7QuSDQsNC60YLQuNCy0L3QvtGB0YLRjFxyXG4gICAgICogQHBhcmFtIGV2ZW50XHJcbiAgICAgKi9cclxuICAgIG9uR2V0RGlzY3Vzc2lvbk1lc3NhZ2VzQnlBY3Rpdml0eShldmVudCkge1xyXG4gICAgICAgIGxldCBmaWx0ZXIgPSAkKGV2ZW50LnRhcmdldCksIGZpbHRlcl92YWx1ZSA9IGZpbHRlci52YWwoKTtcclxuXHJcbiAgICAgICAgdGhpcy5nZXREaXNjdXNzaW9uVmlzaWJpbGl0eUJ1dHRvbnMoKS5yZW1vdmVDbGFzcygnY3VycmVudCcpO1xyXG4gICAgICAgIHRoaXMuZ2V0RGlzY3Vzc2lvblZpc2liaWxpdHlCdXR0b25zKCkuZXEoMCkuYWRkQ2xhc3MoJ2N1cnJlbnQnKTtcclxuXHJcbiAgICAgICAgdGhpcy5maWx0ZXIuZmlsdGVyX2J5X2FjdGl2aXR5ID0gZmlsdGVyX3ZhbHVlO1xyXG4gICAgICAgIHRoaXMubG9hZERpc2N1c3Npb25MaXN0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQl9Cw0LPRgNGD0LfQutCwINGB0L/QuNGB0LrQsCDQtNC40YHQutGD0YHRgdC40LlcclxuICAgICAqL1xyXG4gICAgbG9hZERpc2N1c3Npb25MaXN0KCkge1xyXG4gICAgICAgIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgUGFjZS5zdGFydCgpO1xyXG4gICAgICAgICAgICAkLnBvc3QodGhpcy5wYXJhbXMub25fbG9hZF9kaXNjdXNzaW9uc191cmwsXHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlcixcclxuICAgICAgICAgICAgICAgIChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgICAgICAgICAgICAgIFBhY2Uuc3RvcCgpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZmlyc3RfbWVzc2FnZS5tb2RlbCAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmFtcy5kZWZhdWx0X21vZGVsX2lkID0gcmVzdWx0LmZpcnN0X21lc3NhZ2UubW9kZWwuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJhbXMubW9kZWxfaWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldERpc2N1c3Npb25zQ29udGFpbmVyKCkuaHRtbChyZXN1bHQuZGlzY3Vzc2lvbnMpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8v0J/QvtC00LPRgNGD0LbQsNC10Lwg0YHQv9C40YHQvtC6INGB0L7QvtCx0YnQtdC90LjQuSDQtNC70Y8g0L/QtdGA0LLQvtC5INC00LjRgdC60YPRgdGB0LjQuCDQuNC3INCy0YvQsdGA0LDQvdC90L7QuSDQsNC60YLQuNCy0L3QvtGB0YLQuCDQsiDRgdC/0LjRgdC60LVcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZERpc2N1c3Npb25NZXNzYWdlcygpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgUGFjZS5zdG9wKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERpc2N1c3Npb25zQ29udGFpbmVyKCkge1xyXG4gICAgICAgIHJldHVybiAkKCcjZGVhbGVyLWRpc2N1c3Npb25zLWNvbnRhaW5lcicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog0JTQtdC70LDQtdC8INC30LDQv9GA0L7RgSDQv9C+IHdzINC00LvRjyDQuNC90YTQvtGA0LzQuNGA0L7QstCw0L3QuNC4INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDQviDQvdC+0LLQvtC8INGB0L7QvtCx0YnQtdC90LjQuFxyXG4gICAgICogQHBhcmFtIGRhdGFcclxuICAgICAqL1xyXG4gICAgbWFrZVJlcXVlc3REYXRhKGRhdGEpIHtcclxuICAgICAgICB0aGlzLm1ha2VSZXF1ZXN0KCduZXdNZXNzYWdlJywgZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVsb2FkQXNrTWVzc2FnZXMoZGF0YSkge1xyXG4gICAgICAgIGlmIChkYXRhLm1lc3NhZ2VfdHlwZSA9PSAnYXNrJykge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWRBc2tNZXNzYWdlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd3d3L2pzL2NoYXRzL2Rldi9jbGFzc2VzL2RlYWxlci5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUlBO0FBQ0E7Ozs7Ozs7OztBQUxBOzs7O0FBTUE7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFFQTtBQUNBO0FBSkE7QUFLQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBR0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQUlBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBL0VBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///6\n")},/*!**********************************************!*\
  !*** ./www/js/chats/dev/classes/importer.js ***!
  \**********************************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _admin = __webpack_require__(/*! ./admin */ 1);\n\nvar _admin2 = _interopRequireDefault(_admin);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by kostet on 03.08.2017.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar Importer = function (_Admin) {\n    _inherits(Importer, _Admin);\n\n    function Importer(params) {\n        _classCallCheck(this, Importer);\n\n        return _possibleConstructorReturn(this, (Importer.__proto__ || Object.getPrototypeOf(Importer)).call(this, params));\n    }\n\n    /**\r\n     * Получить данные о том кому отправлять сообщение (дилеру или импортерам)\r\n     * @returns {{direction: string}}\r\n     */\n\n\n    _createClass(Importer, [{\n        key: \'getMessageDirection\',\n        value: function getMessageDirection() {\n            return {\n                \'direction\': \'admin_dealer\'\n            };\n        }\n    }]);\n\n    return Importer;\n}(_admin2.default);\n\nexports.default = Importer;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvaW1wb3J0ZXIuanM/MDE5OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBrb3N0ZXQgb24gMDMuMDguMjAxNy5cclxuICovXHJcblxyXG5pbXBvcnQgQWRtaW4gZnJvbSAnLi9hZG1pbic7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbXBvcnRlciBleHRlbmRzIEFkbWluIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmFtcykge1xyXG4gICAgICAgIHN1cGVyKHBhcmFtcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDQn9C+0LvRg9GH0LjRgtGMINC00LDQvdC90YvQtSDQviDRgtC+0Lwg0LrQvtC80YMg0L7RgtC/0YDQsNCy0LvRj9GC0Ywg0YHQvtC+0LHRidC10L3QuNC1ICjQtNC40LvQtdGA0YMg0LjQu9C4INC40LzQv9C+0YDRgtC10YDQsNC8KVxyXG4gICAgICogQHJldHVybnMge3tkaXJlY3Rpb246IHN0cmluZ319XHJcbiAgICAgKi9cclxuICAgIGdldE1lc3NhZ2VEaXJlY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgJ2RpcmVjdGlvbic6ICdhZG1pbl9kZWFsZXInXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd3d3L2pzL2NoYXRzL2Rldi9jbGFzc2VzL2ltcG9ydGVyLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUlBO0FBQ0E7Ozs7Ozs7OztBQUxBOzs7O0FBTUE7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFDQTtBQUNBOzs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQURBO0FBR0E7Ozs7OztBQWJBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///7\n')},/*!*******************************************************!*\
  !*** ./www/js/chats/dev/classes/dealer_websockets.js ***!
  \*******************************************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _websockets = __webpack_require__(/*! ./websockets */ 0);\n\nvar _websockets2 = _interopRequireDefault(_websockets);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by kostet on 09.08.2017.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar DealerWebSockets = function (_DiscussionWebSockets) {\n    _inherits(DealerWebSockets, _DiscussionWebSockets);\n\n    function DealerWebSockets() {\n        _classCallCheck(this, DealerWebSockets);\n\n        return _possibleConstructorReturn(this, (DealerWebSockets.__proto__ || Object.getPrototypeOf(DealerWebSockets)).call(this));\n    }\n\n    _createClass(DealerWebSockets, [{\n        key: \'onMessage\',\n        value: function onMessage(event) {\n            console.log(event);\n        }\n    }]);\n\n    return DealerWebSockets;\n}(_websockets2.default);\n\nexports.default = DealerWebSockets;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvZGVhbGVyX3dlYnNvY2tldHMuanM/NWQ1YSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBrb3N0ZXQgb24gMDkuMDguMjAxNy5cclxuICovXHJcblxyXG5pbXBvcnQgRGlzY3Vzc2lvbldlYlNvY2tldHMgZnJvbSAnLi93ZWJzb2NrZXRzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERlYWxlcldlYlNvY2tldHMgZXh0ZW5kcyBEaXNjdXNzaW9uV2ViU29ja2V0cyB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uTWVzc2FnZShldmVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50KTtcclxuICAgIH1cclxufVxyXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd3d3L2pzL2NoYXRzL2Rldi9jbGFzc2VzL2RlYWxlcl93ZWJzb2NrZXRzLmpzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUlBO0FBQ0E7Ozs7Ozs7OztBQUxBOzs7O0FBTUE7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFQQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///8\n')},/*!*********************************************************!*\
  !*** ./www/js/chats/dev/classes/importer_websockets.js ***!
  \*********************************************************/
/*! dynamic exports provided */
/*! all exports used */
function(module,exports,__webpack_require__){"use strict";eval('\n\nObject.defineProperty(exports, "__esModule", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _admin_websockets = __webpack_require__(/*! ./admin_websockets */ 2);\n\nvar _admin_websockets2 = _interopRequireDefault(_admin_websockets);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by kostet on 02.09.2017.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar ImporterWebSockets = function (_AdminWebSockets) {\n    _inherits(ImporterWebSockets, _AdminWebSockets);\n\n    function ImporterWebSockets() {\n        _classCallCheck(this, ImporterWebSockets);\n\n        return _possibleConstructorReturn(this, (ImporterWebSockets.__proto__ || Object.getPrototypeOf(ImporterWebSockets)).call(this));\n    }\n\n    _createClass(ImporterWebSockets, [{\n        key: \'onMessage\',\n        value: function onMessage(event) {\n            console.log(event);\n        }\n    }]);\n\n    return ImporterWebSockets;\n}(_admin_websockets2.default);\n\nexports.default = ImporterWebSockets;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy93d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvaW1wb3J0ZXJfd2Vic29ja2V0cy5qcz8zY2Q2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGtvc3RldCBvbiAwMi4wOS4yMDE3LlxyXG4gKi9cclxuXHJcbmltcG9ydCBBZG1pbldlYlNvY2tldHMgZnJvbSAnLi9hZG1pbl93ZWJzb2NrZXRzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEltcG9ydGVyV2ViU29ja2V0cyBleHRlbmRzIEFkbWluV2ViU29ja2V0cyB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uTWVzc2FnZShldmVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50KTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3d3cvanMvY2hhdHMvZGV2L2NsYXNzZXMvaW1wb3J0ZXJfd2Vic29ja2V0cy5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFJQTtBQUNBOzs7Ozs7Ozs7QUFMQTs7OztBQU1BOzs7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBUEEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///9\n')}]);