<?php

/**
 * ActivityModelsTypesNecessarilyUsedTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class ActivityModelsTypesNecessarilyUsedTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return object ActivityModelsTypesNecessarilyUsedTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('ActivityModelsTypesNecessarilyUsed');
    }

    /**
     * @param $type
     * @param $model
     * @return bool
     */
    public static function alreadyUsed($model, $type) {
        $used_type = self::getInstance()->createQuery()->where('dealer_id = ? and activity_id = ? and necessarily_id = ?',
            array
            (
                $model->getDealerId(),
                $model->getActivityId(),
                $type->getId()
            ))->fetchOne();

        if ($used_type && $model->getIsNecessarilyModel() == $used_type->getNecessarilyId()) {
            return false;
        }

        return $used_type ? true : false;
    }

}
