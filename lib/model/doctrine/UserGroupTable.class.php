<?php

/**
 * UserGroupTable
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class UserGroupTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return UserGroupTable
     */
    static function getInstance()
    {
        return Doctrine_Core::getTable('UserGroup');
    }

    /**
     * Returns a manager group
     *
     * @return UserGroup
     * @throws NoManagerGroupException
     */
    function getManagerGroup()
    {
        $group = $this->findOneByName(sfConfig::get('app_managers_group'));

        if (!$group)
            throw new NoManagerGroupException();

        return $group;
    }

    /**
     * Returns a dealer group
     *
     * @return UserGroup
     * @throws NoDealerGroupException
     */
    function getDealerGroup()
    {
        $group = $this->findOneByName(sfConfig::get('app_dealers_group'));

        if (!$group)
            throw new NoDealerGroupException();

        return $group;
    }

    /**
     * Returns a importer group
     *
     * @return UserGroup
     * @throws NoDealerGroupException
     */
    function getImporterGroup()
    {
        $group = $this->findOneByName(sfConfig::get('app_importers_group'));

        if (!$group)
            throw new NoDealerGroupException();

        return $group;
    }

    function getRegionalManagerGroup() {
        $group = $this->findOneByName(sfConfig::get('app_regional_manager_group'));

        if (!$group) {
            throw new NoDealerGroupException();
        }

        return $group;
    }

    function findByRole($role)
    {
        return $this->createQuery('g')
            ->innerJoin('g.Roles r WITH r.role=?', $role)
            ->execute();
    }
}