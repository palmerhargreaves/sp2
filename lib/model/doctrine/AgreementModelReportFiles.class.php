<?php

/**
 * AgreementModelReportFiles
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    Marketing Aftersales NFZ
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class AgreementModelReportFiles extends BaseAgreementModelReportFiles
{
    public function preDelete($event)
    {
        if ($this->getObjectType() == AgreementModel::UPLOADED_FILE_MODEL) {
            $file_path = sfConfig::get('sf_upload_dir') . '/' . AgreementModel::MODEL_FILE_PATH . '/' . $this->getFile();
            if (file_exists($file_path)) {
                unlink($file_path);
            }
        } else {

        }

        parent::preDelete($event); // TODO: Change the autogenerated stub
    }

    public function isImage() {
        $file_ext = pathinfo($this->getFile(), PATHINFO_EXTENSION);

        if (in_array($file_ext, $this->getImgExt())) {
            return true;
        }

        return false;
    }

    /**
     * Get file name or full path to file
     * @return string
     */
    public function getFileName() {
        $path = $this->getPath();
        if (!empty($path) && !is_null($path)) {
            return sprintf('%s/%s', $path, $this->getFile());
        }

        return $this->getFile();
    }

    public function getFileExt() {
        return pathinfo($this->getFile(), PATHINFO_EXTENSION);
    }

    private function getImgExt() {
        return array('png', 'gif', 'jpg', 'jpeg');
    }
}
