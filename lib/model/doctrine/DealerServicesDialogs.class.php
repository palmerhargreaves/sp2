<?php

/**
 * DealerServicesDialogs
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    Servicepool2.0
 * @subpackage model
 * @author     Your name here
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class DealerServicesDialogs extends BaseDealerServicesDialogs
{
	public function isActiveForUser(User $user) {
		$active = true;
		$dealer = $user->getDealerUsers()->getFirst();

        if($dealer) {
            /*$activeDialogs = DealerServicesDialogsTable::getInstance()->createQuery()->where('status = ?', 1)->orderBy('id DESC')->execute();
            foreach($activeDialogs as $dialog)
            {*/
			$data = DealersServiceDataTable::getInstance()->createQuery()->where('dealer_id = ? and dialog_service_id = ?', 
										array($dealer->getDealerId(), $this->getId()))
											->fetchOne();

            if($data) {
				$active = false;
			}

            return $active;
		}

		return false;
	}
}
